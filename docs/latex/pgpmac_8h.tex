\hypertarget{pgpmac_8h}{
\section{pgpmac.h File Reference}
\label{pgpmac_8h}\index{pgpmac.h@{pgpmac.h}}
}


Headers for the entire pgpmac project.  
{\ttfamily \#include $<$stdio.h$>$}\par
{\ttfamily \#include $<$stdlib.h$>$}\par
{\ttfamily \#include $<$unistd.h$>$}\par
{\ttfamily \#include $<$sys/types.h$>$}\par
{\ttfamily \#include $<$sys/socket.h$>$}\par
{\ttfamily \#include $<$netdb.h$>$}\par
{\ttfamily \#include $<$string.h$>$}\par
{\ttfamily \#include $<$netinet/in.h$>$}\par
{\ttfamily \#include $<$errno.h$>$}\par
{\ttfamily \#include $<$poll.h$>$}\par
{\ttfamily \#include $<$libpq-\/fe.h$>$}\par
{\ttfamily \#include $<$ncurses.h$>$}\par
{\ttfamily \#include $<$math.h$>$}\par
{\ttfamily \#include $<$pthread.h$>$}\par
{\ttfamily \#include $<$signal.h$>$}\par
{\ttfamily \#include $<$sys/signalfd.h$>$}\par
{\ttfamily \#include $<$sys/time.h$>$}\par
{\ttfamily \#include $<$time.h$>$}\par
{\ttfamily \#include $<$getopt.h$>$}\par
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structtagEthernetCmd}{tagEthernetCmd}
\begin{DoxyCompactList}\small\item\em PMAC ethernet packet definition. \item\end{DoxyCompactList}\item 
struct \hyperlink{structlspmac__cmd__queue__struct}{lspmac\_\-cmd\_\-queue\_\-struct}
\begin{DoxyCompactList}\small\item\em PMAC command queue item. \item\end{DoxyCompactList}\item 
struct \hyperlink{structlspmac__motor__struct}{lspmac\_\-motor\_\-struct}
\begin{DoxyCompactList}\small\item\em Motor information. \item\end{DoxyCompactList}\item 
struct \hyperlink{structlspg__getcenter__struct}{lspg\_\-getcenter\_\-struct}
\begin{DoxyCompactList}\small\item\em Storage for getcenter query Used for the md2 ROTATE command that generates the centering movies. \item\end{DoxyCompactList}\item 
struct \hyperlink{structlspg__nextshot__struct}{lspg\_\-nextshot\_\-struct}
\begin{DoxyCompactList}\small\item\em Storage definition for nextshot query. \item\end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Defines}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{pgpmac_8h_a3bae94e8e4e4347dd5f87b6bda058de6}{LS\_\-DISPLAY\_\-WINDOW\_\-HEIGHT}~8
\begin{DoxyCompactList}\small\item\em Number of status box rows. \item\end{DoxyCompactList}\item 
\#define \hyperlink{pgpmac_8h_a1f96754f00a1f82414cebc66f75ded78}{LS\_\-DISPLAY\_\-WINDOW\_\-WIDTH}~24
\begin{DoxyCompactList}\small\item\em Number of status box columns. \item\end{DoxyCompactList}\item 
\#define \hyperlink{pgpmac_8h_a3a8ef1b4b5994d6dd12bf74454ea891b}{LS\_\-PG\_\-QUERY\_\-STRING\_\-LENGTH}~1024
\begin{DoxyCompactList}\small\item\em Fixed length postgresql query strings. Queries should all be function calls so this is not as weird as one might think. \item\end{DoxyCompactList}\item 
\#define \hyperlink{pgpmac_8h_ab61d790b5572f116e091babfda53627b}{LSEVENTS\_\-EVENT\_\-LENGTH}~32
\begin{DoxyCompactList}\small\item\em Fixed length for event names: simplifies string handling. \item\end{DoxyCompactList}\item 
\#define \hyperlink{pgpmac_8h_a30f0f377b0f0695284145d420ea51846}{MD2CMDS\_\-CMD\_\-LENGTH}~32
\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \hyperlink{structtagEthernetCmd}{tagEthernetCmd} \hyperlink{pgpmac_8h_a2d163436571135a457f4a4e2fbd09633}{pmac\_\-cmd\_\-t}
\begin{DoxyCompactList}\small\item\em PMAC ethernet packet definition. \item\end{DoxyCompactList}\item 
typedef struct \hyperlink{structlspmac__cmd__queue__struct}{lspmac\_\-cmd\_\-queue\_\-struct} \hyperlink{pgpmac_8h_a99c275e32ad897dca34d196b91f038cb}{pmac\_\-cmd\_\-queue\_\-t}
\begin{DoxyCompactList}\small\item\em PMAC command queue item. \item\end{DoxyCompactList}\item 
typedef struct \hyperlink{structlspmac__motor__struct}{lspmac\_\-motor\_\-struct} \hyperlink{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}{lspmac\_\-motor\_\-t}
\begin{DoxyCompactList}\small\item\em Motor information. \item\end{DoxyCompactList}\item 
typedef struct \hyperlink{structlspg__getcenter__struct}{lspg\_\-getcenter\_\-struct} \hyperlink{pgpmac_8h_a48b627e412dd038c1f17cdb0501eec33}{lspg\_\-getcenter\_\-t}
\begin{DoxyCompactList}\small\item\em Storage for getcenter query Used for the md2 ROTATE command that generates the centering movies. \item\end{DoxyCompactList}\item 
typedef struct \hyperlink{structlspg__nextshot__struct}{lspg\_\-nextshot\_\-struct} \hyperlink{pgpmac_8h_a17ea2bf07a0b3b892baa00bd392607b3}{lspg\_\-nextshot\_\-t}
\begin{DoxyCompactList}\small\item\em Storage definition for nextshot query. \item\end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{pgpmac_8h_a76b11c62b122ee0fd8399435d4260681}{PmacSockSendline} (char $\ast$s)
\item 
void \hyperlink{pgpmac_8h_a4253474d4dd305aec0afdd5552b3ddd5}{lspg\_\-seq\_\-run\_\-prep\_\-all} (long long skey, double \hyperlink{pgpmac_8h_a0be79ccb7ebf3a665248fd856112b9fd}{kappa}, double \hyperlink{pgpmac_8h_ac8070dc568ad974a3db42b51eca828cc}{phi}, double cx, double cy, double ax, double ay, double az)
\begin{DoxyCompactList}\small\item\em Convinence function to call seq run prep. \item\end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_a95e3fd7c1685d7e6ab6d0a295ab42f78}{lspg\_\-zoom\_\-lut\_\-call} ()
\item 
void \hyperlink{pgpmac_8h_a7762ca7b97b44b979e23ce88ca3b4249}{pgpmac\_\-printf} (char $\ast$fmt,...)
\begin{DoxyCompactList}\small\item\em Terminal output routine ala printf. \item\end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_ae3e30b0ba9b5d5a291fa29b77ba920d8}{lspmac\_\-init} (int, int)
\begin{DoxyCompactList}\small\item\em Initialize this module. \item\end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_a8a77972df14166e05c94ed0792baa09b}{lspg\_\-init} ()
\begin{DoxyCompactList}\small\item\em Initiallize the lspg module. \item\end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_adf63440ffbc65024fef87ea6a11ea8b0}{lsupdate\_\-init} ()
\begin{DoxyCompactList}\small\item\em Initialize this module. \item\end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_a0851b1baecda6a67993efde41d77b1c1}{md2cmds\_\-init} ()
\begin{DoxyCompactList}\small\item\em Initialize the md2cmds module. \item\end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_a3a7fb93fb3fb9c4454613f30bfb0b1ee}{lspmac\_\-run} ()
\begin{DoxyCompactList}\small\item\em Start up the lspmac thread. \item\end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_a1adfdb5ca9fdb5060849d726bf540117}{lspg\_\-run} ()
\begin{DoxyCompactList}\small\item\em Start 'er runnin'. \item\end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_af219e9b2cc124f109aa4c2c2e16b5d07}{lsupdate\_\-run} ()
\begin{DoxyCompactList}\small\item\em run the update routines \item\end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_aa62da7d423952334d41c7d282f45233d}{md2cmds\_\-run} ()
\begin{DoxyCompactList}\small\item\em Start up the thread. \item\end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_af19a77187e7406fc87d36bd26e672e6d}{lsevents\_\-init} ()
\item 
void \hyperlink{pgpmac_8h_a4ddde538b603e3d4580ae9356bf9b89d}{lsevents\_\-run} ()
\item 
void \hyperlink{pgpmac_8h_a3661dfc51537c05b11f4fd184fdff07d}{lsevents\_\-send\_\-event} (char $\ast$,...)
\item 
void \hyperlink{pgpmac_8h_aac89b916c1152c44042875feac35a9e4}{lsevents\_\-add\_\-listener} (char $\ast$, void($\ast$cb)(char $\ast$))
\item 
void \hyperlink{pgpmac_8h_a024b08c7820bb31c3d5b8f281e07f3e8}{lsevents\_\-remove\_\-listener} (char $\ast$, void($\ast$cb)(char $\ast$))
\item 
void \hyperlink{pgpmac_8h_a8cd37a8fb0f061456456a5d79bdd5189}{lstimer\_\-init} ()
\item 
void \hyperlink{pgpmac_8h_a0b918acc1a4bf737cb62b5a70f8b553a}{lstimer\_\-run} ()
\item 
void \hyperlink{pgpmac_8h_af712dd2e9419026eff2762ba062eeaf1}{lstimer\_\-add\_\-timer} (char $\ast$, int, unsigned long int, unsigned long int)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hyperlink{structlspg__getcenter__struct}{lspg\_\-getcenter\_\-t} \hyperlink{pgpmac_8h_a7ef8a09203117578c9b2ce4719519f36}{lspg\_\-getcenter}
\begin{DoxyCompactList}\small\item\em the getcenter object \item\end{DoxyCompactList}\item 
\hyperlink{structlspg__nextshot__struct}{lspg\_\-nextshot\_\-t} \hyperlink{pgpmac_8h_ad8d8e2f578ca79189a80c1fd5b60cefd}{lspg\_\-nextshot}
\begin{DoxyCompactList}\small\item\em the nextshot object \item\end{DoxyCompactList}\item 
\hyperlink{structlspmac__motor__struct}{lspmac\_\-motor\_\-t} \hyperlink{pgpmac_8h_aebfce5f9cbc8ba7bd4e2ee4880f303e8}{lspmac\_\-motors} \mbox{[}$\,$\mbox{]}
\begin{DoxyCompactList}\small\item\em All our motors. \item\end{DoxyCompactList}\item 
\hyperlink{structlspmac__motor__struct}{lspmac\_\-motor\_\-t} $\ast$ \hyperlink{pgpmac_8h_a8237e646ce032a840637a4ef7bff49b9}{omega}
\begin{DoxyCompactList}\small\item\em MD2 omega axis (the air bearing). \item\end{DoxyCompactList}\item 
\hyperlink{structlspmac__motor__struct}{lspmac\_\-motor\_\-t} $\ast$ \hyperlink{pgpmac_8h_a6cb218bdccfe5a93471c161f15a15cab}{alignx}
\begin{DoxyCompactList}\small\item\em Alignment stage X. \item\end{DoxyCompactList}\item 
\hyperlink{structlspmac__motor__struct}{lspmac\_\-motor\_\-t} $\ast$ \hyperlink{pgpmac_8h_a737c246c3948e644a18d191a931e1acd}{aligny}
\begin{DoxyCompactList}\small\item\em Alignment stage Y. \item\end{DoxyCompactList}\item 
\hyperlink{structlspmac__motor__struct}{lspmac\_\-motor\_\-t} $\ast$ \hyperlink{pgpmac_8h_ae7642b1da0f7c7f8448104c691d40a12}{alignz}
\begin{DoxyCompactList}\small\item\em Alignment stage X. \item\end{DoxyCompactList}\item 
\hyperlink{structlspmac__motor__struct}{lspmac\_\-motor\_\-t} $\ast$ \hyperlink{pgpmac_8h_aa90d2363b744acbd4d45133b7a716d8f}{anal}
\begin{DoxyCompactList}\small\item\em Polaroid analyzer motor. \item\end{DoxyCompactList}\item 
\hyperlink{structlspmac__motor__struct}{lspmac\_\-motor\_\-t} $\ast$ \hyperlink{pgpmac_8h_ad53a42cfaa04eff0336a44c8c9986333}{zoom}
\begin{DoxyCompactList}\small\item\em Optical zoom. \item\end{DoxyCompactList}\item 
\hyperlink{structlspmac__motor__struct}{lspmac\_\-motor\_\-t} $\ast$ \hyperlink{pgpmac_8h_a139200ddaa9856a7ffcec0e6cbaa8f1b}{apery}
\begin{DoxyCompactList}\small\item\em Aperture Y. \item\end{DoxyCompactList}\item 
\hyperlink{structlspmac__motor__struct}{lspmac\_\-motor\_\-t} $\ast$ \hyperlink{pgpmac_8h_ab93bd6ee850b285ca3a95e64d15e9477}{aperz}
\begin{DoxyCompactList}\small\item\em Aperture Z. \item\end{DoxyCompactList}\item 
\hyperlink{structlspmac__motor__struct}{lspmac\_\-motor\_\-t} $\ast$ \hyperlink{pgpmac_8h_a51358daaea8b5236f08414877d8af6c2}{capy}
\begin{DoxyCompactList}\small\item\em Capillary Y. \item\end{DoxyCompactList}\item 
\hyperlink{structlspmac__motor__struct}{lspmac\_\-motor\_\-t} $\ast$ \hyperlink{pgpmac_8h_aa45f268d0af9f3d465acfab128919718}{capz}
\begin{DoxyCompactList}\small\item\em Capillary Z. \item\end{DoxyCompactList}\item 
\hyperlink{structlspmac__motor__struct}{lspmac\_\-motor\_\-t} $\ast$ \hyperlink{pgpmac_8h_ac0eeaffa0996271d8a38344a470d13d7}{scinz}
\begin{DoxyCompactList}\small\item\em Scintillator Z. \item\end{DoxyCompactList}\item 
\hyperlink{structlspmac__motor__struct}{lspmac\_\-motor\_\-t} $\ast$ \hyperlink{pgpmac_8h_ac940d950d9efeaf3f0ae67e9bf331188}{cenx}
\begin{DoxyCompactList}\small\item\em Centering Table X. \item\end{DoxyCompactList}\item 
\hyperlink{structlspmac__motor__struct}{lspmac\_\-motor\_\-t} $\ast$ \hyperlink{pgpmac_8h_aaed18e738ba7bfb6c771a44f5d7ea827}{ceny}
\begin{DoxyCompactList}\small\item\em Centering Table Y. \item\end{DoxyCompactList}\item 
\hyperlink{structlspmac__motor__struct}{lspmac\_\-motor\_\-t} $\ast$ \hyperlink{pgpmac_8h_a0be79ccb7ebf3a665248fd856112b9fd}{kappa}
\begin{DoxyCompactList}\small\item\em Kappa. \item\end{DoxyCompactList}\item 
\hyperlink{structlspmac__motor__struct}{lspmac\_\-motor\_\-t} $\ast$ \hyperlink{pgpmac_8h_ac8070dc568ad974a3db42b51eca828cc}{phi}
\begin{DoxyCompactList}\small\item\em Phi (not data collection axis). \item\end{DoxyCompactList}\item 
\hyperlink{structlspmac__motor__struct}{lspmac\_\-motor\_\-t} $\ast$ \hyperlink{pgpmac_8h_a26dec4623af9beed912b8e7e6f99822c}{fshut}
\begin{DoxyCompactList}\small\item\em Fast shutter. \item\end{DoxyCompactList}\item 
\hyperlink{structlspmac__motor__struct}{lspmac\_\-motor\_\-t} $\ast$ \hyperlink{pgpmac_8h_aeb09895663eff333b7a75acb319a9fc1}{flight}
\begin{DoxyCompactList}\small\item\em Front Light DAC. \item\end{DoxyCompactList}\item 
\hyperlink{structlspmac__motor__struct}{lspmac\_\-motor\_\-t} $\ast$ \hyperlink{pgpmac_8h_a85d6eaa4b4a82bb3112574f458d1dc50}{blight}
\begin{DoxyCompactList}\small\item\em Back Light DAC. \item\end{DoxyCompactList}\item 
\hyperlink{structlspmac__motor__struct}{lspmac\_\-motor\_\-t} $\ast$ \hyperlink{pgpmac_8h_a8a3ca6fcf5e24dcc26170736843e53b2}{fscint}
\begin{DoxyCompactList}\small\item\em Scintillator Piezo DAC. \item\end{DoxyCompactList}\item 
\hyperlink{structlspmac__motor__struct}{lspmac\_\-motor\_\-t} $\ast$ \hyperlink{pgpmac_8h_af813a2eff0b7efa4c70633559054e84c}{blight\_\-ud}
\begin{DoxyCompactList}\small\item\em Back Light Up/Down actuator. \item\end{DoxyCompactList}\item 
\hyperlink{structlspmac__motor__struct}{lspmac\_\-motor\_\-t} $\ast$ \hyperlink{pgpmac_8h_ae78d9a757d4c85419fff9c94b15e25d7}{cryo}
\begin{DoxyCompactList}\small\item\em Move the cryostream towards or away from the crystal. \item\end{DoxyCompactList}\item 
\hyperlink{structlspmac__motor__struct}{lspmac\_\-motor\_\-t} $\ast$ \hyperlink{pgpmac_8h_a9d9c5030d817483ca9518027c91adac4}{dryer}
\begin{DoxyCompactList}\small\item\em blow air on the scintilator to dry it off \item\end{DoxyCompactList}\item 
int \hyperlink{pgpmac_8h_a56260f012c50a591ee7f97e500f16994}{lspmac\_\-nmotors}
\begin{DoxyCompactList}\small\item\em The number of motors we manage. \item\end{DoxyCompactList}\item 
WINDOW $\ast$ \hyperlink{pgpmac_8h_a65daf0f4a5bc6def23a9df98ff5ca57e}{term\_\-output}
\begin{DoxyCompactList}\small\item\em place to print stuff out \item\end{DoxyCompactList}\item 
WINDOW $\ast$ \hyperlink{pgpmac_8h_ab0487111dbe3c05d0bd835eb2fb9a3f7}{term\_\-input}
\begin{DoxyCompactList}\small\item\em place to put the cursor \item\end{DoxyCompactList}\item 
WINDOW $\ast$ \hyperlink{pgpmac_8h_ae746a6903fb8a4ea216def88eccedc3c}{term\_\-status}
\begin{DoxyCompactList}\small\item\em shutter, lamp, air, etc status \item\end{DoxyCompactList}\item 
WINDOW $\ast$ \hyperlink{pgpmac_8h_ae2d7da3afeb756716e6e4ee9cab78f8a}{term\_\-status2}
\begin{DoxyCompactList}\small\item\em shutter, lamp, air, etc status \item\end{DoxyCompactList}\item 
pthread\_\-mutex\_\-t \hyperlink{pgpmac_8h_ad128c64890c7c0d4f836d9ec6e99216a}{ncurses\_\-mutex}
\begin{DoxyCompactList}\small\item\em allow more than one thread access to the screen \item\end{DoxyCompactList}\item 
pthread\_\-cond\_\-t \hyperlink{pgpmac_8h_a08d5b18ec9478d753c46a3e28d1f2126}{md2cmds\_\-cond}
\begin{DoxyCompactList}\small\item\em condition to signal when it's time to run an md2 command \item\end{DoxyCompactList}\item 
pthread\_\-mutex\_\-t \hyperlink{pgpmac_8h_ad67304bb851dc6268b0cda2f40fc5aa8}{md2cmds\_\-mutex}
\begin{DoxyCompactList}\small\item\em mutex for the condition \item\end{DoxyCompactList}\item 
pthread\_\-cond\_\-t \hyperlink{pgpmac_8h_ab517a930528e2b7d0993e11087765b03}{md2cmds\_\-pg\_\-cond}
\begin{DoxyCompactList}\small\item\em coordinate call and response \item\end{DoxyCompactList}\item 
pthread\_\-mutex\_\-t \hyperlink{pgpmac_8h_a4d2c3ac81d4b13eb21f4ddcdda8c7308}{md2cmds\_\-pg\_\-mutex}
\begin{DoxyCompactList}\small\item\em message passing between md2cmds and pg \item\end{DoxyCompactList}\item 
pthread\_\-mutex\_\-t \hyperlink{pgpmac_8h_a1b78a13c654409333569815e1c109d38}{lspmac\_\-shutter\_\-mutex}
\begin{DoxyCompactList}\small\item\em Coordinates threads reading shutter status. \item\end{DoxyCompactList}\item 
pthread\_\-cond\_\-t \hyperlink{pgpmac_8h_afbd51c2cefcee87afe994c9e9f372241}{lspmac\_\-shutter\_\-cond}
\begin{DoxyCompactList}\small\item\em Allows waiting for the shutter status to change. \item\end{DoxyCompactList}\item 
int \hyperlink{pgpmac_8h_a112158e0cd50449a440ac55c7af7bea2}{lspmac\_\-shutter\_\-state}
\begin{DoxyCompactList}\small\item\em State of the shutter, used to detect changes. \item\end{DoxyCompactList}\item 
int \hyperlink{pgpmac_8h_a396fbf06208de3ecbe1b0df549f1cd46}{lspmac\_\-shutter\_\-has\_\-opened}
\begin{DoxyCompactList}\small\item\em Indicates that the shutter had opened, perhaps briefly even if the state did not change. \item\end{DoxyCompactList}\item 
pthread\_\-mutex\_\-t \hyperlink{pgpmac_8h_a85679cac947e199c88794f8e5a12bf5f}{lspmac\_\-moving\_\-mutex}
\begin{DoxyCompactList}\small\item\em Coordinate moving motors between threads. \item\end{DoxyCompactList}\item 
pthread\_\-cond\_\-t \hyperlink{pgpmac_8h_a57547d211906c981ef20257eba99f8df}{lspmac\_\-moving\_\-cond}
\begin{DoxyCompactList}\small\item\em Wait for motor(s) to finish moving condition. \item\end{DoxyCompactList}\item 
int \hyperlink{pgpmac_8h_a7a32c617c183166308241e270959df56}{lspmac\_\-moving\_\-flags}
\begin{DoxyCompactList}\small\item\em Flag used to implement motor moving condition. \item\end{DoxyCompactList}\item 
pthread\_\-mutex\_\-t \hyperlink{pgpmac_8h_a7a3e763682bd7f987d07f149e94b3bf8}{md2\_\-status\_\-mutex}
\begin{DoxyCompactList}\small\item\em Synchronize reading/writting status buffer. \item\end{DoxyCompactList}\item 
char \hyperlink{pgpmac_8h_a1ccf455563dc8d828558b6a230e164a6}{md2cmds\_\-cmd} \mbox{[}$\,$\mbox{]}
\begin{DoxyCompactList}\small\item\em our command; \item\end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Headers for the entire pgpmac project. \begin{DoxyDate}{Date}
2012 
\end{DoxyDate}
\begin{DoxyAuthor}{Author}
Keith Brister  All Rights Reserved 
\end{DoxyAuthor}


Definition in file \hyperlink{pgpmac_8h_source}{pgpmac.h}.

\subsection{Define Documentation}
\hypertarget{pgpmac_8h_a3bae94e8e4e4347dd5f87b6bda058de6}{
\index{pgpmac.h@{pgpmac.h}!LS\_\-DISPLAY\_\-WINDOW\_\-HEIGHT@{LS\_\-DISPLAY\_\-WINDOW\_\-HEIGHT}}
\index{LS\_\-DISPLAY\_\-WINDOW\_\-HEIGHT@{LS\_\-DISPLAY\_\-WINDOW\_\-HEIGHT}!pgpmac.h@{pgpmac.h}}
\subsubsection[{LS\_\-DISPLAY\_\-WINDOW\_\-HEIGHT}]{\setlength{\rightskip}{0pt plus 5cm}\#define LS\_\-DISPLAY\_\-WINDOW\_\-HEIGHT~8}}
\label{pgpmac_8h_a3bae94e8e4e4347dd5f87b6bda058de6}


Number of status box rows. 

Definition at line 29 of file pgpmac.h.\hypertarget{pgpmac_8h_a1f96754f00a1f82414cebc66f75ded78}{
\index{pgpmac.h@{pgpmac.h}!LS\_\-DISPLAY\_\-WINDOW\_\-WIDTH@{LS\_\-DISPLAY\_\-WINDOW\_\-WIDTH}}
\index{LS\_\-DISPLAY\_\-WINDOW\_\-WIDTH@{LS\_\-DISPLAY\_\-WINDOW\_\-WIDTH}!pgpmac.h@{pgpmac.h}}
\subsubsection[{LS\_\-DISPLAY\_\-WINDOW\_\-WIDTH}]{\setlength{\rightskip}{0pt plus 5cm}\#define LS\_\-DISPLAY\_\-WINDOW\_\-WIDTH~24}}
\label{pgpmac_8h_a1f96754f00a1f82414cebc66f75ded78}


Number of status box columns. 

Definition at line 33 of file pgpmac.h.\hypertarget{pgpmac_8h_a3a8ef1b4b5994d6dd12bf74454ea891b}{
\index{pgpmac.h@{pgpmac.h}!LS\_\-PG\_\-QUERY\_\-STRING\_\-LENGTH@{LS\_\-PG\_\-QUERY\_\-STRING\_\-LENGTH}}
\index{LS\_\-PG\_\-QUERY\_\-STRING\_\-LENGTH@{LS\_\-PG\_\-QUERY\_\-STRING\_\-LENGTH}!pgpmac.h@{pgpmac.h}}
\subsubsection[{LS\_\-PG\_\-QUERY\_\-STRING\_\-LENGTH}]{\setlength{\rightskip}{0pt plus 5cm}\#define LS\_\-PG\_\-QUERY\_\-STRING\_\-LENGTH~1024}}
\label{pgpmac_8h_a3a8ef1b4b5994d6dd12bf74454ea891b}


Fixed length postgresql query strings. Queries should all be function calls so this is not as weird as one might think. 

Definition at line 36 of file pgpmac.h.\hypertarget{pgpmac_8h_ab61d790b5572f116e091babfda53627b}{
\index{pgpmac.h@{pgpmac.h}!LSEVENTS\_\-EVENT\_\-LENGTH@{LSEVENTS\_\-EVENT\_\-LENGTH}}
\index{LSEVENTS\_\-EVENT\_\-LENGTH@{LSEVENTS\_\-EVENT\_\-LENGTH}!pgpmac.h@{pgpmac.h}}
\subsubsection[{LSEVENTS\_\-EVENT\_\-LENGTH}]{\setlength{\rightskip}{0pt plus 5cm}\#define LSEVENTS\_\-EVENT\_\-LENGTH~32}}
\label{pgpmac_8h_ab61d790b5572f116e091babfda53627b}


Fixed length for event names: simplifies string handling. 

Definition at line 39 of file pgpmac.h.\hypertarget{pgpmac_8h_a30f0f377b0f0695284145d420ea51846}{
\index{pgpmac.h@{pgpmac.h}!MD2CMDS\_\-CMD\_\-LENGTH@{MD2CMDS\_\-CMD\_\-LENGTH}}
\index{MD2CMDS\_\-CMD\_\-LENGTH@{MD2CMDS\_\-CMD\_\-LENGTH}!pgpmac.h@{pgpmac.h}}
\subsubsection[{MD2CMDS\_\-CMD\_\-LENGTH}]{\setlength{\rightskip}{0pt plus 5cm}\#define MD2CMDS\_\-CMD\_\-LENGTH~32}}
\label{pgpmac_8h_a30f0f377b0f0695284145d420ea51846}


Definition at line 333 of file pgpmac.h.

\subsection{Typedef Documentation}
\hypertarget{pgpmac_8h_a48b627e412dd038c1f17cdb0501eec33}{
\index{pgpmac.h@{pgpmac.h}!lspg\_\-getcenter\_\-t@{lspg\_\-getcenter\_\-t}}
\index{lspg\_\-getcenter\_\-t@{lspg\_\-getcenter\_\-t}!pgpmac.h@{pgpmac.h}}
\subsubsection[{lspg\_\-getcenter\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf lspg\_\-getcenter\_\-struct}  {\bf lspg\_\-getcenter\_\-t}}}
\label{pgpmac_8h_a48b627e412dd038c1f17cdb0501eec33}


Storage for getcenter query Used for the md2 ROTATE command that generates the centering movies. \hypertarget{pgpmac_8h_a17ea2bf07a0b3b892baa00bd392607b3}{
\index{pgpmac.h@{pgpmac.h}!lspg\_\-nextshot\_\-t@{lspg\_\-nextshot\_\-t}}
\index{lspg\_\-nextshot\_\-t@{lspg\_\-nextshot\_\-t}!pgpmac.h@{pgpmac.h}}
\subsubsection[{lspg\_\-nextshot\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf lspg\_\-nextshot\_\-struct}  {\bf lspg\_\-nextshot\_\-t}}}
\label{pgpmac_8h_a17ea2bf07a0b3b892baa00bd392607b3}


Storage definition for nextshot query. The next shot query returns all the information needed to collect the next data frame. Since SQL allows for null fields independently from blank strings a separate integer is used as a flag for this case. This adds to the program complexity but allows for some important cases. Suck it up. definition of the next image to be taken (and the one after that, too!) \hypertarget{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}{
\index{pgpmac.h@{pgpmac.h}!lspmac\_\-motor\_\-t@{lspmac\_\-motor\_\-t}}
\index{lspmac\_\-motor\_\-t@{lspmac\_\-motor\_\-t}!pgpmac.h@{pgpmac.h}}
\subsubsection[{lspmac\_\-motor\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf lspmac\_\-motor\_\-struct}  {\bf lspmac\_\-motor\_\-t}}}
\label{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}


Motor information. A catchall for motors and motor like objects. Not all members are used by all objects. \hypertarget{pgpmac_8h_a99c275e32ad897dca34d196b91f038cb}{
\index{pgpmac.h@{pgpmac.h}!pmac\_\-cmd\_\-queue\_\-t@{pmac\_\-cmd\_\-queue\_\-t}}
\index{pmac\_\-cmd\_\-queue\_\-t@{pmac\_\-cmd\_\-queue\_\-t}!pgpmac.h@{pgpmac.h}}
\subsubsection[{pmac\_\-cmd\_\-queue\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf lspmac\_\-cmd\_\-queue\_\-struct}  {\bf pmac\_\-cmd\_\-queue\_\-t}}}
\label{pgpmac_8h_a99c275e32ad897dca34d196b91f038cb}


PMAC command queue item. Command queue items are fixed length to simplify memory management. \hypertarget{pgpmac_8h_a2d163436571135a457f4a4e2fbd09633}{
\index{pgpmac.h@{pgpmac.h}!pmac\_\-cmd\_\-t@{pmac\_\-cmd\_\-t}}
\index{pmac\_\-cmd\_\-t@{pmac\_\-cmd\_\-t}!pgpmac.h@{pgpmac.h}}
\subsubsection[{pmac\_\-cmd\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf tagEthernetCmd}  {\bf pmac\_\-cmd\_\-t}}}
\label{pgpmac_8h_a2d163436571135a457f4a4e2fbd09633}


PMAC ethernet packet definition. Taken directly from the Delta Tau documentation. 

\subsection{Function Documentation}
\hypertarget{pgpmac_8h_aac89b916c1152c44042875feac35a9e4}{
\index{pgpmac.h@{pgpmac.h}!lsevents\_\-add\_\-listener@{lsevents\_\-add\_\-listener}}
\index{lsevents\_\-add\_\-listener@{lsevents\_\-add\_\-listener}!pgpmac.h@{pgpmac.h}}
\subsubsection[{lsevents\_\-add\_\-listener}]{\setlength{\rightskip}{0pt plus 5cm}void lsevents\_\-add\_\-listener (char $\ast$, \/  void($\ast$)(char $\ast$) {\em cb})}}
\label{pgpmac_8h_aac89b916c1152c44042875feac35a9e4}


Definition at line 61 of file lsevents.c.


\begin{DoxyCode}
61                                                              {
62   lsevents_listener_t *new;
63 
64   new = calloc( 1, sizeof( lsevents_listener_t));
65   if( new == NULL) {
66     lslogging_log_message( "lsevents_add_listener: out of memory");
67     exit( -1);
68   }
69 
70   strncpy( new->event, event, LSEVENTS_EVENT_LENGTH);
71   new->event[LSEVENTS_EVENT_LENGTH-1] = 0;
72   new->cb   = cb;
73   new->next = lsevents_listeners_p;
74 
75   pthread_mutex_lock( &lsevents_listener_mutex);
76   lsevents_listeners_p = new;
77   pthread_mutex_unlock( &lsevents_listener_mutex);
78 
79   lslogging_log_message( "lsevents_add_listener: added listener for event %s", ev
      ent);
80 
81 }
\end{DoxyCode}
\hypertarget{pgpmac_8h_af19a77187e7406fc87d36bd26e672e6d}{
\index{pgpmac.h@{pgpmac.h}!lsevents\_\-init@{lsevents\_\-init}}
\index{lsevents\_\-init@{lsevents\_\-init}!pgpmac.h@{pgpmac.h}}
\subsubsection[{lsevents\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}void lsevents\_\-init ()}}
\label{pgpmac_8h_af19a77187e7406fc87d36bd26e672e6d}


Definition at line 163 of file lsevents.c.


\begin{DoxyCode}
163                      {
164   pthread_mutex_init( &lsevents_queue_mutex, NULL);
165   pthread_cond_init(  &lsevents_queue_cond, NULL);
166   pthread_mutex_init( &lsevents_listener_mutex, NULL);
167 }
\end{DoxyCode}
\hypertarget{pgpmac_8h_a024b08c7820bb31c3d5b8f281e07f3e8}{
\index{pgpmac.h@{pgpmac.h}!lsevents\_\-remove\_\-listener@{lsevents\_\-remove\_\-listener}}
\index{lsevents\_\-remove\_\-listener@{lsevents\_\-remove\_\-listener}!pgpmac.h@{pgpmac.h}}
\subsubsection[{lsevents\_\-remove\_\-listener}]{\setlength{\rightskip}{0pt plus 5cm}void lsevents\_\-remove\_\-listener (char $\ast$, \/  void($\ast$)(char $\ast$) {\em cb})}}
\label{pgpmac_8h_a024b08c7820bb31c3d5b8f281e07f3e8}


Definition at line 83 of file lsevents.c.


\begin{DoxyCode}
83                                                                 {
84   
85   lsevents_listener_t *last, *current;
86 
87   //
88   // Find the listener to remove
89   // and unlink it from the list
90   //
91   pthread_mutex_lock( &lsevents_listener_mutex);
92   last = NULL;
93   for( current = lsevents_listeners_p; current != NULL; current = current->next) 
      {
94     if( strcmp( last->event, event) == 0 && last->cb == cb) {
95       if( last == NULL) {
96         lsevents_listeners_p = current->next;
97       } else {
98         last->next = current->next;
99       }
100       break;
101     }
102   }
103   pthread_mutex_unlock( &lsevents_listener_mutex);
104 
105   //
106   // Now remove it
107   // TODO: use saner memory management where we allocate many listeners at a time
      
108   // as an array and then just flag the ones that are used
109   //
110   if( current != NULL) {
111     if( current->event != NULL)
112       free( current->event);
113     free(current);
114   }
115 }
\end{DoxyCode}
\hypertarget{pgpmac_8h_a4ddde538b603e3d4580ae9356bf9b89d}{
\index{pgpmac.h@{pgpmac.h}!lsevents\_\-run@{lsevents\_\-run}}
\index{lsevents\_\-run@{lsevents\_\-run}!pgpmac.h@{pgpmac.h}}
\subsubsection[{lsevents\_\-run}]{\setlength{\rightskip}{0pt plus 5cm}void lsevents\_\-run ()}}
\label{pgpmac_8h_a4ddde538b603e3d4580ae9356bf9b89d}


Definition at line 169 of file lsevents.c.


\begin{DoxyCode}
169                     {
170   pthread_create( &lsevents_thread, NULL, lsevents_worker, NULL);
171 }
\end{DoxyCode}
\hypertarget{pgpmac_8h_a3661dfc51537c05b11f4fd184fdff07d}{
\index{pgpmac.h@{pgpmac.h}!lsevents\_\-send\_\-event@{lsevents\_\-send\_\-event}}
\index{lsevents\_\-send\_\-event@{lsevents\_\-send\_\-event}!pgpmac.h@{pgpmac.h}}
\subsubsection[{lsevents\_\-send\_\-event}]{\setlength{\rightskip}{0pt plus 5cm}void lsevents\_\-send\_\-event (char $\ast$, \/   {\em ...})}}
\label{pgpmac_8h_a3661dfc51537c05b11f4fd184fdff07d}


Definition at line 33 of file lsevents.c.


\begin{DoxyCode}
33                                           {
34   char event[LSEVENTS_EVENT_LENGTH];
35   char *sp;
36   va_list arg_ptr;
37 
38   va_start( arg_ptr, fmt);
39   vsnprintf( event, sizeof(event)-1, fmt, arg_ptr);
40   event[sizeof(event)-1]=0;
41   va_end( arg_ptr);
42 
43   lslogging_log_message( "lsevents_send_event: %s", event);
44 
45   pthread_mutex_lock( &lsevents_queue_mutex);
46 
47   // maybe wait for room on the queue
48   while( lsevents_queue_on + 1 == lsevents_queue_off)
49     pthread_cond_wait( &lsevents_queue_cond, &lsevents_queue_mutex);
50   
51   sp = lsevents_queue[(lsevents_queue_on++) % LSEVENTS_QUEUE_LENGTH].event;
52   strncpy( sp, event, LSEVENTS_EVENT_LENGTH);
53   sp[LSEVENTS_EVENT_LENGTH - 1] = 0;
54 
55   pthread_cond_signal(  &lsevents_queue_cond);
56   pthread_mutex_unlock( &lsevents_queue_mutex);
57 
58 }
\end{DoxyCode}
\hypertarget{pgpmac_8h_a8a77972df14166e05c94ed0792baa09b}{
\index{pgpmac.h@{pgpmac.h}!lspg\_\-init@{lspg\_\-init}}
\index{lspg\_\-init@{lspg\_\-init}!pgpmac.h@{pgpmac.h}}
\subsubsection[{lspg\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}void lspg\_\-init ()}}
\label{pgpmac_8h_a8a77972df14166e05c94ed0792baa09b}


Initiallize the lspg module. 

Definition at line 1638 of file lspg.c.


\begin{DoxyCode}
1638                  {
1639   pthread_mutex_init( &lspg_queue_mutex, NULL);
1640   pthread_cond_init( &lspg_queue_cond, NULL);
1641   lspg_nextshot_init();
1642   lspg_getcenter_init();
1643   lspg_wait_for_detector_init();
1644   lspg_lock_diffractometer_init();
1645   lspg_lock_detector_init();
1646 }
\end{DoxyCode}
\hypertarget{pgpmac_8h_a1adfdb5ca9fdb5060849d726bf540117}{
\index{pgpmac.h@{pgpmac.h}!lspg\_\-run@{lspg\_\-run}}
\index{lspg\_\-run@{lspg\_\-run}!pgpmac.h@{pgpmac.h}}
\subsubsection[{lspg\_\-run}]{\setlength{\rightskip}{0pt plus 5cm}void lspg\_\-run ()}}
\label{pgpmac_8h_a1adfdb5ca9fdb5060849d726bf540117}


Start 'er runnin'. 

Definition at line 1650 of file lspg.c.


\begin{DoxyCode}
1650                 {
1651   pthread_create( &lspg_thread, NULL, lspg_worker, NULL);
1652 }
\end{DoxyCode}
\hypertarget{pgpmac_8h_a4253474d4dd305aec0afdd5552b3ddd5}{
\index{pgpmac.h@{pgpmac.h}!lspg\_\-seq\_\-run\_\-prep\_\-all@{lspg\_\-seq\_\-run\_\-prep\_\-all}}
\index{lspg\_\-seq\_\-run\_\-prep\_\-all@{lspg\_\-seq\_\-run\_\-prep\_\-all}!pgpmac.h@{pgpmac.h}}
\subsubsection[{lspg\_\-seq\_\-run\_\-prep\_\-all}]{\setlength{\rightskip}{0pt plus 5cm}void lspg\_\-seq\_\-run\_\-prep\_\-all (long long {\em skey}, \/  double {\em kappa}, \/  double {\em phi}, \/  double {\em cx}, \/  double {\em cy}, \/  double {\em ax}, \/  double {\em ay}, \/  double {\em az})}}
\label{pgpmac_8h_a4253474d4dd305aec0afdd5552b3ddd5}


Convinence function to call seq run prep. 
\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em skey}]px.shots key for this image \item[\mbox{$\leftarrow$} {\em kappa}]current kappa postion \item[\mbox{$\leftarrow$} {\em phi}]current phi postition \item[\mbox{$\leftarrow$} {\em cx}]current center table x \item[\mbox{$\leftarrow$} {\em cy}]current center table y \item[\mbox{$\leftarrow$} {\em ax}]current alignment table x \item[\mbox{$\leftarrow$} {\em ay}]current alignment table y \item[\mbox{$\leftarrow$} {\em az}]current alignment table z \end{DoxyParams}


Definition at line 979 of file lspg.c.


\begin{DoxyCode}
988                              {
989   lspg_seq_run_prep_call( skey, kappa, phi, cx, cy, ax, ay, az);
990   lspg_seq_run_prep_wait();
991   lspg_seq_run_prep_done();
992 }
\end{DoxyCode}
\hypertarget{pgpmac_8h_a95e3fd7c1685d7e6ab6d0a295ab42f78}{
\index{pgpmac.h@{pgpmac.h}!lspg\_\-zoom\_\-lut\_\-call@{lspg\_\-zoom\_\-lut\_\-call}}
\index{lspg\_\-zoom\_\-lut\_\-call@{lspg\_\-zoom\_\-lut\_\-call}!pgpmac.h@{pgpmac.h}}
\subsubsection[{lspg\_\-zoom\_\-lut\_\-call}]{\setlength{\rightskip}{0pt plus 5cm}void lspg\_\-zoom\_\-lut\_\-call ()}}
\label{pgpmac_8h_a95e3fd7c1685d7e6ab6d0a295ab42f78}
\hypertarget{pgpmac_8h_ae3e30b0ba9b5d5a291fa29b77ba920d8}{
\index{pgpmac.h@{pgpmac.h}!lspmac\_\-init@{lspmac\_\-init}}
\index{lspmac\_\-init@{lspmac\_\-init}!pgpmac.h@{pgpmac.h}}
\subsubsection[{lspmac\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}void lspmac\_\-init (int, \/  int)}}
\label{pgpmac_8h_ae3e30b0ba9b5d5a291fa29b77ba920d8}


Initialize this module. 

Definition at line 2100 of file lspmac.c.


\begin{DoxyCode}
2103                    {
2104   md2_status_t *p;
2105 
2106   // Set our global harvest flags
2107   getivars = ivarsflag;
2108   getmvars = mvarsflag;
2109 
2110   // All important status mutex
2111   pthread_mutex_init( &md2_status_mutex, NULL);
2112 
2113   //
2114   // Initialize the motor objects
2115   //
2116 
2117   p = &md2_status;
2118 
2119   omega  = lspmac_motor_init( &(lspmac_motors[ 0]),  1, 0, 0, &p->omega_act_pos, 
          &p->omega_status_1,     &p->omega_status_2,     "Omega   #1 &1 X", "omega",  
           lspmac_moveabs_queue);
2120   alignx = lspmac_motor_init( &(lspmac_motors[ 1]),  2, 0, 1, &p->alignx_act_pos,
          &p->alignx_status_1,    &p->alignx_status_2,    "Align X #2 &3 X", "align.x",
           lspmac_moveabs_queue);
2121   aligny = lspmac_motor_init( &(lspmac_motors[ 2]),  3, 0, 2, &p->aligny_act_pos,
          &p->aligny_status_1,    &p->aligny_status_2,    "Align Y #3 &3 Y", "align.y",
           lspmac_moveabs_queue);
2122   alignz = lspmac_motor_init( &(lspmac_motors[ 3]),  4, 0, 3, &p->alignz_act_pos,
          &p->alignz_status_1,    &p->alignz_status_2,    "Align Z #4 &3 Z", "align.z",
           lspmac_moveabs_queue);
2123   anal   = lspmac_motor_init( &(lspmac_motors[ 4]),  5, 0, 4, &p->
      analyzer_act_pos,  &p->analyzer_status_1,  &p->analyzer_status_2,  "Anal    #5", 
           "lightPolar",  lspmac_moveabs_queue);
2124   zoom   = lspmac_motor_init( &(lspmac_motors[ 5]),  6, 1, 0, &p->zoom_act_pos,  
          &p->zoom_status_1,      &p->zoom_status_2,      "Zoom    #6 &4 Z", "zoom",   
           lspmac_movezoom_queue);
2125   apery  = lspmac_motor_init( &(lspmac_motors[ 6]),  7, 1, 1, &p->
      aperturey_act_pos, &p->aperturey_status_1, &p->aperturey_status_2, "Aper Y  #7 &5
       Y", "appy",        lspmac_moveabs_queue);
2126   aperz  = lspmac_motor_init( &(lspmac_motors[ 7]),  8, 1, 2, &p->
      aperturez_act_pos, &p->aperturez_status_1, &p->aperturez_status_2, "Aper Z  #8 &5
       Z", "appz",        lspmac_moveabs_queue);
2127   capy   = lspmac_motor_init( &(lspmac_motors[ 8]),  9, 1, 3, &p->capy_act_pos,  
          &p->capy_status_1,      &p->capy_status_2,      "Cap Y   #9 &5 U", "capy",   
           lspmac_moveabs_queue);
2128   capz   = lspmac_motor_init( &(lspmac_motors[ 9]), 10, 1, 4, &p->capz_act_pos,  
          &p->capz_status_1,      &p->capz_status_2,      "Cap Z  #10 &5 V", "capz",   
           lspmac_moveabs_queue);
2129   scinz  = lspmac_motor_init( &(lspmac_motors[10]), 11, 2, 0, &p->scint_act_pos, 
          &p->scint_status_1,     &p->scint_status_2,     "Scin Z #11 &5 W", "scint",  
           lspmac_moveabs_queue);
2130   cenx   = lspmac_motor_init( &(lspmac_motors[11]), 17, 2, 1, &p->
      centerx_act_pos,   &p->centerx_status_1,   &p->centerx_status_2,   "Cen X  #17 &2
       X", "centering.x", lspmac_moveabs_queue);
2131   ceny   = lspmac_motor_init( &(lspmac_motors[12]), 18, 2, 2, &p->
      centery_act_pos,   &p->centery_status_1,   &p->centery_status_2,   "Cen Y  #18 &2
       Y", "centering.y", lspmac_moveabs_queue);
2132   kappa  = lspmac_motor_init( &(lspmac_motors[13]), 19, 2, 3, &p->kappa_act_pos, 
          &p->kappa_status_1,     &p->kappa_status_2,     "Kappa  #19 &7 X", "kappa",  
           lspmac_moveabs_queue);
2133   phi    = lspmac_motor_init( &(lspmac_motors[14]), 20, 2, 4, &p->phi_act_pos,   
          &p->phi_status_1,       &p->phi_status_2,       "Phi    #20 &7 Y", "phi",    
           lspmac_moveabs_queue);
2134 
2135   fshut  = lspmac_fshut_init( &(lspmac_motors[15]));
2136   flight = lspmac_dac_init( &(lspmac_motors[16]), &p->front_dac,   160.0, "M1200"
      , "frontLight.intensity");
2137   blight = lspmac_dac_init( &(lspmac_motors[17]), &p->back_dac,    160.0, "M1201"
      , "backLight.intensity");
2138   fscint = lspmac_dac_init( &(lspmac_motors[18]), &p->scint_piezo, 320.0, "M1203"
      , "scint.focus");
2139 
2140   blight_ud = lspmac_bio_init( &(lspmac_motors[19]), "backLight", "M1101=%d", &(
      md2_status.acc11c_5), 0x02);
2141   cryo      = lspmac_bio_init( &(lspmac_motors[20]), "cryo",      "M1102=%d", &(
      md2_status.acc11c_1), 0x40);
2142   dryer     = lspmac_bio_init( &(lspmac_motors[21]), "dryer",     "M1103=%d", &(
      md2_status.acc11c_5), 0x08);
2143 
2144 
2145 
2146 
2147   //
2148   // Initialize several commands that get called, perhaps, alot
2149   //
2150   rr_cmd.RequestType = VR_UPLOAD;
2151   rr_cmd.Request     = VR_PMAC_READREADY;
2152   rr_cmd.wValue      = 0;
2153   rr_cmd.wIndex      = 0;
2154   rr_cmd.wLength     = htons(2);
2155   memset( rr_cmd.bData, 0, sizeof(rr_cmd.bData));
2156 
2157   gb_cmd.RequestType = VR_UPLOAD;
2158   gb_cmd.Request     = VR_PMAC_GETBUFFER;
2159   gb_cmd.wValue      = 0;
2160   gb_cmd.wIndex      = 0;
2161   gb_cmd.wLength     = htons(1400);
2162   memset( gb_cmd.bData, 0, sizeof(gb_cmd.bData));
2163 
2164   cr_cmd.RequestType = VR_UPLOAD;
2165   cr_cmd.Request     = VR_CTRL_RESPONSE;
2166   cr_cmd.wValue      = 0;
2167   cr_cmd.wIndex      = 0;
2168   cr_cmd.wLength     = htons(1400);
2169   memset( cr_cmd.bData, 0, sizeof(cr_cmd.bData));
2170 
2171   //
2172   // Initialize some mutexs and conditions
2173   //
2174 
2175   pthread_mutex_init( &pmac_queue_mutex, NULL);
2176   pthread_cond_init(  &pmac_queue_cond, NULL);
2177 
2178   lspmac_shutter_state = 0;                             // assume the shutter is 
      now closed: not a big deal if we are wrong
2179   pthread_mutex_init( &lspmac_shutter_mutex, NULL);
2180   pthread_cond_init(  &lspmac_shutter_cond, NULL);
2181   pmacfd.fd = -1;
2182 
2183   pthread_mutex_init( &lspmac_moving_mutex, NULL);
2184   pthread_cond_init(  &lspmac_moving_cond, NULL);
2185 
2186 }
\end{DoxyCode}
\hypertarget{pgpmac_8h_a3a7fb93fb3fb9c4454613f30bfb0b1ee}{
\index{pgpmac.h@{pgpmac.h}!lspmac\_\-run@{lspmac\_\-run}}
\index{lspmac\_\-run@{lspmac\_\-run}!pgpmac.h@{pgpmac.h}}
\subsubsection[{lspmac\_\-run}]{\setlength{\rightskip}{0pt plus 5cm}void lspmac\_\-run ()}}
\label{pgpmac_8h_a3a7fb93fb3fb9c4454613f30bfb0b1ee}


Start up the lspmac thread. 

Definition at line 2190 of file lspmac.c.


\begin{DoxyCode}
2190                   {
2191   pthread_create( &pmac_thread, NULL, lspmac_worker, NULL);
2192 }
\end{DoxyCode}
\hypertarget{pgpmac_8h_af712dd2e9419026eff2762ba062eeaf1}{
\index{pgpmac.h@{pgpmac.h}!lstimer\_\-add\_\-timer@{lstimer\_\-add\_\-timer}}
\index{lstimer\_\-add\_\-timer@{lstimer\_\-add\_\-timer}!pgpmac.h@{pgpmac.h}}
\subsubsection[{lstimer\_\-add\_\-timer}]{\setlength{\rightskip}{0pt plus 5cm}void lstimer\_\-add\_\-timer (char $\ast$, \/  int, \/  unsigned long {\em int}, \/  unsigned long {\em int})}}
\label{pgpmac_8h_af712dd2e9419026eff2762ba062eeaf1}


Definition at line 41 of file lstimer.c.


\begin{DoxyCode}
41                                                                                  
                      {
42   int i;
43   struct timespec now;
44 
45   //
46   // Time we were called.  Delay is based on call time, not queued time
47   //
48   clock_gettime( CLOCK_REALTIME, &now);
49   
50 
51   pthread_mutex_lock( &lstimer_mutex);
52 
53   for( i=0; i<LSTIMER_LIST_LENGTH; i++) {
54     if( lstimer_list[i].shots == 0)
55       break;
56   }
57 
58   if( i == LSTIMER_LIST_LENGTH) {
59     pthread_mutex_unlock( &lstimer_mutex);
60     
61     lslogging_log_message( "lstimer_add_timer: out of timers for event: %s, shots
      : %d,  secs: %u, nsecs: %u",
62                           event, shots, secs, nsecs);
63     return;
64   }
65 
66   strncpy( lstimer_list[i].event, event, LSEVENTS_EVENT_LENGTH - 1);
67   lstimer_list[i].event[LSEVENTS_EVENT_LENGTH - 1] = 0;
68   lstimer_list[i].shots        = shots;
69   lstimer_list[i].delay_secs   = secs;
70   lstimer_list[i].delay_nsecs  = nsecs;
71 
72   lstimer_list[i].next_secs    = secs + now.tv_sec + (now.tv_nsec + nsecs) / 1000
      000000;
73   lstimer_list[i].next_nsecs   = (now.tv_nsec + nsecs) % 1000000000;
74   lstimer_list[i].last_secs    = 0;
75   lstimer_list[i].last_nsecs   = 0;
76   
77   lstimer_list[i].ncalls       = 0;
78   lstimer_list[i].init_secs    = now.tv_sec;
79   lstimer_list[i].init_nsecs   = now.tv_nsec;
80 
81   if( shots != 0) {
82     lstimer_active_timers++;
83     new_timer++;
84   }
85 
86   pthread_cond_signal(  &lstimer_cond);
87   pthread_mutex_unlock( &lstimer_mutex);
88 }
\end{DoxyCode}
\hypertarget{pgpmac_8h_a8cd37a8fb0f061456456a5d79bdd5189}{
\index{pgpmac.h@{pgpmac.h}!lstimer\_\-init@{lstimer\_\-init}}
\index{lstimer\_\-init@{lstimer\_\-init}!pgpmac.h@{pgpmac.h}}
\subsubsection[{lstimer\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}void lstimer\_\-init ()}}
\label{pgpmac_8h_a8cd37a8fb0f061456456a5d79bdd5189}


Definition at line 244 of file lstimer.c.


\begin{DoxyCode}
244                     {
245   int i;
246 
247   for( i=0; i<LSTIMER_LIST_LENGTH; i++) {
248     lstimer_list[i].shots = 0;
249   }
250 
251 
252   pthread_mutex_init( &lstimer_mutex, NULL);
253   pthread_cond_init(  &lstimer_cond, NULL);
254 }
\end{DoxyCode}
\hypertarget{pgpmac_8h_a0b918acc1a4bf737cb62b5a70f8b553a}{
\index{pgpmac.h@{pgpmac.h}!lstimer\_\-run@{lstimer\_\-run}}
\index{lstimer\_\-run@{lstimer\_\-run}!pgpmac.h@{pgpmac.h}}
\subsubsection[{lstimer\_\-run}]{\setlength{\rightskip}{0pt plus 5cm}void lstimer\_\-run ()}}
\label{pgpmac_8h_a0b918acc1a4bf737cb62b5a70f8b553a}


Definition at line 261 of file lstimer.c.


\begin{DoxyCode}
261                    {
262   pthread_create( &lstimer_thread, NULL, lstimer_worker, NULL);
263   //  lsevents_add_listener( "watchdog", lstimer_test_cb);
264   //  lstimer_add_timer( "watchdog", -1, 1, 0);
265 }
\end{DoxyCode}
\hypertarget{pgpmac_8h_adf63440ffbc65024fef87ea6a11ea8b0}{
\index{pgpmac.h@{pgpmac.h}!lsupdate\_\-init@{lsupdate\_\-init}}
\index{lsupdate\_\-init@{lsupdate\_\-init}!pgpmac.h@{pgpmac.h}}
\subsubsection[{lsupdate\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}void lsupdate\_\-init ()}}
\label{pgpmac_8h_adf63440ffbc65024fef87ea6a11ea8b0}


Initialize this module. 

Definition at line 108 of file lsupdate.c.


\begin{DoxyCode}
108                      {
109 }
\end{DoxyCode}
\hypertarget{pgpmac_8h_af219e9b2cc124f109aa4c2c2e16b5d07}{
\index{pgpmac.h@{pgpmac.h}!lsupdate\_\-run@{lsupdate\_\-run}}
\index{lsupdate\_\-run@{lsupdate\_\-run}!pgpmac.h@{pgpmac.h}}
\subsubsection[{lsupdate\_\-run}]{\setlength{\rightskip}{0pt plus 5cm}void lsupdate\_\-run ()}}
\label{pgpmac_8h_af219e9b2cc124f109aa4c2c2e16b5d07}


run the update routines 

Definition at line 113 of file lsupdate.c.


\begin{DoxyCode}
113                     {
114   pthread_create( &lsupdate_thread, NULL, lsupdate_worker, NULL);
115 }
\end{DoxyCode}
\hypertarget{pgpmac_8h_a0851b1baecda6a67993efde41d77b1c1}{
\index{pgpmac.h@{pgpmac.h}!md2cmds\_\-init@{md2cmds\_\-init}}
\index{md2cmds\_\-init@{md2cmds\_\-init}!pgpmac.h@{pgpmac.h}}
\subsubsection[{md2cmds\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}void md2cmds\_\-init ()}}
\label{pgpmac_8h_a0851b1baecda6a67993efde41d77b1c1}


Initialize the md2cmds module. 

Definition at line 529 of file md2cmds.c.


\begin{DoxyCode}
529                     {
530   memset( md2cmds_cmd, 0, sizeof( md2cmds_cmd));
531 
532   pthread_mutex_init( &md2cmds_mutex, NULL);
533   pthread_cond_init( &md2cmds_cond, NULL);
534 
535   pthread_mutex_init( &md2cmds_pg_mutex, NULL);
536   pthread_cond_init( &md2cmds_pg_cond, NULL);
537 
538 }
\end{DoxyCode}
\hypertarget{pgpmac_8h_aa62da7d423952334d41c7d282f45233d}{
\index{pgpmac.h@{pgpmac.h}!md2cmds\_\-run@{md2cmds\_\-run}}
\index{md2cmds\_\-run@{md2cmds\_\-run}!pgpmac.h@{pgpmac.h}}
\subsubsection[{md2cmds\_\-run}]{\setlength{\rightskip}{0pt plus 5cm}void md2cmds\_\-run ()}}
\label{pgpmac_8h_aa62da7d423952334d41c7d282f45233d}


Start up the thread. 

Definition at line 542 of file md2cmds.c.


\begin{DoxyCode}
542                    {
543   pthread_create( &md2cmds_thread, NULL, md2cmds_worker, NULL);
544 }
\end{DoxyCode}
\hypertarget{pgpmac_8h_a7762ca7b97b44b979e23ce88ca3b4249}{
\index{pgpmac.h@{pgpmac.h}!pgpmac\_\-printf@{pgpmac\_\-printf}}
\index{pgpmac\_\-printf@{pgpmac\_\-printf}!pgpmac.h@{pgpmac.h}}
\subsubsection[{pgpmac\_\-printf}]{\setlength{\rightskip}{0pt plus 5cm}void pgpmac\_\-printf (char $\ast$ {\em fmt}, \/   {\em ...})}}
\label{pgpmac_8h_a7762ca7b97b44b979e23ce88ca3b4249}


Terminal output routine ala printf. 
\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em fmt}]Printf style formating string \end{DoxyParams}


Definition at line 317 of file pgpmac.c.


\begin{DoxyCode}
320                      {
321   va_list arg_ptr;
322 
323   pthread_mutex_lock( &ncurses_mutex);
324 
325   va_start( arg_ptr, fmt);
326   vwprintw( term_output, fmt, arg_ptr);
327   va_end( arg_ptr);
328 
329   wnoutrefresh( term_output);
330   wnoutrefresh( term_input);
331   doupdate();
332 
333   pthread_mutex_unlock( &ncurses_mutex);
334 
335 }
\end{DoxyCode}
\hypertarget{pgpmac_8h_a76b11c62b122ee0fd8399435d4260681}{
\index{pgpmac.h@{pgpmac.h}!PmacSockSendline@{PmacSockSendline}}
\index{PmacSockSendline@{PmacSockSendline}!pgpmac.h@{pgpmac.h}}
\subsubsection[{PmacSockSendline}]{\setlength{\rightskip}{0pt plus 5cm}void PmacSockSendline (char $\ast$ {\em s})}}
\label{pgpmac_8h_a76b11c62b122ee0fd8399435d4260681}


\subsection{Variable Documentation}
\hypertarget{pgpmac_8h_a6cb218bdccfe5a93471c161f15a15cab}{
\index{pgpmac.h@{pgpmac.h}!alignx@{alignx}}
\index{alignx@{alignx}!pgpmac.h@{pgpmac.h}}
\subsubsection[{alignx}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\_\-motor\_\-t}$\ast$ {\bf alignx}}}
\label{pgpmac_8h_a6cb218bdccfe5a93471c161f15a15cab}


Alignment stage X. 

Definition at line 74 of file lspmac.c.\hypertarget{pgpmac_8h_a737c246c3948e644a18d191a931e1acd}{
\index{pgpmac.h@{pgpmac.h}!aligny@{aligny}}
\index{aligny@{aligny}!pgpmac.h@{pgpmac.h}}
\subsubsection[{aligny}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\_\-motor\_\-t}$\ast$ {\bf aligny}}}
\label{pgpmac_8h_a737c246c3948e644a18d191a931e1acd}


Alignment stage Y. 

Definition at line 75 of file lspmac.c.\hypertarget{pgpmac_8h_ae7642b1da0f7c7f8448104c691d40a12}{
\index{pgpmac.h@{pgpmac.h}!alignz@{alignz}}
\index{alignz@{alignz}!pgpmac.h@{pgpmac.h}}
\subsubsection[{alignz}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\_\-motor\_\-t}$\ast$ {\bf alignz}}}
\label{pgpmac_8h_ae7642b1da0f7c7f8448104c691d40a12}


Alignment stage X. 

Definition at line 76 of file lspmac.c.\hypertarget{pgpmac_8h_aa90d2363b744acbd4d45133b7a716d8f}{
\index{pgpmac.h@{pgpmac.h}!anal@{anal}}
\index{anal@{anal}!pgpmac.h@{pgpmac.h}}
\subsubsection[{anal}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\_\-motor\_\-t}$\ast$ {\bf anal}}}
\label{pgpmac_8h_aa90d2363b744acbd4d45133b7a716d8f}


Polaroid analyzer motor. 

Definition at line 77 of file lspmac.c.\hypertarget{pgpmac_8h_a139200ddaa9856a7ffcec0e6cbaa8f1b}{
\index{pgpmac.h@{pgpmac.h}!apery@{apery}}
\index{apery@{apery}!pgpmac.h@{pgpmac.h}}
\subsubsection[{apery}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\_\-motor\_\-t}$\ast$ {\bf apery}}}
\label{pgpmac_8h_a139200ddaa9856a7ffcec0e6cbaa8f1b}


Aperture Y. 

Definition at line 79 of file lspmac.c.\hypertarget{pgpmac_8h_ab93bd6ee850b285ca3a95e64d15e9477}{
\index{pgpmac.h@{pgpmac.h}!aperz@{aperz}}
\index{aperz@{aperz}!pgpmac.h@{pgpmac.h}}
\subsubsection[{aperz}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\_\-motor\_\-t}$\ast$ {\bf aperz}}}
\label{pgpmac_8h_ab93bd6ee850b285ca3a95e64d15e9477}


Aperture Z. 

Definition at line 80 of file lspmac.c.\hypertarget{pgpmac_8h_a85d6eaa4b4a82bb3112574f458d1dc50}{
\index{pgpmac.h@{pgpmac.h}!blight@{blight}}
\index{blight@{blight}!pgpmac.h@{pgpmac.h}}
\subsubsection[{blight}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\_\-motor\_\-t}$\ast$ {\bf blight}}}
\label{pgpmac_8h_a85d6eaa4b4a82bb3112574f458d1dc50}


Back Light DAC. 

Definition at line 91 of file lspmac.c.\hypertarget{pgpmac_8h_af813a2eff0b7efa4c70633559054e84c}{
\index{pgpmac.h@{pgpmac.h}!blight\_\-ud@{blight\_\-ud}}
\index{blight\_\-ud@{blight\_\-ud}!pgpmac.h@{pgpmac.h}}
\subsubsection[{blight\_\-ud}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\_\-motor\_\-t}$\ast$ {\bf blight\_\-ud}}}
\label{pgpmac_8h_af813a2eff0b7efa4c70633559054e84c}


Back Light Up/Down actuator. 

Definition at line 94 of file lspmac.c.\hypertarget{pgpmac_8h_a51358daaea8b5236f08414877d8af6c2}{
\index{pgpmac.h@{pgpmac.h}!capy@{capy}}
\index{capy@{capy}!pgpmac.h@{pgpmac.h}}
\subsubsection[{capy}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\_\-motor\_\-t}$\ast$ {\bf capy}}}
\label{pgpmac_8h_a51358daaea8b5236f08414877d8af6c2}


Capillary Y. 

Definition at line 81 of file lspmac.c.\hypertarget{pgpmac_8h_aa45f268d0af9f3d465acfab128919718}{
\index{pgpmac.h@{pgpmac.h}!capz@{capz}}
\index{capz@{capz}!pgpmac.h@{pgpmac.h}}
\subsubsection[{capz}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\_\-motor\_\-t}$\ast$ {\bf capz}}}
\label{pgpmac_8h_aa45f268d0af9f3d465acfab128919718}


Capillary Z. 

Definition at line 82 of file lspmac.c.\hypertarget{pgpmac_8h_ac940d950d9efeaf3f0ae67e9bf331188}{
\index{pgpmac.h@{pgpmac.h}!cenx@{cenx}}
\index{cenx@{cenx}!pgpmac.h@{pgpmac.h}}
\subsubsection[{cenx}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\_\-motor\_\-t}$\ast$ {\bf cenx}}}
\label{pgpmac_8h_ac940d950d9efeaf3f0ae67e9bf331188}


Centering Table X. 

Definition at line 84 of file lspmac.c.\hypertarget{pgpmac_8h_aaed18e738ba7bfb6c771a44f5d7ea827}{
\index{pgpmac.h@{pgpmac.h}!ceny@{ceny}}
\index{ceny@{ceny}!pgpmac.h@{pgpmac.h}}
\subsubsection[{ceny}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\_\-motor\_\-t}$\ast$ {\bf ceny}}}
\label{pgpmac_8h_aaed18e738ba7bfb6c771a44f5d7ea827}


Centering Table Y. 

Definition at line 85 of file lspmac.c.\hypertarget{pgpmac_8h_ae78d9a757d4c85419fff9c94b15e25d7}{
\index{pgpmac.h@{pgpmac.h}!cryo@{cryo}}
\index{cryo@{cryo}!pgpmac.h@{pgpmac.h}}
\subsubsection[{cryo}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\_\-motor\_\-t}$\ast$ {\bf cryo}}}
\label{pgpmac_8h_ae78d9a757d4c85419fff9c94b15e25d7}


Move the cryostream towards or away from the crystal. 

Definition at line 95 of file lspmac.c.\hypertarget{pgpmac_8h_a9d9c5030d817483ca9518027c91adac4}{
\index{pgpmac.h@{pgpmac.h}!dryer@{dryer}}
\index{dryer@{dryer}!pgpmac.h@{pgpmac.h}}
\subsubsection[{dryer}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\_\-motor\_\-t}$\ast$ {\bf dryer}}}
\label{pgpmac_8h_a9d9c5030d817483ca9518027c91adac4}


blow air on the scintilator to dry it off 

Definition at line 96 of file lspmac.c.\hypertarget{pgpmac_8h_aeb09895663eff333b7a75acb319a9fc1}{
\index{pgpmac.h@{pgpmac.h}!flight@{flight}}
\index{flight@{flight}!pgpmac.h@{pgpmac.h}}
\subsubsection[{flight}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\_\-motor\_\-t}$\ast$ {\bf flight}}}
\label{pgpmac_8h_aeb09895663eff333b7a75acb319a9fc1}


Front Light DAC. 

Definition at line 90 of file lspmac.c.\hypertarget{pgpmac_8h_a8a3ca6fcf5e24dcc26170736843e53b2}{
\index{pgpmac.h@{pgpmac.h}!fscint@{fscint}}
\index{fscint@{fscint}!pgpmac.h@{pgpmac.h}}
\subsubsection[{fscint}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\_\-motor\_\-t}$\ast$ {\bf fscint}}}
\label{pgpmac_8h_a8a3ca6fcf5e24dcc26170736843e53b2}


Scintillator Piezo DAC. 

Definition at line 92 of file lspmac.c.\hypertarget{pgpmac_8h_a26dec4623af9beed912b8e7e6f99822c}{
\index{pgpmac.h@{pgpmac.h}!fshut@{fshut}}
\index{fshut@{fshut}!pgpmac.h@{pgpmac.h}}
\subsubsection[{fshut}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\_\-motor\_\-t}$\ast$ {\bf fshut}}}
\label{pgpmac_8h_a26dec4623af9beed912b8e7e6f99822c}


Fast shutter. 

Definition at line 89 of file lspmac.c.\hypertarget{pgpmac_8h_a0be79ccb7ebf3a665248fd856112b9fd}{
\index{pgpmac.h@{pgpmac.h}!kappa@{kappa}}
\index{kappa@{kappa}!pgpmac.h@{pgpmac.h}}
\subsubsection[{kappa}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\_\-motor\_\-t}$\ast$ {\bf kappa}}}
\label{pgpmac_8h_a0be79ccb7ebf3a665248fd856112b9fd}


Kappa. 

Definition at line 86 of file lspmac.c.\hypertarget{pgpmac_8h_a7ef8a09203117578c9b2ce4719519f36}{
\index{pgpmac.h@{pgpmac.h}!lspg\_\-getcenter@{lspg\_\-getcenter}}
\index{lspg\_\-getcenter@{lspg\_\-getcenter}!pgpmac.h@{pgpmac.h}}
\subsubsection[{lspg\_\-getcenter}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspg\_\-getcenter\_\-t} {\bf lspg\_\-getcenter}}}
\label{pgpmac_8h_a7ef8a09203117578c9b2ce4719519f36}


the getcenter object 

Definition at line 73 of file lspg.c.\hypertarget{pgpmac_8h_ad8d8e2f578ca79189a80c1fd5b60cefd}{
\index{pgpmac.h@{pgpmac.h}!lspg\_\-nextshot@{lspg\_\-nextshot}}
\index{lspg\_\-nextshot@{lspg\_\-nextshot}!pgpmac.h@{pgpmac.h}}
\subsubsection[{lspg\_\-nextshot}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspg\_\-nextshot\_\-t} {\bf lspg\_\-nextshot}}}
\label{pgpmac_8h_ad8d8e2f578ca79189a80c1fd5b60cefd}


the nextshot object 

Definition at line 72 of file lspg.c.\hypertarget{pgpmac_8h_aebfce5f9cbc8ba7bd4e2ee4880f303e8}{
\index{pgpmac.h@{pgpmac.h}!lspmac\_\-motors@{lspmac\_\-motors}}
\index{lspmac\_\-motors@{lspmac\_\-motors}!pgpmac.h@{pgpmac.h}}
\subsubsection[{lspmac\_\-motors}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\_\-motor\_\-t} {\bf lspmac\_\-motors}\mbox{[}$\,$\mbox{]}}}
\label{pgpmac_8h_aebfce5f9cbc8ba7bd4e2ee4880f303e8}


All our motors. 

Definition at line 71 of file lspmac.c.\hypertarget{pgpmac_8h_a57547d211906c981ef20257eba99f8df}{
\index{pgpmac.h@{pgpmac.h}!lspmac\_\-moving\_\-cond@{lspmac\_\-moving\_\-cond}}
\index{lspmac\_\-moving\_\-cond@{lspmac\_\-moving\_\-cond}!pgpmac.h@{pgpmac.h}}
\subsubsection[{lspmac\_\-moving\_\-cond}]{\setlength{\rightskip}{0pt plus 5cm}pthread\_\-cond\_\-t {\bf lspmac\_\-moving\_\-cond}}}
\label{pgpmac_8h_a57547d211906c981ef20257eba99f8df}


Wait for motor(s) to finish moving condition. 

Definition at line 59 of file lspmac.c.\hypertarget{pgpmac_8h_a7a32c617c183166308241e270959df56}{
\index{pgpmac.h@{pgpmac.h}!lspmac\_\-moving\_\-flags@{lspmac\_\-moving\_\-flags}}
\index{lspmac\_\-moving\_\-flags@{lspmac\_\-moving\_\-flags}!pgpmac.h@{pgpmac.h}}
\subsubsection[{lspmac\_\-moving\_\-flags}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf lspmac\_\-moving\_\-flags}}}
\label{pgpmac_8h_a7a32c617c183166308241e270959df56}


Flag used to implement motor moving condition. 

Definition at line 60 of file lspmac.c.\hypertarget{pgpmac_8h_a85679cac947e199c88794f8e5a12bf5f}{
\index{pgpmac.h@{pgpmac.h}!lspmac\_\-moving\_\-mutex@{lspmac\_\-moving\_\-mutex}}
\index{lspmac\_\-moving\_\-mutex@{lspmac\_\-moving\_\-mutex}!pgpmac.h@{pgpmac.h}}
\subsubsection[{lspmac\_\-moving\_\-mutex}]{\setlength{\rightskip}{0pt plus 5cm}pthread\_\-mutex\_\-t {\bf lspmac\_\-moving\_\-mutex}}}
\label{pgpmac_8h_a85679cac947e199c88794f8e5a12bf5f}


Coordinate moving motors between threads. 

Definition at line 58 of file lspmac.c.\hypertarget{pgpmac_8h_a56260f012c50a591ee7f97e500f16994}{
\index{pgpmac.h@{pgpmac.h}!lspmac\_\-nmotors@{lspmac\_\-nmotors}}
\index{lspmac\_\-nmotors@{lspmac\_\-nmotors}!pgpmac.h@{pgpmac.h}}
\subsubsection[{lspmac\_\-nmotors}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf lspmac\_\-nmotors}}}
\label{pgpmac_8h_a56260f012c50a591ee7f97e500f16994}


The number of motors we manage. 

Definition at line 72 of file lspmac.c.\hypertarget{pgpmac_8h_afbd51c2cefcee87afe994c9e9f372241}{
\index{pgpmac.h@{pgpmac.h}!lspmac\_\-shutter\_\-cond@{lspmac\_\-shutter\_\-cond}}
\index{lspmac\_\-shutter\_\-cond@{lspmac\_\-shutter\_\-cond}!pgpmac.h@{pgpmac.h}}
\subsubsection[{lspmac\_\-shutter\_\-cond}]{\setlength{\rightskip}{0pt plus 5cm}pthread\_\-cond\_\-t {\bf lspmac\_\-shutter\_\-cond}}}
\label{pgpmac_8h_afbd51c2cefcee87afe994c9e9f372241}


Allows waiting for the shutter status to change. 

Definition at line 57 of file lspmac.c.\hypertarget{pgpmac_8h_a396fbf06208de3ecbe1b0df549f1cd46}{
\index{pgpmac.h@{pgpmac.h}!lspmac\_\-shutter\_\-has\_\-opened@{lspmac\_\-shutter\_\-has\_\-opened}}
\index{lspmac\_\-shutter\_\-has\_\-opened@{lspmac\_\-shutter\_\-has\_\-opened}!pgpmac.h@{pgpmac.h}}
\subsubsection[{lspmac\_\-shutter\_\-has\_\-opened}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf lspmac\_\-shutter\_\-has\_\-opened}}}
\label{pgpmac_8h_a396fbf06208de3ecbe1b0df549f1cd46}


Indicates that the shutter had opened, perhaps briefly even if the state did not change. 

Definition at line 55 of file lspmac.c.\hypertarget{pgpmac_8h_a1b78a13c654409333569815e1c109d38}{
\index{pgpmac.h@{pgpmac.h}!lspmac\_\-shutter\_\-mutex@{lspmac\_\-shutter\_\-mutex}}
\index{lspmac\_\-shutter\_\-mutex@{lspmac\_\-shutter\_\-mutex}!pgpmac.h@{pgpmac.h}}
\subsubsection[{lspmac\_\-shutter\_\-mutex}]{\setlength{\rightskip}{0pt plus 5cm}pthread\_\-mutex\_\-t {\bf lspmac\_\-shutter\_\-mutex}}}
\label{pgpmac_8h_a1b78a13c654409333569815e1c109d38}


Coordinates threads reading shutter status. 

Definition at line 56 of file lspmac.c.\hypertarget{pgpmac_8h_a112158e0cd50449a440ac55c7af7bea2}{
\index{pgpmac.h@{pgpmac.h}!lspmac\_\-shutter\_\-state@{lspmac\_\-shutter\_\-state}}
\index{lspmac\_\-shutter\_\-state@{lspmac\_\-shutter\_\-state}!pgpmac.h@{pgpmac.h}}
\subsubsection[{lspmac\_\-shutter\_\-state}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf lspmac\_\-shutter\_\-state}}}
\label{pgpmac_8h_a112158e0cd50449a440ac55c7af7bea2}


State of the shutter, used to detect changes. 

Definition at line 54 of file lspmac.c.\hypertarget{pgpmac_8h_a7a3e763682bd7f987d07f149e94b3bf8}{
\index{pgpmac.h@{pgpmac.h}!md2\_\-status\_\-mutex@{md2\_\-status\_\-mutex}}
\index{md2\_\-status\_\-mutex@{md2\_\-status\_\-mutex}!pgpmac.h@{pgpmac.h}}
\subsubsection[{md2\_\-status\_\-mutex}]{\setlength{\rightskip}{0pt plus 5cm}pthread\_\-mutex\_\-t {\bf md2\_\-status\_\-mutex}}}
\label{pgpmac_8h_a7a3e763682bd7f987d07f149e94b3bf8}


Synchronize reading/writting status buffer. 

Definition at line 279 of file lspmac.c.\hypertarget{pgpmac_8h_a1ccf455563dc8d828558b6a230e164a6}{
\index{pgpmac.h@{pgpmac.h}!md2cmds\_\-cmd@{md2cmds\_\-cmd}}
\index{md2cmds\_\-cmd@{md2cmds\_\-cmd}!pgpmac.h@{pgpmac.h}}
\subsubsection[{md2cmds\_\-cmd}]{\setlength{\rightskip}{0pt plus 5cm}char {\bf md2cmds\_\-cmd}\mbox{[}$\,$\mbox{]}}}
\label{pgpmac_8h_a1ccf455563dc8d828558b6a230e164a6}


our command; 

Definition at line 16 of file md2cmds.c.\hypertarget{pgpmac_8h_a08d5b18ec9478d753c46a3e28d1f2126}{
\index{pgpmac.h@{pgpmac.h}!md2cmds\_\-cond@{md2cmds\_\-cond}}
\index{md2cmds\_\-cond@{md2cmds\_\-cond}!pgpmac.h@{pgpmac.h}}
\subsubsection[{md2cmds\_\-cond}]{\setlength{\rightskip}{0pt plus 5cm}pthread\_\-cond\_\-t {\bf md2cmds\_\-cond}}}
\label{pgpmac_8h_a08d5b18ec9478d753c46a3e28d1f2126}


condition to signal when it's time to run an md2 command 

Definition at line 10 of file md2cmds.c.\hypertarget{pgpmac_8h_ad67304bb851dc6268b0cda2f40fc5aa8}{
\index{pgpmac.h@{pgpmac.h}!md2cmds\_\-mutex@{md2cmds\_\-mutex}}
\index{md2cmds\_\-mutex@{md2cmds\_\-mutex}!pgpmac.h@{pgpmac.h}}
\subsubsection[{md2cmds\_\-mutex}]{\setlength{\rightskip}{0pt plus 5cm}pthread\_\-mutex\_\-t {\bf md2cmds\_\-mutex}}}
\label{pgpmac_8h_ad67304bb851dc6268b0cda2f40fc5aa8}


mutex for the condition 

Definition at line 11 of file md2cmds.c.\hypertarget{pgpmac_8h_ab517a930528e2b7d0993e11087765b03}{
\index{pgpmac.h@{pgpmac.h}!md2cmds\_\-pg\_\-cond@{md2cmds\_\-pg\_\-cond}}
\index{md2cmds\_\-pg\_\-cond@{md2cmds\_\-pg\_\-cond}!pgpmac.h@{pgpmac.h}}
\subsubsection[{md2cmds\_\-pg\_\-cond}]{\setlength{\rightskip}{0pt plus 5cm}pthread\_\-cond\_\-t {\bf md2cmds\_\-pg\_\-cond}}}
\label{pgpmac_8h_ab517a930528e2b7d0993e11087765b03}


coordinate call and response 

Definition at line 13 of file md2cmds.c.\hypertarget{pgpmac_8h_a4d2c3ac81d4b13eb21f4ddcdda8c7308}{
\index{pgpmac.h@{pgpmac.h}!md2cmds\_\-pg\_\-mutex@{md2cmds\_\-pg\_\-mutex}}
\index{md2cmds\_\-pg\_\-mutex@{md2cmds\_\-pg\_\-mutex}!pgpmac.h@{pgpmac.h}}
\subsubsection[{md2cmds\_\-pg\_\-mutex}]{\setlength{\rightskip}{0pt plus 5cm}pthread\_\-mutex\_\-t {\bf md2cmds\_\-pg\_\-mutex}}}
\label{pgpmac_8h_a4d2c3ac81d4b13eb21f4ddcdda8c7308}


message passing between md2cmds and pg 

Definition at line 14 of file md2cmds.c.\hypertarget{pgpmac_8h_ad128c64890c7c0d4f836d9ec6e99216a}{
\index{pgpmac.h@{pgpmac.h}!ncurses\_\-mutex@{ncurses\_\-mutex}}
\index{ncurses\_\-mutex@{ncurses\_\-mutex}!pgpmac.h@{pgpmac.h}}
\subsubsection[{ncurses\_\-mutex}]{\setlength{\rightskip}{0pt plus 5cm}pthread\_\-mutex\_\-t {\bf ncurses\_\-mutex}}}
\label{pgpmac_8h_ad128c64890c7c0d4f836d9ec6e99216a}


allow more than one thread access to the screen 

Definition at line 233 of file pgpmac.c.\hypertarget{pgpmac_8h_a8237e646ce032a840637a4ef7bff49b9}{
\index{pgpmac.h@{pgpmac.h}!omega@{omega}}
\index{omega@{omega}!pgpmac.h@{pgpmac.h}}
\subsubsection[{omega}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\_\-motor\_\-t}$\ast$ {\bf omega}}}
\label{pgpmac_8h_a8237e646ce032a840637a4ef7bff49b9}


MD2 omega axis (the air bearing). 

Definition at line 73 of file lspmac.c.\hypertarget{pgpmac_8h_ac8070dc568ad974a3db42b51eca828cc}{
\index{pgpmac.h@{pgpmac.h}!phi@{phi}}
\index{phi@{phi}!pgpmac.h@{pgpmac.h}}
\subsubsection[{phi}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\_\-motor\_\-t}$\ast$ {\bf phi}}}
\label{pgpmac_8h_ac8070dc568ad974a3db42b51eca828cc}


Phi (not data collection axis). 

Definition at line 87 of file lspmac.c.\hypertarget{pgpmac_8h_ac0eeaffa0996271d8a38344a470d13d7}{
\index{pgpmac.h@{pgpmac.h}!scinz@{scinz}}
\index{scinz@{scinz}!pgpmac.h@{pgpmac.h}}
\subsubsection[{scinz}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\_\-motor\_\-t}$\ast$ {\bf scinz}}}
\label{pgpmac_8h_ac0eeaffa0996271d8a38344a470d13d7}


Scintillator Z. 

Definition at line 83 of file lspmac.c.\hypertarget{pgpmac_8h_ab0487111dbe3c05d0bd835eb2fb9a3f7}{
\index{pgpmac.h@{pgpmac.h}!term\_\-input@{term\_\-input}}
\index{term\_\-input@{term\_\-input}!pgpmac.h@{pgpmac.h}}
\subsubsection[{term\_\-input}]{\setlength{\rightskip}{0pt plus 5cm}WINDOW$\ast$ {\bf term\_\-input}}}
\label{pgpmac_8h_ab0487111dbe3c05d0bd835eb2fb9a3f7}


place to put the cursor 

Definition at line 229 of file pgpmac.c.\hypertarget{pgpmac_8h_a65daf0f4a5bc6def23a9df98ff5ca57e}{
\index{pgpmac.h@{pgpmac.h}!term\_\-output@{term\_\-output}}
\index{term\_\-output@{term\_\-output}!pgpmac.h@{pgpmac.h}}
\subsubsection[{term\_\-output}]{\setlength{\rightskip}{0pt plus 5cm}WINDOW$\ast$ {\bf term\_\-output}}}
\label{pgpmac_8h_a65daf0f4a5bc6def23a9df98ff5ca57e}


place to print stuff out 

Definition at line 228 of file pgpmac.c.\hypertarget{pgpmac_8h_ae746a6903fb8a4ea216def88eccedc3c}{
\index{pgpmac.h@{pgpmac.h}!term\_\-status@{term\_\-status}}
\index{term\_\-status@{term\_\-status}!pgpmac.h@{pgpmac.h}}
\subsubsection[{term\_\-status}]{\setlength{\rightskip}{0pt plus 5cm}WINDOW$\ast$ {\bf term\_\-status}}}
\label{pgpmac_8h_ae746a6903fb8a4ea216def88eccedc3c}


shutter, lamp, air, etc status 

Definition at line 230 of file pgpmac.c.\hypertarget{pgpmac_8h_ae2d7da3afeb756716e6e4ee9cab78f8a}{
\index{pgpmac.h@{pgpmac.h}!term\_\-status2@{term\_\-status2}}
\index{term\_\-status2@{term\_\-status2}!pgpmac.h@{pgpmac.h}}
\subsubsection[{term\_\-status2}]{\setlength{\rightskip}{0pt plus 5cm}WINDOW$\ast$ {\bf term\_\-status2}}}
\label{pgpmac_8h_ae2d7da3afeb756716e6e4ee9cab78f8a}


shutter, lamp, air, etc status 

Definition at line 231 of file pgpmac.c.\hypertarget{pgpmac_8h_ad53a42cfaa04eff0336a44c8c9986333}{
\index{pgpmac.h@{pgpmac.h}!zoom@{zoom}}
\index{zoom@{zoom}!pgpmac.h@{pgpmac.h}}
\subsubsection[{zoom}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\_\-motor\_\-t}$\ast$ {\bf zoom}}}
\label{pgpmac_8h_ad53a42cfaa04eff0336a44c8c9986333}


Optical zoom. 

Definition at line 78 of file lspmac.c.