\hypertarget{pgpmac_8h}{\section{pgpmac.\-h File Reference}
\label{pgpmac_8h}\index{pgpmac.\-h@{pgpmac.\-h}}
}


Headers for the entire pgpmac project.  


{\ttfamily \#include $<$stdint.\-h$>$}\\*
{\ttfamily \#include $<$stdio.\-h$>$}\\*
{\ttfamily \#include $<$stdlib.\-h$>$}\\*
{\ttfamily \#include $<$unistd.\-h$>$}\\*
{\ttfamily \#include $<$sys/types.\-h$>$}\\*
{\ttfamily \#include $<$sys/socket.\-h$>$}\\*
{\ttfamily \#include $<$netdb.\-h$>$}\\*
{\ttfamily \#include $<$string.\-h$>$}\\*
{\ttfamily \#include $<$netinet/in.\-h$>$}\\*
{\ttfamily \#include $<$errno.\-h$>$}\\*
{\ttfamily \#include $<$poll.\-h$>$}\\*
{\ttfamily \#include $<$libpq-\/fe.\-h$>$}\\*
{\ttfamily \#include $<$ncurses.\-h$>$}\\*
{\ttfamily \#include $<$math.\-h$>$}\\*
{\ttfamily \#include $<$pthread.\-h$>$}\\*
{\ttfamily \#include $<$signal.\-h$>$}\\*
{\ttfamily \#include $<$sys/signalfd.\-h$>$}\\*
{\ttfamily \#include $<$sys/time.\-h$>$}\\*
{\ttfamily \#include $<$time.\-h$>$}\\*
{\ttfamily \#include $<$getopt.\-h$>$}\\*
{\ttfamily \#include $<$regex.\-h$>$}\\*
{\ttfamily \#include $<$hiredis/hiredis.\-h$>$}\\*
{\ttfamily \#include $<$hiredis/async.\-h$>$}\\*
{\ttfamily \#include $<$search.\-h$>$}\\*
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structlsredis__obj__struct}{lsredis\-\_\-obj\-\_\-struct}
\begin{DoxyCompactList}\small\item\em Redis Object Basic object whose value is sychronized with our redis db. \end{DoxyCompactList}\item 
struct \hyperlink{structtagEthernetCmd}{tag\-Ethernet\-Cmd}
\begin{DoxyCompactList}\small\item\em P\-M\-A\-C ethernet packet definition. \end{DoxyCompactList}\item 
struct \hyperlink{structlspmac__cmd__queue__struct}{lspmac\-\_\-cmd\-\_\-queue\-\_\-struct}
\begin{DoxyCompactList}\small\item\em P\-M\-A\-C command queue item. \end{DoxyCompactList}\item 
struct \hyperlink{structlspmac__motor__struct}{lspmac\-\_\-motor\-\_\-struct}
\begin{DoxyCompactList}\small\item\em Motor information. \end{DoxyCompactList}\item 
struct \hyperlink{structlspmac__bi__struct}{lspmac\-\_\-bi\-\_\-struct}
\begin{DoxyCompactList}\small\item\em Storage for binary inputs. \end{DoxyCompactList}\item 
struct \hyperlink{structlspgQueryQueueStruct}{lspg\-Query\-Queue\-Struct}
\begin{DoxyCompactList}\small\item\em Store each query along with it's callback function. \end{DoxyCompactList}\item 
struct \hyperlink{structlspg__waitcryo__struct}{lspg\-\_\-waitcryo\-\_\-struct}
\item 
struct \hyperlink{structlspg__getcurrentsampleid__struct}{lspg\-\_\-getcurrentsampleid\-\_\-struct}
\item 
struct \hyperlink{structlspg__demandairrights__struct}{lspg\-\_\-demandairrights\-\_\-struct}
\item 
struct \hyperlink{structlspg__getcenter__struct}{lspg\-\_\-getcenter\-\_\-struct}
\begin{DoxyCompactList}\small\item\em Storage for getcenter query Used for the md2 R\-O\-T\-A\-T\-E command that generates the centering movies. \end{DoxyCompactList}\item 
struct \hyperlink{structlspg__starttransfer__struct}{lspg\-\_\-starttransfer\-\_\-struct}
\begin{DoxyCompactList}\small\item\em returns 1 if transfer can continue 0 to abort \end{DoxyCompactList}\item 
struct \hyperlink{structlspg__nextsample__struct}{lspg\-\_\-nextsample\-\_\-struct}
\begin{DoxyCompactList}\small\item\em Returns the next sample number Just a 32 bit int (Ha!, take that, nextshot!) \end{DoxyCompactList}\item 
struct \hyperlink{structlspg__nextshot__struct}{lspg\-\_\-nextshot\-\_\-struct}
\begin{DoxyCompactList}\small\item\em Storage definition for nextshot query. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{pgpmac_8h_a369266c24eacffb87046522897a570d5}{\-\_\-\-G\-N\-U\-\_\-\-S\-O\-U\-R\-C\-E}
\item 
\#define \hyperlink{pgpmac_8h_a3bae94e8e4e4347dd5f87b6bda058de6}{L\-S\-\_\-\-D\-I\-S\-P\-L\-A\-Y\-\_\-\-W\-I\-N\-D\-O\-W\-\_\-\-H\-E\-I\-G\-H\-T}~8
\begin{DoxyCompactList}\small\item\em Number of status box rows. \end{DoxyCompactList}\item 
\#define \hyperlink{pgpmac_8h_a1f96754f00a1f82414cebc66f75ded78}{L\-S\-\_\-\-D\-I\-S\-P\-L\-A\-Y\-\_\-\-W\-I\-N\-D\-O\-W\-\_\-\-W\-I\-D\-T\-H}~24
\begin{DoxyCompactList}\small\item\em Number of status box columns. \end{DoxyCompactList}\item 
\#define \hyperlink{pgpmac_8h_a3a8ef1b4b5994d6dd12bf74454ea891b}{L\-S\-\_\-\-P\-G\-\_\-\-Q\-U\-E\-R\-Y\-\_\-\-S\-T\-R\-I\-N\-G\-\_\-\-L\-E\-N\-G\-T\-H}~1024
\begin{DoxyCompactList}\small\item\em Fixed length postgresql query strings. Queries should all be function calls so this is not as weird as one might think. \end{DoxyCompactList}\item 
\#define \hyperlink{pgpmac_8h_ab61d790b5572f116e091babfda53627b}{L\-S\-E\-V\-E\-N\-T\-S\-\_\-\-E\-V\-E\-N\-T\-\_\-\-L\-E\-N\-G\-T\-H}~256
\begin{DoxyCompactList}\small\item\em Fixed length for event names\-: simplifies string handling. \end{DoxyCompactList}\item 
\#define \hyperlink{pgpmac_8h_a30f0f377b0f0695284145d420ea51846}{M\-D2\-C\-M\-D\-S\-\_\-\-C\-M\-D\-\_\-\-L\-E\-N\-G\-T\-H}~32
\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \hyperlink{structlsredis__obj__struct}{lsredis\-\_\-obj\-\_\-struct} \hyperlink{pgpmac_8h_ad449de06d02791adf2498d2a1e1f909c}{lsredis\-\_\-obj\-\_\-t}
\begin{DoxyCompactList}\small\item\em Redis Object Basic object whose value is sychronized with our redis db. \end{DoxyCompactList}\item 
typedef struct \hyperlink{structtagEthernetCmd}{tag\-Ethernet\-Cmd} \hyperlink{pgpmac_8h_a2d163436571135a457f4a4e2fbd09633}{pmac\-\_\-cmd\-\_\-t}
\begin{DoxyCompactList}\small\item\em P\-M\-A\-C ethernet packet definition. \end{DoxyCompactList}\item 
typedef struct \\*
\hyperlink{structlspmac__cmd__queue__struct}{lspmac\-\_\-cmd\-\_\-queue\-\_\-struct} \hyperlink{pgpmac_8h_a99c275e32ad897dca34d196b91f038cb}{pmac\-\_\-cmd\-\_\-queue\-\_\-t}
\begin{DoxyCompactList}\small\item\em P\-M\-A\-C command queue item. \end{DoxyCompactList}\item 
typedef struct \hyperlink{structlspmac__motor__struct}{lspmac\-\_\-motor\-\_\-struct} \hyperlink{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}{lspmac\-\_\-motor\-\_\-t}
\begin{DoxyCompactList}\small\item\em Motor information. \end{DoxyCompactList}\item 
typedef struct \hyperlink{structlspmac__bi__struct}{lspmac\-\_\-bi\-\_\-struct} \hyperlink{pgpmac_8h_ac48984832ef73cf145e5f08bc65bd3a0}{lspmac\-\_\-bi\-\_\-t}
\begin{DoxyCompactList}\small\item\em Storage for binary inputs. \end{DoxyCompactList}\item 
typedef struct \hyperlink{structlspgQueryQueueStruct}{lspg\-Query\-Queue\-Struct} \hyperlink{pgpmac_8h_ae57432c0a6ac48a50457815dab2c5b4c}{lspg\-\_\-query\-\_\-queue\-\_\-t}
\begin{DoxyCompactList}\small\item\em Store each query along with it's callback function. \end{DoxyCompactList}\item 
typedef struct \hyperlink{structlspg__waitcryo__struct}{lspg\-\_\-waitcryo\-\_\-struct} \hyperlink{pgpmac_8h_a779e2acce8b5e748c184caf23ed0db57}{lspg\-\_\-waitcryo\-\_\-t}
\item 
typedef struct \\*
\hyperlink{structlspg__getcurrentsampleid__struct}{lspg\-\_\-getcurrentsampleid\-\_\-struct} \hyperlink{pgpmac_8h_a7a794370785ff015d5ee035917e3bee8}{lspg\-\_\-getcurrentsampleid\-\_\-t}
\item 
typedef struct \\*
\hyperlink{structlspg__demandairrights__struct}{lspg\-\_\-demandairrights\-\_\-struct} \hyperlink{pgpmac_8h_a7f71abc6fdfd1839e2e3213d78aaf766}{lspg\-\_\-demandairrights\-\_\-t}
\item 
typedef struct \\*
\hyperlink{structlspg__getcenter__struct}{lspg\-\_\-getcenter\-\_\-struct} \hyperlink{pgpmac_8h_a48b627e412dd038c1f17cdb0501eec33}{lspg\-\_\-getcenter\-\_\-t}
\begin{DoxyCompactList}\small\item\em Storage for getcenter query Used for the md2 R\-O\-T\-A\-T\-E command that generates the centering movies. \end{DoxyCompactList}\item 
typedef struct \\*
\hyperlink{structlspg__starttransfer__struct}{lspg\-\_\-starttransfer\-\_\-struct} \hyperlink{pgpmac_8h_aa1f0e602ae9509005c62fb2d73bc1c5a}{lspg\-\_\-starttransfer\-\_\-t}
\begin{DoxyCompactList}\small\item\em returns 1 if transfer can continue 0 to abort \end{DoxyCompactList}\item 
typedef struct \\*
\hyperlink{structlspg__nextsample__struct}{lspg\-\_\-nextsample\-\_\-struct} \hyperlink{pgpmac_8h_a9dda9014cd0e39fba8d523e37cf9f982}{lspg\-\_\-nextsample\-\_\-t}
\begin{DoxyCompactList}\small\item\em Returns the next sample number Just a 32 bit int (Ha!, take that, nextshot!) \end{DoxyCompactList}\item 
typedef struct \hyperlink{structlspg__nextshot__struct}{lspg\-\_\-nextshot\-\_\-struct} \hyperlink{pgpmac_8h_a17ea2bf07a0b3b892baa00bd392607b3}{lspg\-\_\-nextshot\-\_\-t}
\begin{DoxyCompactList}\small\item\em Storage definition for nextshot query. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
double \hyperlink{pgpmac_8h_a6a1b639686b771c1213b6e23716a7898}{lspmac\-\_\-get\-Position} (\hyperlink{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}{lspmac\-\_\-motor\-\_\-t} $\ast$)
\begin{DoxyCompactList}\small\item\em get the motor position (with locking) \end{DoxyCompactList}\item 
char $\ast$$\ast$ \hyperlink{pgpmac_8h_a4ee000bfeef9380d479464a9500af311}{lspg\-\_\-array2ptrs} (char $\ast$)
\begin{DoxyCompactList}\small\item\em returns a null terminated list of strings parsed from postgresql array \end{DoxyCompactList}\item 
char $\ast$$\ast$ \hyperlink{pgpmac_8h_abe31d0e11c41b2235307612c963bb652}{lsredis\-\_\-get\-\_\-string\-\_\-array} (\hyperlink{pgpmac_8h_ad449de06d02791adf2498d2a1e1f909c}{lsredis\-\_\-obj\-\_\-t} $\ast$p)
\item 
void \hyperlink{pgpmac_8h_a49a53bb92535ca2b62208dce41760fbb}{lspmac\-\_\-\-Sock\-Send\-D\-Pline} (char $\ast$, char $\ast$fmt,...)
\begin{DoxyCompactList}\small\item\em prepare (queue up) a line to send the dpram ascii command interface \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_a99c275e32ad897dca34d196b91f038cb}{pmac\-\_\-cmd\-\_\-queue\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_a79f86193e36c823157049061b94627a7}{lspmac\-\_\-\-Sock\-Sendline} (char $\ast$, char $\ast$,...)
\begin{DoxyCompactList}\small\item\em Send a one line command. \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_ad449de06d02791adf2498d2a1e1f909c}{lsredis\-\_\-obj\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_a6d9f550b9ba36acd237925164abe3ffc}{lsredis\-\_\-get\-\_\-obj} (char $\ast$,...)
\item 
char $\ast$ \hyperlink{pgpmac_8h_ac1994e56114b2315294527d76311f829}{lsredis\-\_\-getstr} (\hyperlink{pgpmac_8h_ad449de06d02791adf2498d2a1e1f909c}{lsredis\-\_\-obj\-\_\-t} $\ast$p)
\begin{DoxyCompactList}\small\item\em return a copy of the key's string value \end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_a76b11c62b122ee0fd8399435d4260681}{Pmac\-Sock\-Sendline} (char $\ast$s)
\item 
unsigned int \hyperlink{pgpmac_8h_a4cc866393eda0cf20276d035f6fbe206}{lspg\-\_\-nextsample\-\_\-all} (int $\ast$err)
\item 
long int \hyperlink{pgpmac_8h_a1923f998441f4f451204dfd214d52218}{lsredis\-\_\-getl} (\hyperlink{pgpmac_8h_ad449de06d02791adf2498d2a1e1f909c}{lsredis\-\_\-obj\-\_\-t} $\ast$p)
\item 
void \hyperlink{pgpmac_8h_aac89b916c1152c44042875feac35a9e4}{lsevents\-\_\-add\-\_\-listener} (char $\ast$, void($\ast$cb)(char $\ast$))
\begin{DoxyCompactList}\small\item\em Add a callback routine to listen for a specific event. \end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_af19a77187e7406fc87d36bd26e672e6d}{lsevents\-\_\-init} ()
\begin{DoxyCompactList}\small\item\em Initialize this module. \end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_a024b08c7820bb31c3d5b8f281e07f3e8}{lsevents\-\_\-remove\-\_\-listener} (char $\ast$, void($\ast$cb)(char $\ast$))
\begin{DoxyCompactList}\small\item\em Remove a listener previously added with lsevents\-\_\-add\-\_\-listener. \end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_a4ddde538b603e3d4580ae9356bf9b89d}{lsevents\-\_\-run} ()
\begin{DoxyCompactList}\small\item\em Start up the thread and get out of the way. \end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_a3661dfc51537c05b11f4fd184fdff07d}{lsevents\-\_\-send\-\_\-event} (char $\ast$,...)
\begin{DoxyCompactList}\small\item\em Call the callback routines for the given event. \end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_a3418b9ab57811d28632794236e056408}{lslogging\-\_\-init} ()
\begin{DoxyCompactList}\small\item\em Initialize the lslogging objects. \end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_a0e756b36671055ef02a8f04d2ba8a93b}{lslogging\-\_\-log\-\_\-message} (char $\ast$fmt,...)
\begin{DoxyCompactList}\small\item\em The routine everyone will be talking about. \end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_ad9f65252584e65957f461b809d59e3a2}{lslogging\-\_\-run} ()
\begin{DoxyCompactList}\small\item\em Start up the worker thread. \end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_aaf0ad72847ccb93694b3bdc649e6d1fc}{lspg\-\_\-demandairrights\-\_\-all} ()
\begin{DoxyCompactList}\small\item\em do nothing until we get airrights \end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_a6f7cd0a06f6a266ef65b3604cf33d6c4}{lspg\-\_\-getcenter\-\_\-call} ()
\begin{DoxyCompactList}\small\item\em Request a getcenter query. \end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_a7c678553b44c874d08ec9966ed7bb1c0}{lspg\-\_\-getcenter\-\_\-done} ()
\begin{DoxyCompactList}\small\item\em Done with getcenter query. \end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_a3e0e4b3cb9fa03961ee0c104e0b06754}{lspg\-\_\-getcenter\-\_\-wait} ()
\begin{DoxyCompactList}\small\item\em Wait for a getcenter query to return. \end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_a2d624b228ddd560ace0cef4286a30b07}{lspg\-\_\-getcurrentsampleid\-\_\-wait\-\_\-for\-\_\-id} (unsigned int test)
\item 
void \hyperlink{pgpmac_8h_a8a77972df14166e05c94ed0792baa09b}{lspg\-\_\-init} ()
\begin{DoxyCompactList}\small\item\em Initiallize the lspg module. \end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_af17ef79544ca5d78fd477010fe90d538}{lspg\-\_\-nextshot\-\_\-call} ()
\begin{DoxyCompactList}\small\item\em Queue up a nextshot query. \end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_a50458a014041a4118452802dfb303960}{lspg\-\_\-nextshot\-\_\-done} ()
\begin{DoxyCompactList}\small\item\em Called when the next shot query has been processed. \end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_a784a6de32a86fec9efb3ef3ae4b6e3ac}{lspg\-\_\-nextshot\-\_\-wait} ()
\begin{DoxyCompactList}\small\item\em Wait for the next shot query to get processed. \end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_a0bb9ef42da8fa21c4df48ec384ab69f4}{lspg\-\_\-query\-\_\-push} (void($\ast$cb)(\hyperlink{kvredis_8c_ae57432c0a6ac48a50457815dab2c5b4c}{lspg\-\_\-query\-\_\-queue\-\_\-t} $\ast$, P\-Gresult $\ast$), char $\ast$fmt,...)
\begin{DoxyCompactList}\small\item\em Place a query on the queue. \end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_a1adfdb5ca9fdb5060849d726bf540117}{lspg\-\_\-run} ()
\begin{DoxyCompactList}\small\item\em Start 'er runnin'. \end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_a4253474d4dd305aec0afdd5552b3ddd5}{lspg\-\_\-seq\-\_\-run\-\_\-prep\-\_\-all} (long long skey, double \hyperlink{pgpmac_8h_a0be79ccb7ebf3a665248fd856112b9fd}{kappa}, double \hyperlink{pgpmac_8h_ac8070dc568ad974a3db42b51eca828cc}{phi}, double cx, double cy, double ax, double ay, double az)
\begin{DoxyCompactList}\small\item\em Convinence function to call seq run prep. \end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_af72c4b037347737df09348ab703f6802}{lspg\-\_\-starttransfer\-\_\-call} (unsigned int nextsample, int \hyperlink{pgpmac_8h_ac59ab990e48033a811aeb0281fb588fc}{sample\-\_\-detected}, double ax, double ay, double az, double horz, double vert, double esttime)
\item 
void \hyperlink{pgpmac_8h_ad989179281d8b65b940250a4580007d0}{lspg\-\_\-starttransfer\-\_\-done} ()
\item 
void \hyperlink{pgpmac_8h_a189e9fd5cbc06dd09e5549f6e229fa5e}{lspg\-\_\-starttransfer\-\_\-wait} ()
\item 
void \hyperlink{pgpmac_8h_a67a44f70405c8b6a01cec6ac3d166efb}{lspg\-\_\-waitcryo\-\_\-all} ()
\begin{DoxyCompactList}\small\item\em no need to get fancy with the wait cryo command It should not return until the robot is almost ready for air rights \end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_a7497a7c924b31c727ea487a3efb77fb6}{lspg\-\_\-waitcryo\-\_\-cb} (\hyperlink{kvredis_8c_ae57432c0a6ac48a50457815dab2c5b4c}{lspg\-\_\-query\-\_\-queue\-\_\-t} $\ast$qqp, P\-Gresult $\ast$pgr)
\item 
void \hyperlink{pgpmac_8h_a95e3fd7c1685d7e6ab6d0a295ab42f78}{lspg\-\_\-zoom\-\_\-lut\-\_\-call} ()
\item 
int \hyperlink{pgpmac_8h_ac4bf3a54deeaeb6e93dc3183388ad104}{lspmac\-\_\-get\-B\-I\-Position} (\hyperlink{pgpmac_8h_ac48984832ef73cf145e5f08bc65bd3a0}{lspmac\-\_\-bi\-\_\-t} $\ast$)
\begin{DoxyCompactList}\small\item\em get binary input value \end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_a9fbadf816a842c8f131cf8ee47b54e29}{lspmac\-\_\-home1\-\_\-queue} (\hyperlink{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}{lspmac\-\_\-motor\-\_\-t} $\ast$mp)
\begin{DoxyCompactList}\small\item\em Home the motor. \end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_ae3e30b0ba9b5d5a291fa29b77ba920d8}{lspmac\-\_\-init} (int, int)
\begin{DoxyCompactList}\small\item\em Initialize this module. \end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_a62273d5e9fd9a14838f4126fb94a5138}{lspmac\-\_\-jogabs\-\_\-queue} (\hyperlink{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}{lspmac\-\_\-motor\-\_\-t} $\ast$, double)
\begin{DoxyCompactList}\small\item\em Use jog to move motor to requested position. \end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_a71a8e9cb210ac33874abe4e15149b964}{lspmac\-\_\-move\-\_\-or\-\_\-jog\-\_\-abs\-\_\-queue} (\hyperlink{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}{lspmac\-\_\-motor\-\_\-t} $\ast$mp, double requested\-\_\-position, int use\-\_\-jo)
\begin{DoxyCompactList}\small\item\em Move method for normal stepper and servo motor objects. \end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_adeec17e53dfc490f2a954b97fe95f0a7}{lspmac\-\_\-move\-\_\-or\-\_\-jog\-\_\-preset\-\_\-queue} (\hyperlink{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}{lspmac\-\_\-motor\-\_\-t} $\ast$, char $\ast$, int)
\begin{DoxyCompactList}\small\item\em move using a preset value \end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_a6809c317931c4af226e0a0217764afae}{lspmac\-\_\-move\-\_\-or\-\_\-jog\-\_\-queue} (\hyperlink{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}{lspmac\-\_\-motor\-\_\-t} $\ast$, double, int)
\item 
void \hyperlink{pgpmac_8h_a6f5751d89f83b4b436c6f8bc636e4156}{lspmac\-\_\-move\-\_\-preset\-\_\-queue} (\hyperlink{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}{lspmac\-\_\-motor\-\_\-t} $\ast$mp, char $\ast$preset\-\_\-name)
\begin{DoxyCompactList}\small\item\em Move a given motor to one of its preset positions. \end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_af9edebb71a4ebca5dad3df63164e2004}{lspmac\-\_\-moveabs\-\_\-queue} (\hyperlink{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}{lspmac\-\_\-motor\-\_\-t} $\ast$, double)
\begin{DoxyCompactList}\small\item\em Use coordinate system motion program, if available, to move motor to requested position. \end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_aae2282edace621ee65c682d03b7ccc36}{lspmac\-\_\-moveabs\-\_\-wait} (\hyperlink{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}{lspmac\-\_\-motor\-\_\-t} $\ast$mp)
\begin{DoxyCompactList}\small\item\em Wait for motor to finish moving. \end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_a3a7fb93fb3fb9c4454613f30bfb0b1ee}{lspmac\-\_\-run} ()
\begin{DoxyCompactList}\small\item\em Start up the lspmac thread. \end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_aa8bf745a9ec388783009e2275a8b56f8}{lspmac\-\_\-video\-\_\-rotate} (double secs)
\begin{DoxyCompactList}\small\item\em Special motion program to collect centering video. \end{DoxyCompactList}\item 
int \hyperlink{pgpmac_8h_ac356cd43e46799929242dcf5214df7f6}{lsredis\-\_\-cmpnstr} (\hyperlink{pgpmac_8h_ad449de06d02791adf2498d2a1e1f909c}{lsredis\-\_\-obj\-\_\-t} $\ast$p, char $\ast$s, int n)
\item 
int \hyperlink{pgpmac_8h_a9fc8fd0db4c71c5eae68682b43103078}{lsredis\-\_\-cmpstr} (\hyperlink{pgpmac_8h_ad449de06d02791adf2498d2a1e1f909c}{lsredis\-\_\-obj\-\_\-t} $\ast$p, char $\ast$s)
\item 
int \hyperlink{pgpmac_8h_a1ad60526a09ca679f39174ce5d773abe}{lsredis\-\_\-find\-\_\-preset} (char $\ast$base, char $\ast$preset\-\_\-name, double $\ast$dval)
\item 
int \hyperlink{pgpmac_8h_abbb4e5ece19ebd130e1be18036752a08}{lsredis\-\_\-getb} (\hyperlink{pgpmac_8h_ad449de06d02791adf2498d2a1e1f909c}{lsredis\-\_\-obj\-\_\-t} $\ast$p)
\item 
double \hyperlink{pgpmac_8h_aa8daf63b794b6b6341018feec205cb7d}{lsredis\-\_\-getd} (\hyperlink{pgpmac_8h_ad449de06d02791adf2498d2a1e1f909c}{lsredis\-\_\-obj\-\_\-t} $\ast$p)
\item 
void \hyperlink{pgpmac_8h_aef0f12fda57e476a50b14acdc9f30b58}{lsredis\-\_\-init} (char $\ast$pub, char $\ast$re, char $\ast$head)
\begin{DoxyCompactList}\small\item\em Initialize this module, that is, set up the connections. \end{DoxyCompactList}\item 
int \hyperlink{pgpmac_8h_ac58fca47533e695c8775e0d2b9128766}{lsredis\-\_\-regexec} (const regex\-\_\-t $\ast$preg, \hyperlink{pgpmac_8h_ad449de06d02791adf2498d2a1e1f909c}{lsredis\-\_\-obj\-\_\-t} $\ast$p, size\-\_\-t nmatch, regmatch\-\_\-t $\ast$pmatch, int eflags)
\item 
void \hyperlink{pgpmac_8h_ad438e4368d86bbe15a93dcf86deaded5}{lsredis\-\_\-run} ()
\item 
void \hyperlink{pgpmac_8h_a9b9c64f883c7ded60badfe89cb15fa78}{lsredis\-\_\-setstr} (\hyperlink{pgpmac_8h_ad449de06d02791adf2498d2a1e1f909c}{lsredis\-\_\-obj\-\_\-t} $\ast$p, char $\ast$fmt,...)
\begin{DoxyCompactList}\small\item\em Set the value and update redis. \end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_af712dd2e9419026eff2762ba062eeaf1}{lstimer\-\_\-add\-\_\-timer} (char $\ast$, int, unsigned long int, unsigned long int)
\begin{DoxyCompactList}\small\item\em Create a timer. \end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_a8cd37a8fb0f061456456a5d79bdd5189}{lstimer\-\_\-init} ()
\begin{DoxyCompactList}\small\item\em Initialize the timer list and pthread stuff. \end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_a0b918acc1a4bf737cb62b5a70f8b553a}{lstimer\-\_\-run} ()
\begin{DoxyCompactList}\small\item\em Start up our thread. \end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_adf63440ffbc65024fef87ea6a11ea8b0}{lsupdate\-\_\-init} ()
\item 
void \hyperlink{pgpmac_8h_af219e9b2cc124f109aa4c2c2e16b5d07}{lsupdate\-\_\-run} ()
\item 
void \hyperlink{pgpmac_8h_a0851b1baecda6a67993efde41d77b1c1}{md2cmds\-\_\-init} ()
\begin{DoxyCompactList}\small\item\em Initialize the md2cmds module. \end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_aa62da7d423952334d41c7d282f45233d}{md2cmds\-\_\-run} ()
\begin{DoxyCompactList}\small\item\em Start up the thread. \end{DoxyCompactList}\item 
void \hyperlink{pgpmac_8h_a7762ca7b97b44b979e23ce88ca3b4249}{pgpmac\-\_\-printf} (char $\ast$fmt,...)
\begin{DoxyCompactList}\small\item\em Terminal output routine ala printf. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hyperlink{pgpmac_8h_a779e2acce8b5e748c184caf23ed0db57}{lspg\-\_\-waitcryo\-\_\-t} \hyperlink{pgpmac_8h_a5f699604dcc5d3d64fd6cb5c363d29c9}{lspg\-\_\-waitcryo}
\begin{DoxyCompactList}\small\item\em signal the robot \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_a7a794370785ff015d5ee035917e3bee8}{lspg\-\_\-getcurrentsampleid\-\_\-t} \hyperlink{pgpmac_8h_a5c50804e6019d47d91f3f1cb3ebd1f00}{lspg\-\_\-getcurrentsampleid}
\begin{DoxyCompactList}\small\item\em our currentsample id \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_a7f71abc6fdfd1839e2e3213d78aaf766}{lspg\-\_\-demandairrights\-\_\-t} \hyperlink{pgpmac_8h_adf89a0299edd6a99992b95dff8992eba}{lspg\-\_\-demandairrights}
\begin{DoxyCompactList}\small\item\em our demandairrights object \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_a48b627e412dd038c1f17cdb0501eec33}{lspg\-\_\-getcenter\-\_\-t} \hyperlink{pgpmac_8h_a7ef8a09203117578c9b2ce4719519f36}{lspg\-\_\-getcenter}
\begin{DoxyCompactList}\small\item\em the getcenter object \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_aa1f0e602ae9509005c62fb2d73bc1c5a}{lspg\-\_\-starttransfer\-\_\-t} \hyperlink{pgpmac_8h_af18499d17171eff473cfc49d4a0a5562}{lspg\-\_\-starttransfer}
\begin{DoxyCompactList}\small\item\em start a sample transfer \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_a9dda9014cd0e39fba8d523e37cf9f982}{lspg\-\_\-nextsample\-\_\-t} \hyperlink{pgpmac_8h_adbf70f382e469e02dce77833981f9547}{lspg\-\_\-nextsample}
\begin{DoxyCompactList}\small\item\em the very next sample \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_a17ea2bf07a0b3b892baa00bd392607b3}{lspg\-\_\-nextshot\-\_\-t} \hyperlink{pgpmac_8h_ad8d8e2f578ca79189a80c1fd5b60cefd}{lspg\-\_\-nextshot}
\begin{DoxyCompactList}\small\item\em the nextshot object \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}{lspmac\-\_\-motor\-\_\-t} \hyperlink{pgpmac_8h_aebfce5f9cbc8ba7bd4e2ee4880f303e8}{lspmac\-\_\-motors} \mbox{[}$\,$\mbox{]}
\begin{DoxyCompactList}\small\item\em All our motors. \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}{lspmac\-\_\-motor\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_a8237e646ce032a840637a4ef7bff49b9}{omega}
\begin{DoxyCompactList}\small\item\em M\-D2 omega axis (the air bearing) \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}{lspmac\-\_\-motor\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_a6cb218bdccfe5a93471c161f15a15cab}{alignx}
\begin{DoxyCompactList}\small\item\em Alignment stage X. \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}{lspmac\-\_\-motor\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_a737c246c3948e644a18d191a931e1acd}{aligny}
\begin{DoxyCompactList}\small\item\em Alignment stage Y. \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}{lspmac\-\_\-motor\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_ae7642b1da0f7c7f8448104c691d40a12}{alignz}
\begin{DoxyCompactList}\small\item\em Alignment stage X. \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}{lspmac\-\_\-motor\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_aa90d2363b744acbd4d45133b7a716d8f}{anal}
\begin{DoxyCompactList}\small\item\em Polaroid analyzer motor. \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}{lspmac\-\_\-motor\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_ad53a42cfaa04eff0336a44c8c9986333}{zoom}
\begin{DoxyCompactList}\small\item\em Optical zoom. \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}{lspmac\-\_\-motor\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_a139200ddaa9856a7ffcec0e6cbaa8f1b}{apery}
\begin{DoxyCompactList}\small\item\em Aperture Y. \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}{lspmac\-\_\-motor\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_ab93bd6ee850b285ca3a95e64d15e9477}{aperz}
\begin{DoxyCompactList}\small\item\em Aperture Z. \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}{lspmac\-\_\-motor\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_a51358daaea8b5236f08414877d8af6c2}{capy}
\begin{DoxyCompactList}\small\item\em Capillary Y. \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}{lspmac\-\_\-motor\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_aa45f268d0af9f3d465acfab128919718}{capz}
\begin{DoxyCompactList}\small\item\em Capillary Z. \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}{lspmac\-\_\-motor\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_a589431b3a79c21c251fcb97cc9126991}{scint}
\begin{DoxyCompactList}\small\item\em Scintillator Z. \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}{lspmac\-\_\-motor\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_ac940d950d9efeaf3f0ae67e9bf331188}{cenx}
\begin{DoxyCompactList}\small\item\em Centering Table X. \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}{lspmac\-\_\-motor\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_aaed18e738ba7bfb6c771a44f5d7ea827}{ceny}
\begin{DoxyCompactList}\small\item\em Centering Table Y. \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}{lspmac\-\_\-motor\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_a0be79ccb7ebf3a665248fd856112b9fd}{kappa}
\begin{DoxyCompactList}\small\item\em Kappa. \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}{lspmac\-\_\-motor\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_ac8070dc568ad974a3db42b51eca828cc}{phi}
\begin{DoxyCompactList}\small\item\em Phi (not data collection axis) \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}{lspmac\-\_\-motor\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_a26dec4623af9beed912b8e7e6f99822c}{fshut}
\begin{DoxyCompactList}\small\item\em Fast shutter. \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}{lspmac\-\_\-motor\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_aeb09895663eff333b7a75acb319a9fc1}{flight}
\begin{DoxyCompactList}\small\item\em Front Light D\-A\-C. \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}{lspmac\-\_\-motor\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_a85d6eaa4b4a82bb3112574f458d1dc50}{blight}
\begin{DoxyCompactList}\small\item\em Back Light D\-A\-C. \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}{lspmac\-\_\-motor\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_a8a3ca6fcf5e24dcc26170736843e53b2}{fscint}
\begin{DoxyCompactList}\small\item\em Scintillator Piezo D\-A\-C. \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}{lspmac\-\_\-motor\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_abee73a0d9e5f3af9eb88d5cfd6b953c3}{smart\-\_\-mag\-\_\-oo}
\begin{DoxyCompactList}\small\item\em Smart Magnet on/off. \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}{lspmac\-\_\-motor\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_af813a2eff0b7efa4c70633559054e84c}{blight\-\_\-ud}
\begin{DoxyCompactList}\small\item\em Back light Up/\-Down actuator. \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}{lspmac\-\_\-motor\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_ae78d9a757d4c85419fff9c94b15e25d7}{cryo}
\begin{DoxyCompactList}\small\item\em Move the cryostream towards or away from the crystal. \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}{lspmac\-\_\-motor\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_a9d9c5030d817483ca9518027c91adac4}{dryer}
\begin{DoxyCompactList}\small\item\em blow air on the scintilator to dry it off \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}{lspmac\-\_\-motor\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_addb26c80065506faa1de3c1b468fe03f}{fluo}
\begin{DoxyCompactList}\small\item\em Move the fluorescence detector in/out. \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}{lspmac\-\_\-motor\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_a6630442dc65ce8a30a24ed718b301971}{flight\-\_\-oo}
\begin{DoxyCompactList}\small\item\em Turn front light on/off. \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}{lspmac\-\_\-motor\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_af55c51d52c4586b647114f95d7ac1f42}{blight\-\_\-f}
\begin{DoxyCompactList}\small\item\em Back light scale factor. \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}{lspmac\-\_\-motor\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_aabf4ec595b5183c1777d029ca56134b0}{flight\-\_\-f}
\begin{DoxyCompactList}\small\item\em Front light scale factor. \end{DoxyCompactList}\item 
int \hyperlink{pgpmac_8h_a56260f012c50a591ee7f97e500f16994}{lspmac\-\_\-nmotors}
\begin{DoxyCompactList}\small\item\em The number of motors we manage. \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_ac48984832ef73cf145e5f08bc65bd3a0}{lspmac\-\_\-bi\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_aade15098d213bb25522048e4a231941a}{lp\-\_\-air}
\begin{DoxyCompactList}\small\item\em Low pressure air O\-K. \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_ac48984832ef73cf145e5f08bc65bd3a0}{lspmac\-\_\-bi\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_abb29b117ad38156ba16fcf44eeb427af}{hp\-\_\-air}
\begin{DoxyCompactList}\small\item\em High pressure air O\-K. \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_ac48984832ef73cf145e5f08bc65bd3a0}{lspmac\-\_\-bi\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_a28df32fd6be9160603aa1bb74a823574}{cryo\-\_\-switch}
\begin{DoxyCompactList}\small\item\em that little toggle switch for the cryo \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_ac48984832ef73cf145e5f08bc65bd3a0}{lspmac\-\_\-bi\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_ac0d0bc95bcbcbd154b30c72a9645c8b2}{blight\-\_\-down}
\begin{DoxyCompactList}\small\item\em Backlight is down. \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_ac48984832ef73cf145e5f08bc65bd3a0}{lspmac\-\_\-bi\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_a7fba65f6555c5c7908852c6cf1ad0c94}{blight\-\_\-up}
\begin{DoxyCompactList}\small\item\em Backlight is up. \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_ac48984832ef73cf145e5f08bc65bd3a0}{lspmac\-\_\-bi\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_a871d4cdea0a1a8db85b8658a07655212}{cryo\-\_\-back}
\begin{DoxyCompactList}\small\item\em cryo is in the back position \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_ac48984832ef73cf145e5f08bc65bd3a0}{lspmac\-\_\-bi\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_a67092de6f3fcc0b245e4970437eaff6b}{fluor\-\_\-back}
\begin{DoxyCompactList}\small\item\em fluor is in the back position \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_ac48984832ef73cf145e5f08bc65bd3a0}{lspmac\-\_\-bi\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_ac59ab990e48033a811aeb0281fb588fc}{sample\-\_\-detected}
\begin{DoxyCompactList}\small\item\em smart magnet detected sample \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_ac48984832ef73cf145e5f08bc65bd3a0}{lspmac\-\_\-bi\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_a5538a6aa526eeed65ff237303da2d348}{etel\-\_\-ready}
\begin{DoxyCompactList}\small\item\em E\-T\-E\-L is ready. \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_ac48984832ef73cf145e5f08bc65bd3a0}{lspmac\-\_\-bi\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_ab48d4a2cf0225796db9aad49f034dc59}{etel\-\_\-on}
\begin{DoxyCompactList}\small\item\em E\-T\-E\-L is on. \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_ac48984832ef73cf145e5f08bc65bd3a0}{lspmac\-\_\-bi\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_a1e690d4ad981d020ea2c850282dca3be}{etel\-\_\-init\-\_\-ok}
\begin{DoxyCompactList}\small\item\em E\-T\-E\-L initialized O\-K. \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_ac48984832ef73cf145e5f08bc65bd3a0}{lspmac\-\_\-bi\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_ab552f2e28dd9cccefafe01f27717101b}{minikappa\-\_\-ok}
\begin{DoxyCompactList}\small\item\em Minikappa is O\-K (whatever that means) \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_ac48984832ef73cf145e5f08bc65bd3a0}{lspmac\-\_\-bi\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_a2dc6fa78bb6313fe8b696d646eaa2443}{smart\-\_\-mag\-\_\-on}
\begin{DoxyCompactList}\small\item\em smart magnet is on \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_ac48984832ef73cf145e5f08bc65bd3a0}{lspmac\-\_\-bi\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_afaff4fbb5f03b0d2469fc7a14f174d69}{arm\-\_\-parked}
\begin{DoxyCompactList}\small\item\em (whose arm? parked where?) \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_ac48984832ef73cf145e5f08bc65bd3a0}{lspmac\-\_\-bi\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_ae98a0792d6b4b96a33df0a31bdec6342}{shutter\-\_\-open}
\begin{DoxyCompactList}\small\item\em shutter is open (note in pmc says this is a slow input) \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_ac48984832ef73cf145e5f08bc65bd3a0}{lspmac\-\_\-bi\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_a4892e918830dd12093d28c53a1c2df98}{smart\-\_\-mag\-\_\-off}
\begin{DoxyCompactList}\small\item\em smart magnet is off \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_ac48984832ef73cf145e5f08bc65bd3a0}{lspmac\-\_\-bi\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_a37903ed8430ac4d9ead609a78eb62f32}{smart\-\_\-mag\-\_\-err}
\begin{DoxyCompactList}\small\item\em smart magnet error (coil broken perhaps) \end{DoxyCompactList}\item 
struct timespec \hyperlink{pgpmac_8h_ae6631a094accc469661805bdf80fc6d8}{omega\-\_\-zero\-\_\-time}
\begin{DoxyCompactList}\small\item\em Time we believe that omega crossed zero. \end{DoxyCompactList}\item 
W\-I\-N\-D\-O\-W $\ast$ \hyperlink{pgpmac_8h_a65daf0f4a5bc6def23a9df98ff5ca57e}{term\-\_\-output}
\begin{DoxyCompactList}\small\item\em place to print stuff out \end{DoxyCompactList}\item 
W\-I\-N\-D\-O\-W $\ast$ \hyperlink{pgpmac_8h_ab0487111dbe3c05d0bd835eb2fb9a3f7}{term\-\_\-input}
\begin{DoxyCompactList}\small\item\em place to put the cursor \end{DoxyCompactList}\item 
W\-I\-N\-D\-O\-W $\ast$ \hyperlink{pgpmac_8h_ae746a6903fb8a4ea216def88eccedc3c}{term\-\_\-status}
\begin{DoxyCompactList}\small\item\em shutter, lamp, air, etc status \end{DoxyCompactList}\item 
W\-I\-N\-D\-O\-W $\ast$ \hyperlink{pgpmac_8h_ae2d7da3afeb756716e6e4ee9cab78f8a}{term\-\_\-status2}
\begin{DoxyCompactList}\small\item\em shutter, lamp, air, etc status \end{DoxyCompactList}\item 
pthread\-\_\-mutex\-\_\-t \hyperlink{pgpmac_8h_ad128c64890c7c0d4f836d9ec6e99216a}{ncurses\-\_\-mutex}
\begin{DoxyCompactList}\small\item\em allow more than one thread access to the screen \end{DoxyCompactList}\item 
pthread\-\_\-cond\-\_\-t \hyperlink{pgpmac_8h_a08d5b18ec9478d753c46a3e28d1f2126}{md2cmds\-\_\-cond}
\begin{DoxyCompactList}\small\item\em condition to signal when it's time to run an md2 command \end{DoxyCompactList}\item 
pthread\-\_\-mutex\-\_\-t \hyperlink{pgpmac_8h_ad67304bb851dc6268b0cda2f40fc5aa8}{md2cmds\-\_\-mutex}
\begin{DoxyCompactList}\small\item\em mutex for the condition \end{DoxyCompactList}\item 
pthread\-\_\-cond\-\_\-t \hyperlink{pgpmac_8h_ab517a930528e2b7d0993e11087765b03}{md2cmds\-\_\-pg\-\_\-cond}
\item 
pthread\-\_\-mutex\-\_\-t \hyperlink{pgpmac_8h_a4d2c3ac81d4b13eb21f4ddcdda8c7308}{md2cmds\-\_\-pg\-\_\-mutex}
\item 
pthread\-\_\-mutex\-\_\-t \hyperlink{pgpmac_8h_acc1bb77b9bcbc4d970f841a41fd274b3}{pmac\-\_\-queue\-\_\-mutex}
\begin{DoxyCompactList}\small\item\em manage access to the pmac command queue \end{DoxyCompactList}\item 
pthread\-\_\-cond\-\_\-t \hyperlink{pgpmac_8h_a8a25bd9c593c6985107f90f999ce0b08}{pmac\-\_\-queue\-\_\-cond}
\begin{DoxyCompactList}\small\item\em wait for a command to be sent to P\-M\-A\-C before continuing \end{DoxyCompactList}\item 
pthread\-\_\-mutex\-\_\-t \hyperlink{pgpmac_8h_a1b78a13c654409333569815e1c109d38}{lspmac\-\_\-shutter\-\_\-mutex}
\begin{DoxyCompactList}\small\item\em Coordinates threads reading shutter status. \end{DoxyCompactList}\item 
pthread\-\_\-cond\-\_\-t \hyperlink{pgpmac_8h_afbd51c2cefcee87afe994c9e9f372241}{lspmac\-\_\-shutter\-\_\-cond}
\begin{DoxyCompactList}\small\item\em Allows waiting for the shutter status to change. \end{DoxyCompactList}\item 
int \hyperlink{pgpmac_8h_a112158e0cd50449a440ac55c7af7bea2}{lspmac\-\_\-shutter\-\_\-state}
\begin{DoxyCompactList}\small\item\em State of the shutter, used to detect changes. \end{DoxyCompactList}\item 
int \hyperlink{pgpmac_8h_a396fbf06208de3ecbe1b0df549f1cd46}{lspmac\-\_\-shutter\-\_\-has\-\_\-opened}
\begin{DoxyCompactList}\small\item\em Indicates that the shutter had opened, perhaps briefly even if the state did not change. \end{DoxyCompactList}\item 
pthread\-\_\-mutex\-\_\-t \hyperlink{pgpmac_8h_a85679cac947e199c88794f8e5a12bf5f}{lspmac\-\_\-moving\-\_\-mutex}
\begin{DoxyCompactList}\small\item\em Coordinate moving motors between threads. \end{DoxyCompactList}\item 
pthread\-\_\-cond\-\_\-t \hyperlink{pgpmac_8h_a57547d211906c981ef20257eba99f8df}{lspmac\-\_\-moving\-\_\-cond}
\begin{DoxyCompactList}\small\item\em Wait for motor(s) to finish moving condition. \end{DoxyCompactList}\item 
int \hyperlink{pgpmac_8h_a7a32c617c183166308241e270959df56}{lspmac\-\_\-moving\-\_\-flags}
\begin{DoxyCompactList}\small\item\em Flag used to implement motor moving condition. \end{DoxyCompactList}\item 
pthread\-\_\-mutex\-\_\-t \hyperlink{pgpmac_8h_a7a3e763682bd7f987d07f149e94b3bf8}{md2\-\_\-status\-\_\-mutex}
\begin{DoxyCompactList}\small\item\em Synchronize reading/writting status buffer. \end{DoxyCompactList}\item 
char \hyperlink{pgpmac_8h_a1ccf455563dc8d828558b6a230e164a6}{md2cmds\-\_\-cmd} \mbox{[}$\,$\mbox{]}
\begin{DoxyCompactList}\small\item\em our command; \end{DoxyCompactList}\item 
\hyperlink{pgpmac_8h_ad449de06d02791adf2498d2a1e1f909c}{lsredis\-\_\-obj\-\_\-t} $\ast$ \hyperlink{pgpmac_8h_a6a34fb6876abbd580629d3708c805e7f}{md2cmds\-\_\-md\-\_\-status\-\_\-code}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Headers for the entire pgpmac project. \begin{DoxyDate}{Date}
2012 
\end{DoxyDate}
\begin{DoxyAuthor}{Author}
Keith Brister 
\end{DoxyAuthor}
\begin{DoxyCopyright}{Copyright}
All Rights Reserved 
\end{DoxyCopyright}


Definition in file \hyperlink{pgpmac_8h_source}{pgpmac.\-h}.



\subsection{Macro Definition Documentation}
\hypertarget{pgpmac_8h_a369266c24eacffb87046522897a570d5}{\index{pgpmac.\-h@{pgpmac.\-h}!\-\_\-\-G\-N\-U\-\_\-\-S\-O\-U\-R\-C\-E@{\-\_\-\-G\-N\-U\-\_\-\-S\-O\-U\-R\-C\-E}}
\index{\-\_\-\-G\-N\-U\-\_\-\-S\-O\-U\-R\-C\-E@{\-\_\-\-G\-N\-U\-\_\-\-S\-O\-U\-R\-C\-E}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{\-\_\-\-G\-N\-U\-\_\-\-S\-O\-U\-R\-C\-E}]{\setlength{\rightskip}{0pt plus 5cm}\#define \-\_\-\-G\-N\-U\-\_\-\-S\-O\-U\-R\-C\-E}}\label{pgpmac_8h_a369266c24eacffb87046522897a570d5}


Definition at line 7 of file pgpmac.\-h.

\hypertarget{pgpmac_8h_a3bae94e8e4e4347dd5f87b6bda058de6}{\index{pgpmac.\-h@{pgpmac.\-h}!L\-S\-\_\-\-D\-I\-S\-P\-L\-A\-Y\-\_\-\-W\-I\-N\-D\-O\-W\-\_\-\-H\-E\-I\-G\-H\-T@{L\-S\-\_\-\-D\-I\-S\-P\-L\-A\-Y\-\_\-\-W\-I\-N\-D\-O\-W\-\_\-\-H\-E\-I\-G\-H\-T}}
\index{L\-S\-\_\-\-D\-I\-S\-P\-L\-A\-Y\-\_\-\-W\-I\-N\-D\-O\-W\-\_\-\-H\-E\-I\-G\-H\-T@{L\-S\-\_\-\-D\-I\-S\-P\-L\-A\-Y\-\_\-\-W\-I\-N\-D\-O\-W\-\_\-\-H\-E\-I\-G\-H\-T}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{L\-S\-\_\-\-D\-I\-S\-P\-L\-A\-Y\-\_\-\-W\-I\-N\-D\-O\-W\-\_\-\-H\-E\-I\-G\-H\-T}]{\setlength{\rightskip}{0pt plus 5cm}\#define L\-S\-\_\-\-D\-I\-S\-P\-L\-A\-Y\-\_\-\-W\-I\-N\-D\-O\-W\-\_\-\-H\-E\-I\-G\-H\-T~8}}\label{pgpmac_8h_a3bae94e8e4e4347dd5f87b6bda058de6}


Number of status box rows. 



Definition at line 57 of file pgpmac.\-h.

\hypertarget{pgpmac_8h_a1f96754f00a1f82414cebc66f75ded78}{\index{pgpmac.\-h@{pgpmac.\-h}!L\-S\-\_\-\-D\-I\-S\-P\-L\-A\-Y\-\_\-\-W\-I\-N\-D\-O\-W\-\_\-\-W\-I\-D\-T\-H@{L\-S\-\_\-\-D\-I\-S\-P\-L\-A\-Y\-\_\-\-W\-I\-N\-D\-O\-W\-\_\-\-W\-I\-D\-T\-H}}
\index{L\-S\-\_\-\-D\-I\-S\-P\-L\-A\-Y\-\_\-\-W\-I\-N\-D\-O\-W\-\_\-\-W\-I\-D\-T\-H@{L\-S\-\_\-\-D\-I\-S\-P\-L\-A\-Y\-\_\-\-W\-I\-N\-D\-O\-W\-\_\-\-W\-I\-D\-T\-H}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{L\-S\-\_\-\-D\-I\-S\-P\-L\-A\-Y\-\_\-\-W\-I\-N\-D\-O\-W\-\_\-\-W\-I\-D\-T\-H}]{\setlength{\rightskip}{0pt plus 5cm}\#define L\-S\-\_\-\-D\-I\-S\-P\-L\-A\-Y\-\_\-\-W\-I\-N\-D\-O\-W\-\_\-\-W\-I\-D\-T\-H~24}}\label{pgpmac_8h_a1f96754f00a1f82414cebc66f75ded78}


Number of status box columns. 



Definition at line 61 of file pgpmac.\-h.

\hypertarget{pgpmac_8h_a3a8ef1b4b5994d6dd12bf74454ea891b}{\index{pgpmac.\-h@{pgpmac.\-h}!L\-S\-\_\-\-P\-G\-\_\-\-Q\-U\-E\-R\-Y\-\_\-\-S\-T\-R\-I\-N\-G\-\_\-\-L\-E\-N\-G\-T\-H@{L\-S\-\_\-\-P\-G\-\_\-\-Q\-U\-E\-R\-Y\-\_\-\-S\-T\-R\-I\-N\-G\-\_\-\-L\-E\-N\-G\-T\-H}}
\index{L\-S\-\_\-\-P\-G\-\_\-\-Q\-U\-E\-R\-Y\-\_\-\-S\-T\-R\-I\-N\-G\-\_\-\-L\-E\-N\-G\-T\-H@{L\-S\-\_\-\-P\-G\-\_\-\-Q\-U\-E\-R\-Y\-\_\-\-S\-T\-R\-I\-N\-G\-\_\-\-L\-E\-N\-G\-T\-H}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{L\-S\-\_\-\-P\-G\-\_\-\-Q\-U\-E\-R\-Y\-\_\-\-S\-T\-R\-I\-N\-G\-\_\-\-L\-E\-N\-G\-T\-H}]{\setlength{\rightskip}{0pt plus 5cm}\#define L\-S\-\_\-\-P\-G\-\_\-\-Q\-U\-E\-R\-Y\-\_\-\-S\-T\-R\-I\-N\-G\-\_\-\-L\-E\-N\-G\-T\-H~1024}}\label{pgpmac_8h_a3a8ef1b4b5994d6dd12bf74454ea891b}


Fixed length postgresql query strings. Queries should all be function calls so this is not as weird as one might think. 



Definition at line 64 of file pgpmac.\-h.

\hypertarget{pgpmac_8h_ab61d790b5572f116e091babfda53627b}{\index{pgpmac.\-h@{pgpmac.\-h}!L\-S\-E\-V\-E\-N\-T\-S\-\_\-\-E\-V\-E\-N\-T\-\_\-\-L\-E\-N\-G\-T\-H@{L\-S\-E\-V\-E\-N\-T\-S\-\_\-\-E\-V\-E\-N\-T\-\_\-\-L\-E\-N\-G\-T\-H}}
\index{L\-S\-E\-V\-E\-N\-T\-S\-\_\-\-E\-V\-E\-N\-T\-\_\-\-L\-E\-N\-G\-T\-H@{L\-S\-E\-V\-E\-N\-T\-S\-\_\-\-E\-V\-E\-N\-T\-\_\-\-L\-E\-N\-G\-T\-H}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{L\-S\-E\-V\-E\-N\-T\-S\-\_\-\-E\-V\-E\-N\-T\-\_\-\-L\-E\-N\-G\-T\-H}]{\setlength{\rightskip}{0pt plus 5cm}\#define L\-S\-E\-V\-E\-N\-T\-S\-\_\-\-E\-V\-E\-N\-T\-\_\-\-L\-E\-N\-G\-T\-H~256}}\label{pgpmac_8h_ab61d790b5572f116e091babfda53627b}


Fixed length for event names\-: simplifies string handling. 



Definition at line 67 of file pgpmac.\-h.

\hypertarget{pgpmac_8h_a30f0f377b0f0695284145d420ea51846}{\index{pgpmac.\-h@{pgpmac.\-h}!M\-D2\-C\-M\-D\-S\-\_\-\-C\-M\-D\-\_\-\-L\-E\-N\-G\-T\-H@{M\-D2\-C\-M\-D\-S\-\_\-\-C\-M\-D\-\_\-\-L\-E\-N\-G\-T\-H}}
\index{M\-D2\-C\-M\-D\-S\-\_\-\-C\-M\-D\-\_\-\-L\-E\-N\-G\-T\-H@{M\-D2\-C\-M\-D\-S\-\_\-\-C\-M\-D\-\_\-\-L\-E\-N\-G\-T\-H}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{M\-D2\-C\-M\-D\-S\-\_\-\-C\-M\-D\-\_\-\-L\-E\-N\-G\-T\-H}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\-D2\-C\-M\-D\-S\-\_\-\-C\-M\-D\-\_\-\-L\-E\-N\-G\-T\-H~32}}\label{pgpmac_8h_a30f0f377b0f0695284145d420ea51846}


Definition at line 478 of file pgpmac.\-h.



\subsection{Typedef Documentation}
\hypertarget{pgpmac_8h_a7f71abc6fdfd1839e2e3213d78aaf766}{\index{pgpmac.\-h@{pgpmac.\-h}!lspg\-\_\-demandairrights\-\_\-t@{lspg\-\_\-demandairrights\-\_\-t}}
\index{lspg\-\_\-demandairrights\-\_\-t@{lspg\-\_\-demandairrights\-\_\-t}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspg\-\_\-demandairrights\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf lspg\-\_\-demandairrights\-\_\-struct}  {\bf lspg\-\_\-demandairrights\-\_\-t}}}\label{pgpmac_8h_a7f71abc6fdfd1839e2e3213d78aaf766}
\hypertarget{pgpmac_8h_a48b627e412dd038c1f17cdb0501eec33}{\index{pgpmac.\-h@{pgpmac.\-h}!lspg\-\_\-getcenter\-\_\-t@{lspg\-\_\-getcenter\-\_\-t}}
\index{lspg\-\_\-getcenter\-\_\-t@{lspg\-\_\-getcenter\-\_\-t}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspg\-\_\-getcenter\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf lspg\-\_\-getcenter\-\_\-struct}  {\bf lspg\-\_\-getcenter\-\_\-t}}}\label{pgpmac_8h_a48b627e412dd038c1f17cdb0501eec33}


Storage for getcenter query Used for the md2 R\-O\-T\-A\-T\-E command that generates the centering movies. 

\hypertarget{pgpmac_8h_a7a794370785ff015d5ee035917e3bee8}{\index{pgpmac.\-h@{pgpmac.\-h}!lspg\-\_\-getcurrentsampleid\-\_\-t@{lspg\-\_\-getcurrentsampleid\-\_\-t}}
\index{lspg\-\_\-getcurrentsampleid\-\_\-t@{lspg\-\_\-getcurrentsampleid\-\_\-t}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspg\-\_\-getcurrentsampleid\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf lspg\-\_\-getcurrentsampleid\-\_\-struct}  {\bf lspg\-\_\-getcurrentsampleid\-\_\-t}}}\label{pgpmac_8h_a7a794370785ff015d5ee035917e3bee8}
\hypertarget{pgpmac_8h_a9dda9014cd0e39fba8d523e37cf9f982}{\index{pgpmac.\-h@{pgpmac.\-h}!lspg\-\_\-nextsample\-\_\-t@{lspg\-\_\-nextsample\-\_\-t}}
\index{lspg\-\_\-nextsample\-\_\-t@{lspg\-\_\-nextsample\-\_\-t}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspg\-\_\-nextsample\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf lspg\-\_\-nextsample\-\_\-struct}  {\bf lspg\-\_\-nextsample\-\_\-t}}}\label{pgpmac_8h_a9dda9014cd0e39fba8d523e37cf9f982}


Returns the next sample number Just a 32 bit int (Ha!, take that, nextshot!) 

\hypertarget{pgpmac_8h_a17ea2bf07a0b3b892baa00bd392607b3}{\index{pgpmac.\-h@{pgpmac.\-h}!lspg\-\_\-nextshot\-\_\-t@{lspg\-\_\-nextshot\-\_\-t}}
\index{lspg\-\_\-nextshot\-\_\-t@{lspg\-\_\-nextshot\-\_\-t}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspg\-\_\-nextshot\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf lspg\-\_\-nextshot\-\_\-struct}  {\bf lspg\-\_\-nextshot\-\_\-t}}}\label{pgpmac_8h_a17ea2bf07a0b3b892baa00bd392607b3}


Storage definition for nextshot query. 

The next shot query returns all the information needed to collect the next data frame. Since S\-Q\-L allows for null fields independently from blank strings a separate integer is used as a flag for this case. This adds to the program complexity but allows for some important cases. Suck it up.\-definition of the next image to be taken (and the one after that, too!) \hypertarget{pgpmac_8h_ae57432c0a6ac48a50457815dab2c5b4c}{\index{pgpmac.\-h@{pgpmac.\-h}!lspg\-\_\-query\-\_\-queue\-\_\-t@{lspg\-\_\-query\-\_\-queue\-\_\-t}}
\index{lspg\-\_\-query\-\_\-queue\-\_\-t@{lspg\-\_\-query\-\_\-queue\-\_\-t}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspg\-\_\-query\-\_\-queue\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf lspg\-Query\-Queue\-Struct}  {\bf lspg\-\_\-query\-\_\-queue\-\_\-t}}}\label{pgpmac_8h_ae57432c0a6ac48a50457815dab2c5b4c}


Store each query along with it's callback function. 

All calls are asynchronous \hypertarget{pgpmac_8h_aa1f0e602ae9509005c62fb2d73bc1c5a}{\index{pgpmac.\-h@{pgpmac.\-h}!lspg\-\_\-starttransfer\-\_\-t@{lspg\-\_\-starttransfer\-\_\-t}}
\index{lspg\-\_\-starttransfer\-\_\-t@{lspg\-\_\-starttransfer\-\_\-t}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspg\-\_\-starttransfer\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf lspg\-\_\-starttransfer\-\_\-struct}  {\bf lspg\-\_\-starttransfer\-\_\-t}}}\label{pgpmac_8h_aa1f0e602ae9509005c62fb2d73bc1c5a}


returns 1 if transfer can continue 0 to abort 

\hypertarget{pgpmac_8h_a779e2acce8b5e748c184caf23ed0db57}{\index{pgpmac.\-h@{pgpmac.\-h}!lspg\-\_\-waitcryo\-\_\-t@{lspg\-\_\-waitcryo\-\_\-t}}
\index{lspg\-\_\-waitcryo\-\_\-t@{lspg\-\_\-waitcryo\-\_\-t}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspg\-\_\-waitcryo\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf lspg\-\_\-waitcryo\-\_\-struct}  {\bf lspg\-\_\-waitcryo\-\_\-t}}}\label{pgpmac_8h_a779e2acce8b5e748c184caf23ed0db57}
\hypertarget{pgpmac_8h_ac48984832ef73cf145e5f08bc65bd3a0}{\index{pgpmac.\-h@{pgpmac.\-h}!lspmac\-\_\-bi\-\_\-t@{lspmac\-\_\-bi\-\_\-t}}
\index{lspmac\-\_\-bi\-\_\-t@{lspmac\-\_\-bi\-\_\-t}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspmac\-\_\-bi\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf lspmac\-\_\-bi\-\_\-struct}  {\bf lspmac\-\_\-bi\-\_\-t}}}\label{pgpmac_8h_ac48984832ef73cf145e5f08bc65bd3a0}


Storage for binary inputs. 

\hypertarget{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}{\index{pgpmac.\-h@{pgpmac.\-h}!lspmac\-\_\-motor\-\_\-t@{lspmac\-\_\-motor\-\_\-t}}
\index{lspmac\-\_\-motor\-\_\-t@{lspmac\-\_\-motor\-\_\-t}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspmac\-\_\-motor\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf lspmac\-\_\-motor\-\_\-struct}  {\bf lspmac\-\_\-motor\-\_\-t}}}\label{pgpmac_8h_aa5067fcbaabc5bbfdc52492495518c96}


Motor information. 

A catchall for motors and motor like objects. Not all members are used by all objects. \hypertarget{pgpmac_8h_ad449de06d02791adf2498d2a1e1f909c}{\index{pgpmac.\-h@{pgpmac.\-h}!lsredis\-\_\-obj\-\_\-t@{lsredis\-\_\-obj\-\_\-t}}
\index{lsredis\-\_\-obj\-\_\-t@{lsredis\-\_\-obj\-\_\-t}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lsredis\-\_\-obj\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf lsredis\-\_\-obj\-\_\-struct}  {\bf lsredis\-\_\-obj\-\_\-t}}}\label{pgpmac_8h_ad449de06d02791adf2498d2a1e1f909c}


Redis Object Basic object whose value is sychronized with our redis db. 

\hypertarget{pgpmac_8h_a99c275e32ad897dca34d196b91f038cb}{\index{pgpmac.\-h@{pgpmac.\-h}!pmac\-\_\-cmd\-\_\-queue\-\_\-t@{pmac\-\_\-cmd\-\_\-queue\-\_\-t}}
\index{pmac\-\_\-cmd\-\_\-queue\-\_\-t@{pmac\-\_\-cmd\-\_\-queue\-\_\-t}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{pmac\-\_\-cmd\-\_\-queue\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf lspmac\-\_\-cmd\-\_\-queue\-\_\-struct}  {\bf pmac\-\_\-cmd\-\_\-queue\-\_\-t}}}\label{pgpmac_8h_a99c275e32ad897dca34d196b91f038cb}


P\-M\-A\-C command queue item. 

Command queue items are fixed length to simplify memory management. \hypertarget{pgpmac_8h_a2d163436571135a457f4a4e2fbd09633}{\index{pgpmac.\-h@{pgpmac.\-h}!pmac\-\_\-cmd\-\_\-t@{pmac\-\_\-cmd\-\_\-t}}
\index{pmac\-\_\-cmd\-\_\-t@{pmac\-\_\-cmd\-\_\-t}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{pmac\-\_\-cmd\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf tag\-Ethernet\-Cmd}  {\bf pmac\-\_\-cmd\-\_\-t}}}\label{pgpmac_8h_a2d163436571135a457f4a4e2fbd09633}


P\-M\-A\-C ethernet packet definition. 

Taken directly from the Delta Tau documentation. 

\subsection{Function Documentation}
\hypertarget{pgpmac_8h_aac89b916c1152c44042875feac35a9e4}{\index{pgpmac.\-h@{pgpmac.\-h}!lsevents\-\_\-add\-\_\-listener@{lsevents\-\_\-add\-\_\-listener}}
\index{lsevents\-\_\-add\-\_\-listener@{lsevents\-\_\-add\-\_\-listener}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lsevents\-\_\-add\-\_\-listener}]{\setlength{\rightskip}{0pt plus 5cm}void lsevents\-\_\-add\-\_\-listener (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{event, }
\item[{void($\ast$)(char $\ast$)}]{cb}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_aac89b916c1152c44042875feac35a9e4}


Add a callback routine to listen for a specific event. 


\begin{DoxyParams}{Parameters}
{\em event} & the name of the event to listen for \\
\hline
{\em cb} & the routine to call \\
\hline
\end{DoxyParams}


Definition at line 75 of file lsevents.\-c.


\begin{DoxyCode}
                                                             \{
  \hyperlink{structlsevents__listener__struct}{lsevents\_listener\_t} *\textcolor{keyword}{new};
  \textcolor{keywordtype}{int} err;
  \textcolor{keywordtype}{char} *errbuf;
  \textcolor{keywordtype}{int} nerrbuf;



  \textcolor{keyword}{new} = calloc( 1, \textcolor{keyword}{sizeof}( \hyperlink{structlsevents__listener__struct}{lsevents\_listener\_t}));
  \textcolor{keywordflow}{if}( \textcolor{keyword}{new} == NULL) \{
    \hyperlink{lslogging_8c_a0e756b36671055ef02a8f04d2ba8a93b}{lslogging\_log\_message}( \textcolor{stringliteral}{"lsevents\_add\_listener: out of
       memory"});
    exit( -1);
  \}

  err = regcomp( &new->re, event, REG\_EXTENDED | REG\_NOSUB);
  \textcolor{keywordflow}{if}( err != 0) \{
    nerrbuf = regerror( err, &new->re, NULL, 0);
    errbuf = calloc( nerrbuf, \textcolor{keyword}{sizeof}( \textcolor{keywordtype}{char}));
    \textcolor{keywordflow}{if}( errbuf == NULL) \{
      \hyperlink{lslogging_8c_a0e756b36671055ef02a8f04d2ba8a93b}{lslogging\_log\_message}( \textcolor{stringliteral}{"lsevents\_add\_listener: out
       of memory (re)"});
      exit( -1);
    \}
    regerror( err, &new->re, errbuf, nerrbuf);
    \hyperlink{lslogging_8c_a0e756b36671055ef02a8f04d2ba8a93b}{lslogging\_log\_message}( \textcolor{stringliteral}{"lsevents\_add\_listener: %s"}, 
      errbuf);
    free( errbuf);
    free( \textcolor{keyword}{new});
    \textcolor{keywordflow}{return};
  \}

  \textcolor{keyword}{new}->raw\_regexp = strdup( event);
  \textcolor{keyword}{new}->cb   = cb;

  pthread\_mutex\_lock( &\hyperlink{lsevents_8c_a70bba59930a1c7d7d181aa03cdfb6c00}{lsevents\_listener\_mutex});
  \textcolor{keyword}{new}->next = \hyperlink{lsevents_8c_a300dc3edfa8546d75e9f8bab8fa06c5c}{lsevents\_listeners\_p};
  \hyperlink{lsevents_8c_a300dc3edfa8546d75e9f8bab8fa06c5c}{lsevents\_listeners\_p} = \textcolor{keyword}{new};
  pthread\_mutex\_unlock( &\hyperlink{lsevents_8c_a70bba59930a1c7d7d181aa03cdfb6c00}{lsevents\_listener\_mutex});

  \hyperlink{lslogging_8c_a0e756b36671055ef02a8f04d2ba8a93b}{lslogging\_log\_message}( \textcolor{stringliteral}{"lsevents\_add\_listener: added
       listener for event %s"}, event);

\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_af19a77187e7406fc87d36bd26e672e6d}{\index{pgpmac.\-h@{pgpmac.\-h}!lsevents\-\_\-init@{lsevents\-\_\-init}}
\index{lsevents\-\_\-init@{lsevents\-\_\-init}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lsevents\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}void lsevents\-\_\-init (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_af19a77187e7406fc87d36bd26e672e6d}


Initialize this module. 



Definition at line 214 of file lsevents.\-c.


\begin{DoxyCode}
                     \{
  pthread\_mutex\_init( &\hyperlink{lsevents_8c_ab46f4ebda5e926a213faedac1a545ec1}{lsevents\_queue\_mutex}, NULL);
  pthread\_cond\_init(  &\hyperlink{lsevents_8c_a8079d9fb8c35db3ca5f83be5aeb2a747}{lsevents\_queue\_cond}, NULL);
  pthread\_mutex\_init( &\hyperlink{lsevents_8c_a70bba59930a1c7d7d181aa03cdfb6c00}{lsevents\_listener\_mutex}, NULL);
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_a024b08c7820bb31c3d5b8f281e07f3e8}{\index{pgpmac.\-h@{pgpmac.\-h}!lsevents\-\_\-remove\-\_\-listener@{lsevents\-\_\-remove\-\_\-listener}}
\index{lsevents\-\_\-remove\-\_\-listener@{lsevents\-\_\-remove\-\_\-listener}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lsevents\-\_\-remove\-\_\-listener}]{\setlength{\rightskip}{0pt plus 5cm}void lsevents\-\_\-remove\-\_\-listener (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{event, }
\item[{void($\ast$)(char $\ast$)}]{cb}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_a024b08c7820bb31c3d5b8f281e07f3e8}


Remove a listener previously added with lsevents\-\_\-add\-\_\-listener. 


\begin{DoxyParams}{Parameters}
{\em event} & The name of the event \\
\hline
{\em cb} & The callback routine to remove \\
\hline
\end{DoxyParams}


Definition at line 120 of file lsevents.\-c.


\begin{DoxyCode}
                                                                \{
  
  \hyperlink{structlsevents__listener__struct}{lsevents\_listener\_t} *last, *current;

  \textcolor{comment}{//}
  \textcolor{comment}{// Find the listener to remove}
  \textcolor{comment}{// and unlink it from the list}
  \textcolor{comment}{//}
  pthread\_mutex\_lock( &\hyperlink{lsevents_8c_a70bba59930a1c7d7d181aa03cdfb6c00}{lsevents\_listener\_mutex});
  last = NULL;
  \textcolor{keywordflow}{for}( current = \hyperlink{lsevents_8c_a300dc3edfa8546d75e9f8bab8fa06c5c}{lsevents\_listeners\_p}; current != NULL; 
      current = current->\hyperlink{structlsevents__listener__struct_a8aed9196b0deab84e018b96c0cc59305}{next}) \{
    \textcolor{keywordflow}{if}( strcmp( last->\hyperlink{structlsevents__listener__struct_afffe7a6889fda47a3a7a91beefed9168}{raw\_regexp}, event) == 0 && last->\hyperlink{structlsevents__listener__struct_a005906c1c9f0647e6ed1fb4592d8c5d0}{cb} == cb) \{
      \textcolor{keywordflow}{if}( last == NULL) \{
        \hyperlink{lsevents_8c_a300dc3edfa8546d75e9f8bab8fa06c5c}{lsevents\_listeners\_p} = current->\hyperlink{structlsevents__listener__struct_a8aed9196b0deab84e018b96c0cc59305}{next};
      \} \textcolor{keywordflow}{else} \{
        last->\hyperlink{structlsevents__listener__struct_a8aed9196b0deab84e018b96c0cc59305}{next} = current->\hyperlink{structlsevents__listener__struct_a8aed9196b0deab84e018b96c0cc59305}{next};
      \}
      \textcolor{keywordflow}{break};
    \}
  \}
  pthread\_mutex\_unlock( &\hyperlink{lsevents_8c_a70bba59930a1c7d7d181aa03cdfb6c00}{lsevents\_listener\_mutex});

  \textcolor{comment}{//}
  \textcolor{comment}{// Now remove it}
  \textcolor{comment}{//}
  \textcolor{keywordflow}{if}( current != NULL) \{
    \textcolor{keywordflow}{if}( current->\hyperlink{structlsevents__listener__struct_afffe7a6889fda47a3a7a91beefed9168}{raw\_regexp} != NULL)
      free( current->\hyperlink{structlsevents__listener__struct_afffe7a6889fda47a3a7a91beefed9168}{raw\_regexp});
    free(current);
  \}
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_a4ddde538b603e3d4580ae9356bf9b89d}{\index{pgpmac.\-h@{pgpmac.\-h}!lsevents\-\_\-run@{lsevents\-\_\-run}}
\index{lsevents\-\_\-run@{lsevents\-\_\-run}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lsevents\-\_\-run}]{\setlength{\rightskip}{0pt plus 5cm}void lsevents\-\_\-run (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_a4ddde538b603e3d4580ae9356bf9b89d}


Start up the thread and get out of the way. 



Definition at line 222 of file lsevents.\-c.


\begin{DoxyCode}
                    \{
  pthread\_create( &\hyperlink{lsevents_8c_a314640d7c3cb4fa90823ab2418fbac9b}{lsevents\_thread}, NULL, \hyperlink{lsevents_8c_a48e8f9dee00710bbe293b4bbded37a39}{lsevents\_worker}
      , NULL);
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_a3661dfc51537c05b11f4fd184fdff07d}{\index{pgpmac.\-h@{pgpmac.\-h}!lsevents\-\_\-send\-\_\-event@{lsevents\-\_\-send\-\_\-event}}
\index{lsevents\-\_\-send\-\_\-event@{lsevents\-\_\-send\-\_\-event}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lsevents\-\_\-send\-\_\-event}]{\setlength{\rightskip}{0pt plus 5cm}void lsevents\-\_\-send\-\_\-event (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{fmt, }
\item[{}]{...}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_a3661dfc51537c05b11f4fd184fdff07d}


Call the callback routines for the given event. 


\begin{DoxyParams}{Parameters}
{\em fmt} & a printf style formating string \\
\hline
{\em ...} & list of arguments specified by the format string \\
\hline
\end{DoxyParams}


Definition at line 45 of file lsevents.\-c.


\begin{DoxyCode}
                                          \{
  \textcolor{keywordtype}{char} \textcolor{keyword}{event}[\hyperlink{pgpmac_8h_ab61d790b5572f116e091babfda53627b}{LSEVENTS\_EVENT\_LENGTH}];
  va\_list arg\_ptr;

  va\_start( arg\_ptr, fmt);
  vsnprintf( event, \textcolor{keyword}{sizeof}(event)-1, fmt, arg\_ptr);
  \textcolor{keyword}{event}[\textcolor{keyword}{sizeof}(event)-1]=0;
  va\_end( arg\_ptr);

  pthread\_mutex\_lock( &\hyperlink{lsevents_8c_ab46f4ebda5e926a213faedac1a545ec1}{lsevents\_queue\_mutex});

  \hyperlink{lslogging_8c_a0e756b36671055ef02a8f04d2ba8a93b}{lslogging\_log\_message}( \textcolor{stringliteral}{"lsevents\_send\_event: %s"}, event)
      ;


  \textcolor{comment}{// maybe wait for room on the queue}
  \textcolor{keywordflow}{while}( (\hyperlink{lsevents_8c_a3bccf603d56d5b2f4a92fad341d37e2c}{lsevents\_queue\_on} + 1) % \hyperlink{lsevents_8c_a75469307c70790f04b9b2bfcb1473a48}{LSEVENTS\_QUEUE\_LENGTH}
       == \hyperlink{lsevents_8c_a50ad47e12cc4fc2d88659230b2fd44ff}{lsevents\_queue\_off} % \hyperlink{lsevents_8c_a75469307c70790f04b9b2bfcb1473a48}{LSEVENTS\_QUEUE\_LENGTH}
      )
    pthread\_cond\_wait( &\hyperlink{lsevents_8c_a8079d9fb8c35db3ca5f83be5aeb2a747}{lsevents\_queue\_cond}, &
      \hyperlink{lsevents_8c_ab46f4ebda5e926a213faedac1a545ec1}{lsevents\_queue\_mutex});
  
  \hyperlink{lsevents_8c_ad1ff5e895b4016113c8414d9a5daa2f2}{lsevents\_queue}[(\hyperlink{lsevents_8c_a3bccf603d56d5b2f4a92fad341d37e2c}{lsevents\_queue\_on}++) % 
      LSEVENTS\_QUEUE\_LENGTH].evp = strdup(event);

  pthread\_cond\_signal(  &\hyperlink{lsevents_8c_a8079d9fb8c35db3ca5f83be5aeb2a747}{lsevents\_queue\_cond});
  pthread\_mutex\_unlock( &\hyperlink{lsevents_8c_ab46f4ebda5e926a213faedac1a545ec1}{lsevents\_queue\_mutex});

\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_a3418b9ab57811d28632794236e056408}{\index{pgpmac.\-h@{pgpmac.\-h}!lslogging\-\_\-init@{lslogging\-\_\-init}}
\index{lslogging\-\_\-init@{lslogging\-\_\-init}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lslogging\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}void lslogging\-\_\-init (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_a3418b9ab57811d28632794236e056408}


Initialize the lslogging objects. 



Definition at line 37 of file lslogging.\-c.


\begin{DoxyCode}
                      \{
  pthread\_mutex\_init( &\hyperlink{lslogging_8c_a4a97ffe8731ae437f014ada051301be3}{lslogging\_mutex}, NULL);
  pthread\_cond\_init(  &\hyperlink{lslogging_8c_afa5f05c4337683edc3c88ab56aa5ea6f}{lslogging\_cond}, NULL);

  \hyperlink{lslogging_8c_a5709d6eb68a8eebf78ba58bb78da0649}{lslogging\_file} = fopen( \hyperlink{lslogging_8c_ade1e95a32a49f0fd1b3e635c4d15ccd3}{LSLOGGING\_FILE\_NAME},
       \textcolor{stringliteral}{"w"});
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_a0e756b36671055ef02a8f04d2ba8a93b}{\index{pgpmac.\-h@{pgpmac.\-h}!lslogging\-\_\-log\-\_\-message@{lslogging\-\_\-log\-\_\-message}}
\index{lslogging\-\_\-log\-\_\-message@{lslogging\-\_\-log\-\_\-message}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lslogging\-\_\-log\-\_\-message}]{\setlength{\rightskip}{0pt plus 5cm}void lslogging\-\_\-log\-\_\-message (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{fmt, }
\item[{}]{...}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_a0e756b36671055ef02a8f04d2ba8a93b}


The routine everyone will be talking about. 


\begin{DoxyParams}{Parameters}
{\em fmt} & A printf style formating string. \\
\hline
{\em ...} & The arguments specified by fmt \\
\hline
\end{DoxyParams}


Definition at line 48 of file lslogging.\-c.


\begin{DoxyCode}
                                            \{
  \textcolor{keywordtype}{char} msg[\hyperlink{lslogging_8c_a0526e4aa12fbaf357fe315d6b3209c54}{LSLOGGING\_MSG\_LENGTH}];
  \textcolor{keyword}{struct }timespec theTime;
  va\_list arg\_ptr;
  \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} on;

  clock\_gettime( CLOCK\_REALTIME, &theTime);

  va\_start( arg\_ptr, fmt);
  vsnprintf( msg, \textcolor{keyword}{sizeof}(msg)-1, fmt, arg\_ptr);
  va\_end( arg\_ptr);
  msg[\textcolor{keyword}{sizeof}(msg)-1]=0;

  pthread\_mutex\_lock( &\hyperlink{lslogging_8c_a4a97ffe8731ae437f014ada051301be3}{lslogging\_mutex});
  
  on = (\hyperlink{lslogging_8c_a1f6e69ade57a17755e6b74a6286505df}{lslogging\_on}++) % \hyperlink{lslogging_8c_a5b1cb610bee26b000a2d64caa7d77a8d}{LSLOGGING\_QUEUE\_LENGTH}
      ;
  strncpy( \hyperlink{lslogging_8c_af98f94aec3e4501328da1b71f706c652}{lslogging\_queue}[on].lmsg, msg, \hyperlink{lslogging_8c_a0526e4aa12fbaf357fe315d6b3209c54}{LSLOGGING\_MSG\_LENGTH}
       - 1);
  \hyperlink{lslogging_8c_af98f94aec3e4501328da1b71f706c652}{lslogging\_queue}[on].\hyperlink{structlslogging__queue__struct_a5e83db0116b1289a84683ce48626d99d}{lmsg}[\hyperlink{lslogging_8c_a0526e4aa12fbaf357fe315d6b3209c54}{LSLOGGING\_MSG\_LENGTH}
      -1] = 0;
  
  memcpy( &(\hyperlink{lslogging_8c_af98f94aec3e4501328da1b71f706c652}{lslogging\_queue}[on].ltime), &theTime, \textcolor{keyword}{sizeof}(theTime
      ));

  pthread\_cond\_signal(  &\hyperlink{lslogging_8c_afa5f05c4337683edc3c88ab56aa5ea6f}{lslogging\_cond});
  pthread\_mutex\_unlock( &\hyperlink{lslogging_8c_a4a97ffe8731ae437f014ada051301be3}{lslogging\_mutex});
  
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_ad9f65252584e65957f461b809d59e3a2}{\index{pgpmac.\-h@{pgpmac.\-h}!lslogging\-\_\-run@{lslogging\-\_\-run}}
\index{lslogging\-\_\-run@{lslogging\-\_\-run}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lslogging\-\_\-run}]{\setlength{\rightskip}{0pt plus 5cm}void lslogging\-\_\-run (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_ad9f65252584e65957f461b809d59e3a2}


Start up the worker thread. 



Definition at line 105 of file lslogging.\-c.


\begin{DoxyCode}
                     \{
  pthread\_create( &\hyperlink{lslogging_8c_ad7629be92d1bec1c621b5cc0800f497f}{lslogging\_thread}, NULL, &\hyperlink{lslogging_8c_a33ec49aea69b5e4b1b551a34e7bacfca}{lslogging\_worker}
      , NULL);
  \hyperlink{lslogging_8c_a0e756b36671055ef02a8f04d2ba8a93b}{lslogging\_log\_message}( \textcolor{stringliteral}{"Start up"});
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_a4ee000bfeef9380d479464a9500af311}{\index{pgpmac.\-h@{pgpmac.\-h}!lspg\-\_\-array2ptrs@{lspg\-\_\-array2ptrs}}
\index{lspg\-\_\-array2ptrs@{lspg\-\_\-array2ptrs}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspg\-\_\-array2ptrs}]{\setlength{\rightskip}{0pt plus 5cm}char$\ast$$\ast$ lspg\-\_\-array2ptrs (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_a4ee000bfeef9380d479464a9500af311}


returns a null terminated list of strings parsed from postgresql array 



Definition at line 161 of file lspg.\-c.


\begin{DoxyCode}
                                 \{
  \textcolor{keywordtype}{char} **rtn, *sp, *acums;
  \textcolor{keywordtype}{int} \hyperlink{namespacemk__pgpmac__redis_afa643a23a5984fe44c2182ada3dfa401}{i}, n, inquote, havebackslash, rtni;;
  \textcolor{keywordtype}{int} mxsz;
  
  inquote       = 0;
  havebackslash = 0;

  \textcolor{comment}{// Despense with the null input condition before we complicate the code below}
  \textcolor{keywordflow}{if}( a == NULL || a[0] != \textcolor{charliteral}{'\{'} || a[strlen(a)-1] != \textcolor{charliteral}{'\}'})
    \textcolor{keywordflow}{return} NULL;

  \textcolor{comment}{// Count the maximum number of strings}
  \textcolor{comment}{// Actual number will be less if there are quoted commas}
  \textcolor{comment}{//}
  n = 1;
  \textcolor{keywordflow}{for}( i=0; a[\hyperlink{namespacemk__pgpmac__redis_afa643a23a5984fe44c2182ada3dfa401}{i}]; i++) \{
    \textcolor{keywordflow}{if}( a[i] == \textcolor{charliteral}{','})
      n++;
  \}
  \textcolor{comment}{//}
  \textcolor{comment}{// The maximum size of any string is the length of a (+1)}
  \textcolor{comment}{//}
  mxsz = strlen(a) + 1;

  \textcolor{comment}{// This is the accumulation string to make up the array elements}
  acums = (\textcolor{keywordtype}{char} *)calloc( mxsz, \textcolor{keyword}{sizeof}( \textcolor{keywordtype}{char}));
  \textcolor{keywordflow}{if}( acums == NULL) \{
    \hyperlink{lslogging_8c_a0e756b36671055ef02a8f04d2ba8a93b}{lslogging\_log\_message}( \textcolor{stringliteral}{"lspg\_array2ptrs: out of memory
       (acums)"});
    exit( 1);
  \}
  
  \textcolor{comment}{//}
  \textcolor{comment}{// allocate storage for the pointer array and the null terminator}
  \textcolor{comment}{//}
  rtn = (\textcolor{keywordtype}{char} **)calloc( n+1, \textcolor{keyword}{sizeof}( \textcolor{keywordtype}{char} *));
  \textcolor{keywordflow}{if}( rtn == NULL) \{
    \hyperlink{lslogging_8c_a0e756b36671055ef02a8f04d2ba8a93b}{lslogging\_log\_message}( \textcolor{stringliteral}{"lspg\_array2ptrs: out of memory
       (rtn)"});
    exit( 1);
  \}
  rtni = 0;
  
  \textcolor{comment}{// Go through and create the individual strings}
  sp = acums;
  *sp = 0;

  inquote = 0;
  havebackslash = 0;
  \textcolor{keywordflow}{for}( i=1; a[\hyperlink{namespacemk__pgpmac__redis_afa643a23a5984fe44c2182ada3dfa401}{i}] != 0; i++) \{
    \textcolor{keywordflow}{switch}( a[i]) \{
    \textcolor{keywordflow}{case} \textcolor{charliteral}{'"'}:
      \textcolor{keywordflow}{if}( havebackslash) \{
        \textcolor{comment}{// a quoted quote.  Cool}
        \textcolor{comment}{//}
        *(sp++) = a[i];
        *sp = 0;
        havebackslash = 0;
      \} \textcolor{keywordflow}{else} \{
        \textcolor{comment}{// Toggle the flag}
        inquote = 1 - inquote;
      \}
      \textcolor{keywordflow}{break};

    \textcolor{keywordflow}{case} \textcolor{charliteral}{'\(\backslash\)\(\backslash\)'}:
      \textcolor{keywordflow}{if}( havebackslash) \{
        *(sp++) = a[i];
        *sp = 0;
        havebackslash = 0;
      \} \textcolor{keywordflow}{else} \{
        havebackslash = 1;
      \}
      \textcolor{keywordflow}{break};

    \textcolor{keywordflow}{case} \textcolor{charliteral}{','}:
      \textcolor{keywordflow}{if}( inquote || havebackslash) \{
        *(sp++) = a[i];
        *sp = 0;
        havebackslash = 0;
      \} \textcolor{keywordflow}{else} \{
        rtn[rtni++] = strdup( acums);
        sp = acums;
      \}
      \textcolor{keywordflow}{break};
      
    \textcolor{keywordflow}{case} \textcolor{charliteral}{'\}'}:
      \textcolor{keywordflow}{if}( inquote || havebackslash) \{
        *(sp++) = a[i];
        *sp = 0;
        havebackslash = 0;
      \} \textcolor{keywordflow}{else} \{
        rtn[rtni++] = strdup( acums);
        rtn[rtni]   = NULL;
        free( acums);
        \textcolor{keywordflow}{return}( rtn);
      \}
      \textcolor{keywordflow}{break};

    \textcolor{keywordflow}{default}:
      *(sp++) = a[i];
      *sp = 0;
      havebackslash = 0;
    \}
  \}
  \textcolor{comment}{//}
  \textcolor{comment}{// Getting here means the final '\}' was missing}
  \textcolor{comment}{// Probably we should throw an error or log it or something.}
  \textcolor{comment}{// Through out the last entry since this there is not resonable expectation
       that}
  \textcolor{comment}{// we should be parsing it anyway.}
  \textcolor{comment}{//}
  rtn[rtni]   = NULL;
  free( acums);
  \textcolor{keywordflow}{return}( rtn);
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_aaf0ad72847ccb93694b3bdc649e6d1fc}{\index{pgpmac.\-h@{pgpmac.\-h}!lspg\-\_\-demandairrights\-\_\-all@{lspg\-\_\-demandairrights\-\_\-all}}
\index{lspg\-\_\-demandairrights\-\_\-all@{lspg\-\_\-demandairrights\-\_\-all}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspg\-\_\-demandairrights\-\_\-all}]{\setlength{\rightskip}{0pt plus 5cm}void lspg\-\_\-demandairrights\-\_\-all (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_aaf0ad72847ccb93694b3bdc649e6d1fc}


do nothing until we get airrights 



Definition at line 556 of file lspg.\-c.


\begin{DoxyCode}
                                \{
  \hyperlink{lspg_8c_ae3f3ae783042eb1f5f2c37b517b7404a}{lspg\_demandairrights\_call}();
  \hyperlink{lspg_8c_a96e3098f6f87fde74a83af96bf27a638}{lspg\_demandairrights\_wait}();
  \textcolor{comment}{// there is no "done" version}
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_a6f7cd0a06f6a266ef65b3604cf33d6c4}{\index{pgpmac.\-h@{pgpmac.\-h}!lspg\-\_\-getcenter\-\_\-call@{lspg\-\_\-getcenter\-\_\-call}}
\index{lspg\-\_\-getcenter\-\_\-call@{lspg\-\_\-getcenter\-\_\-call}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspg\-\_\-getcenter\-\_\-call}]{\setlength{\rightskip}{0pt plus 5cm}void lspg\-\_\-getcenter\-\_\-call (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_a6f7cd0a06f6a266ef65b3604cf33d6c4}


Request a getcenter query. 



Definition at line 1177 of file lspg.\-c.


\begin{DoxyCode}
                           \{
  pthread\_mutex\_lock( &\hyperlink{lspg_8c_a7ef8a09203117578c9b2ce4719519f36}{lspg\_getcenter}.\hyperlink{structlspg__getcenter__struct_a214bb7e88b137162f13f41f2c43002a9}{mutex});
  \hyperlink{lspg_8c_a7ef8a09203117578c9b2ce4719519f36}{lspg\_getcenter}.\hyperlink{structlspg__getcenter__struct_a4b350f11f1e375b9e9e839caaffbcb6b}{new\_value\_ready} = 0;
  pthread\_mutex\_unlock( &\hyperlink{lspg_8c_a7ef8a09203117578c9b2ce4719519f36}{lspg\_getcenter}.\hyperlink{structlspg__getcenter__struct_a214bb7e88b137162f13f41f2c43002a9}{mutex});

  \hyperlink{kvredis_8c_a0bb9ef42da8fa21c4df48ec384ab69f4}{lspg\_query\_push}( \hyperlink{lspg_8c_a8184824f2b71b1d35141d7922ca69cd7}{lspg\_getcenter\_cb}, \textcolor{stringliteral}{"SELECT *
       FROM px.getcenter2()"});
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_a7c678553b44c874d08ec9966ed7bb1c0}{\index{pgpmac.\-h@{pgpmac.\-h}!lspg\-\_\-getcenter\-\_\-done@{lspg\-\_\-getcenter\-\_\-done}}
\index{lspg\-\_\-getcenter\-\_\-done@{lspg\-\_\-getcenter\-\_\-done}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspg\-\_\-getcenter\-\_\-done}]{\setlength{\rightskip}{0pt plus 5cm}void lspg\-\_\-getcenter\-\_\-done (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_a7c678553b44c874d08ec9966ed7bb1c0}


Done with getcenter query. 



Definition at line 1195 of file lspg.\-c.


\begin{DoxyCode}
                           \{
  pthread\_mutex\_unlock( &(\hyperlink{lspg_8c_a7ef8a09203117578c9b2ce4719519f36}{lspg\_getcenter}.\hyperlink{structlspg__getcenter__struct_a214bb7e88b137162f13f41f2c43002a9}{mutex}));
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_a3e0e4b3cb9fa03961ee0c104e0b06754}{\index{pgpmac.\-h@{pgpmac.\-h}!lspg\-\_\-getcenter\-\_\-wait@{lspg\-\_\-getcenter\-\_\-wait}}
\index{lspg\-\_\-getcenter\-\_\-wait@{lspg\-\_\-getcenter\-\_\-wait}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspg\-\_\-getcenter\-\_\-wait}]{\setlength{\rightskip}{0pt plus 5cm}void lspg\-\_\-getcenter\-\_\-wait (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_a3e0e4b3cb9fa03961ee0c104e0b06754}


Wait for a getcenter query to return. 



Definition at line 1187 of file lspg.\-c.


\begin{DoxyCode}
                           \{
  pthread\_mutex\_lock( &(\hyperlink{lspg_8c_a7ef8a09203117578c9b2ce4719519f36}{lspg\_getcenter}.\hyperlink{structlspg__getcenter__struct_a214bb7e88b137162f13f41f2c43002a9}{mutex}));
  \textcolor{keywordflow}{while}( \hyperlink{lspg_8c_a7ef8a09203117578c9b2ce4719519f36}{lspg\_getcenter}.\hyperlink{structlspg__getcenter__struct_a4b350f11f1e375b9e9e839caaffbcb6b}{new\_value\_ready} == 0)
    pthread\_cond\_wait( &(\hyperlink{lspg_8c_a7ef8a09203117578c9b2ce4719519f36}{lspg\_getcenter}.\hyperlink{structlspg__getcenter__struct_ae0db0ff2608ab5ba3e7c1b4ad3fc0e91}{cond}), &(
      \hyperlink{lspg_8c_a7ef8a09203117578c9b2ce4719519f36}{lspg\_getcenter}.\hyperlink{structlspg__getcenter__struct_a214bb7e88b137162f13f41f2c43002a9}{mutex}));
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_a2d624b228ddd560ace0cef4286a30b07}{\index{pgpmac.\-h@{pgpmac.\-h}!lspg\-\_\-getcurrentsampleid\-\_\-wait\-\_\-for\-\_\-id@{lspg\-\_\-getcurrentsampleid\-\_\-wait\-\_\-for\-\_\-id}}
\index{lspg\-\_\-getcurrentsampleid\-\_\-wait\-\_\-for\-\_\-id@{lspg\-\_\-getcurrentsampleid\-\_\-wait\-\_\-for\-\_\-id}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspg\-\_\-getcurrentsampleid\-\_\-wait\-\_\-for\-\_\-id}]{\setlength{\rightskip}{0pt plus 5cm}void lspg\-\_\-getcurrentsampleid\-\_\-wait\-\_\-for\-\_\-id (
\begin{DoxyParamCaption}
\item[{unsigned int}]{test}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_a2d624b228ddd560ace0cef4286a30b07}


Definition at line 393 of file lspg.\-c.


\begin{DoxyCode}
                                                             \{
  pthread\_mutex\_lock( &\hyperlink{lspg_8c_a5c50804e6019d47d91f3f1cb3ebd1f00}{lspg\_getcurrentsampleid}.\hyperlink{structlspg__getcurrentsampleid__struct_ace54acbdcbce620437962858ba04e256}{mutex}
      );
  \textcolor{keywordflow}{while}( \hyperlink{lspg_8c_a5c50804e6019d47d91f3f1cb3ebd1f00}{lspg\_getcurrentsampleid}.\hyperlink{structlspg__getcurrentsampleid__struct_af629de1e076fd6763bccea3547ef24e7}{getcurrentsampleid}
       != test)
    pthread\_cond\_wait( &\hyperlink{lspg_8c_a5c50804e6019d47d91f3f1cb3ebd1f00}{lspg\_getcurrentsampleid}.\hyperlink{structlspg__getcurrentsampleid__struct_a289960e45fdc9339a05dc8607f1b7563}{cond}
      , &\hyperlink{lspg_8c_a5c50804e6019d47d91f3f1cb3ebd1f00}{lspg\_getcurrentsampleid}.\hyperlink{structlspg__getcurrentsampleid__struct_ace54acbdcbce620437962858ba04e256}{mutex});
    
  pthread\_mutex\_unlock( &\hyperlink{lspg_8c_a5c50804e6019d47d91f3f1cb3ebd1f00}{lspg\_getcurrentsampleid}.\hyperlink{structlspg__getcurrentsampleid__struct_ace54acbdcbce620437962858ba04e256}{mutex}
      );
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_a8a77972df14166e05c94ed0792baa09b}{\index{pgpmac.\-h@{pgpmac.\-h}!lspg\-\_\-init@{lspg\-\_\-init}}
\index{lspg\-\_\-init@{lspg\-\_\-init}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspg\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}void lspg\-\_\-init (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_a8a77972df14166e05c94ed0792baa09b}


Initiallize the lspg module. 



Definition at line 1758 of file lspg.\-c.


\begin{DoxyCode}
                 \{
  pthread\_mutex\_init( &\hyperlink{lspg_8c_aed46a94106c583796e3a8ca0e89aa8e4}{lspg\_queue\_mutex}, NULL);
  pthread\_cond\_init( &\hyperlink{lspg_8c_a61a308b6a37afd645beb422653b95baa}{lspg\_queue\_cond}, NULL);

  \hyperlink{lspg_8c_a61e47be0d5d7154700e7e5edb889852e}{lspg\_demandairrights\_init}();
  \hyperlink{lspg_8c_ad31db17587a02302ac4e40fb7d260b1b}{lspg\_getcenter\_init}();
  \hyperlink{lspg_8c_a5d6f6c4733629fc14e4f0bc128a1ffb7}{lspg\_getcurrentsampleid\_init}();
  \hyperlink{lspg_8c_a0e9bbf847dadfe0d10830d67824d9be8}{lspg\_lock\_detector\_init}();
  \hyperlink{lspg_8c_a39bb94f8e0d47702b2b920a3dee61ebc}{lspg\_lock\_diffractometer\_init}();
  \hyperlink{lspg_8c_a2faa901ea0a8ef00cfd93a893b34b446}{lspg\_nextsample\_init}();
  \hyperlink{lspg_8c_aff91db7d60e6c832684c023813e36dbf}{lspg\_nextshot\_init}();
  \hyperlink{lspg_8c_a31823ecb2b44d4a6674f804059a27bce}{lspg\_seq\_run\_prep\_init}();
  \hyperlink{lspg_8c_ab98f7d254fa0f5f4826f9427ca8b4f03}{lspg\_starttransfer\_init}();
  \hyperlink{lspg_8c_a3517f8fbed91c998f6036284f9bd0c48}{lspg\_wait\_for\_detector\_init}();
  \hyperlink{lspg_8c_a32b2bf00d66ee5fca130ee616a09cf7b}{lspg\_waitcryo\_init}();
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_a4cc866393eda0cf20276d035f6fbe206}{\index{pgpmac.\-h@{pgpmac.\-h}!lspg\-\_\-nextsample\-\_\-all@{lspg\-\_\-nextsample\-\_\-all}}
\index{lspg\-\_\-nextsample\-\_\-all@{lspg\-\_\-nextsample\-\_\-all}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspg\-\_\-nextsample\-\_\-all}]{\setlength{\rightskip}{0pt plus 5cm}unsigned int lspg\-\_\-nextsample\-\_\-all (
\begin{DoxyParamCaption}
\item[{int $\ast$}]{err}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_a4cc866393eda0cf20276d035f6fbe206}


Definition at line 468 of file lspg.\-c.


\begin{DoxyCode}
                                            \{
  \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} rtn;

  \hyperlink{lspg_8c_aab1c441d22126ea4334b3c61b7e4b4c2}{lspg\_nextsample\_call}();
  \hyperlink{lspg_8c_a32878d3d29f4595d1d2b861d7e871726}{lspg\_nextsample\_wait}();

  \textcolor{keywordflow}{if}( \hyperlink{lspg_8c_adbf70f382e469e02dce77833981f9547}{lspg\_nextsample}.\hyperlink{structlspg__nextsample__struct_aeee8110133db9f1895237ed9b54dd873}{no\_rows\_returned}) \{
    rtn = 0;
    *err = 1;
  \} \textcolor{keywordflow}{else} \{
    \textcolor{keywordflow}{if}( \hyperlink{lspg_8c_adbf70f382e469e02dce77833981f9547}{lspg\_nextsample}.\hyperlink{structlspg__nextsample__struct_a2ca6e2a667c9fe7f1a54329de04d2a3c}{nextsample\_isnull}) \{
      rtn = 0;
      *err = 1;
    \} \textcolor{keywordflow}{else} \{
      rtn = \hyperlink{lspg_8c_adbf70f382e469e02dce77833981f9547}{lspg\_nextsample}.\hyperlink{structlspg__nextsample__struct_aecd82b329462ae06bc2f0d162985a086}{nextsample};
      *err = 0;
    \}
  \}
  \hyperlink{lspg_8c_ac52207cc8f4c14494ae6f4972b6a3b23}{lspg\_nextsample\_done}();

  \textcolor{keywordflow}{return} rtn;
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_af17ef79544ca5d78fd477010fe90d538}{\index{pgpmac.\-h@{pgpmac.\-h}!lspg\-\_\-nextshot\-\_\-call@{lspg\-\_\-nextshot\-\_\-call}}
\index{lspg\-\_\-nextshot\-\_\-call@{lspg\-\_\-nextshot\-\_\-call}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspg\-\_\-nextshot\-\_\-call}]{\setlength{\rightskip}{0pt plus 5cm}void lspg\-\_\-nextshot\-\_\-call (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_af17ef79544ca5d78fd477010fe90d538}


Queue up a nextshot query. 



Definition at line 824 of file lspg.\-c.


\begin{DoxyCode}
                          \{
  pthread\_mutex\_lock( &(\hyperlink{lspg_8c_ad8d8e2f578ca79189a80c1fd5b60cefd}{lspg\_nextshot}.\hyperlink{structlspg__nextshot__struct_a38b657155fbee9b73278f76912cf2333}{mutex}));
  \hyperlink{lspg_8c_ad8d8e2f578ca79189a80c1fd5b60cefd}{lspg\_nextshot}.\hyperlink{structlspg__nextshot__struct_adb8da14444b98f556dba9420dd4666dc}{new\_value\_ready} = 0;
  pthread\_mutex\_unlock( &(\hyperlink{lspg_8c_ad8d8e2f578ca79189a80c1fd5b60cefd}{lspg\_nextshot}.\hyperlink{structlspg__nextshot__struct_a38b657155fbee9b73278f76912cf2333}{mutex}));
  
  \hyperlink{kvredis_8c_a0bb9ef42da8fa21c4df48ec384ab69f4}{lspg\_query\_push}( \hyperlink{lspg_8c_a9e92a204f606761d368ac7e06ef0f09c}{lspg\_nextshot\_cb}, \textcolor{stringliteral}{"SELECT *
       FROM px.nextshot2()"});
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_a50458a014041a4118452802dfb303960}{\index{pgpmac.\-h@{pgpmac.\-h}!lspg\-\_\-nextshot\-\_\-done@{lspg\-\_\-nextshot\-\_\-done}}
\index{lspg\-\_\-nextshot\-\_\-done@{lspg\-\_\-nextshot\-\_\-done}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspg\-\_\-nextshot\-\_\-done}]{\setlength{\rightskip}{0pt plus 5cm}void lspg\-\_\-nextshot\-\_\-done (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_a50458a014041a4118452802dfb303960}


Called when the next shot query has been processed. 



Definition at line 842 of file lspg.\-c.


\begin{DoxyCode}
                          \{
  pthread\_mutex\_unlock( &(\hyperlink{lspg_8c_ad8d8e2f578ca79189a80c1fd5b60cefd}{lspg\_nextshot}.\hyperlink{structlspg__nextshot__struct_a38b657155fbee9b73278f76912cf2333}{mutex}));
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_a784a6de32a86fec9efb3ef3ae4b6e3ac}{\index{pgpmac.\-h@{pgpmac.\-h}!lspg\-\_\-nextshot\-\_\-wait@{lspg\-\_\-nextshot\-\_\-wait}}
\index{lspg\-\_\-nextshot\-\_\-wait@{lspg\-\_\-nextshot\-\_\-wait}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspg\-\_\-nextshot\-\_\-wait}]{\setlength{\rightskip}{0pt plus 5cm}void lspg\-\_\-nextshot\-\_\-wait (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_a784a6de32a86fec9efb3ef3ae4b6e3ac}


Wait for the next shot query to get processed. 



Definition at line 834 of file lspg.\-c.


\begin{DoxyCode}
                          \{
  pthread\_mutex\_lock( &(\hyperlink{lspg_8c_ad8d8e2f578ca79189a80c1fd5b60cefd}{lspg\_nextshot}.\hyperlink{structlspg__nextshot__struct_a38b657155fbee9b73278f76912cf2333}{mutex}));
  \textcolor{keywordflow}{while}( \hyperlink{lspg_8c_ad8d8e2f578ca79189a80c1fd5b60cefd}{lspg\_nextshot}.\hyperlink{structlspg__nextshot__struct_adb8da14444b98f556dba9420dd4666dc}{new\_value\_ready} == 0)
    pthread\_cond\_wait( &(\hyperlink{lspg_8c_ad8d8e2f578ca79189a80c1fd5b60cefd}{lspg\_nextshot}.\hyperlink{structlspg__nextshot__struct_afc773a9eefc173aa98d5c2889e1d7669}{cond}), &(\hyperlink{lspg_8c_ad8d8e2f578ca79189a80c1fd5b60cefd}{lspg\_nextshot}
      .\hyperlink{structlspg__nextshot__struct_a38b657155fbee9b73278f76912cf2333}{mutex}));
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_a0bb9ef42da8fa21c4df48ec384ab69f4}{\index{pgpmac.\-h@{pgpmac.\-h}!lspg\-\_\-query\-\_\-push@{lspg\-\_\-query\-\_\-push}}
\index{lspg\-\_\-query\-\_\-push@{lspg\-\_\-query\-\_\-push}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspg\-\_\-query\-\_\-push}]{\setlength{\rightskip}{0pt plus 5cm}void lspg\-\_\-query\-\_\-push (
\begin{DoxyParamCaption}
\item[{void($\ast$)({\bf lspg\-\_\-query\-\_\-queue\-\_\-t} $\ast$, P\-Gresult $\ast$)}]{cb, }
\item[{char $\ast$}]{fmt, }
\item[{}]{...}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_a0bb9ef42da8fa21c4df48ec384ab69f4}


Place a query on the queue. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em cb} & Our callback function that deals with the response \\
\hline
\mbox{\tt in}  & {\em fmt} & Printf style function to generate the query \\
\hline
\end{DoxyParams}


Definition at line 234 of file kvredis.\-c.


\begin{DoxyCode}
                       \{
  \textcolor{keywordtype}{int} idx;
  va\_list arg\_ptr;


  \textcolor{comment}{//}
  \textcolor{comment}{// Pause the thread while we service the queue}
  \textcolor{comment}{//}
  \textcolor{keywordflow}{if}( (\hyperlink{kvredis_8c_a3cbe7f3161b3c1838ebc56a3bbcfd8a6}{lspg\_query\_queue\_on} + 1) % \hyperlink{kvredis_8c_a08fe83fe8226002ee8b80ce0a914fd11}{LS\_PG\_QUERY\_QUEUE\_LENGTH}
       == \hyperlink{kvredis_8c_aca86bb77d6cecfae9251743f4171bafb}{lspg\_query\_queue\_off} % \hyperlink{kvredis_8c_a08fe83fe8226002ee8b80ce0a914fd11}{LS\_PG\_QUERY\_QUEUE\_LENGTH}
      ) \{
    fprintf( stderr, \textcolor{stringliteral}{"lspg\_query\_push: queue is full.  Ignoring query \(\backslash\)"%s\(\backslash\)"\(\backslash\)n"}
      , fmt);
    \textcolor{keywordflow}{return};
  \}

  idx = \hyperlink{kvredis_8c_a3cbe7f3161b3c1838ebc56a3bbcfd8a6}{lspg\_query\_queue\_on} % \hyperlink{kvredis_8c_a08fe83fe8226002ee8b80ce0a914fd11}{LS\_PG\_QUERY\_QUEUE\_LENGTH}
      ;

  va\_start( arg\_ptr, fmt);
  vsnprintf( \hyperlink{kvredis_8c_a357d9d98f0b8c9625ccebcebfcdce955}{lspg\_query\_queue}[idx].qs, \hyperlink{kvredis_8c_a3a8ef1b4b5994d6dd12bf74454ea891b}{
      LS\_PG\_QUERY\_STRING\_LENGTH}-1, fmt, arg\_ptr);
  va\_end( arg\_ptr);

  \hyperlink{kvredis_8c_a357d9d98f0b8c9625ccebcebfcdce955}{lspg\_query\_queue}[idx].\hyperlink{structlspgQueryQueueStruct_a1389b3ec4ddf9ed5cc0344d229a7ff9e}{qs}[\hyperlink{kvredis_8c_a3a8ef1b4b5994d6dd12bf74454ea891b}{LS\_PG\_QUERY\_STRING\_LENGTH}
       - 1] = 0;
  \hyperlink{kvredis_8c_a357d9d98f0b8c9625ccebcebfcdce955}{lspg\_query\_queue}[idx].\hyperlink{structlspgQueryQueueStruct_a53bac5ae4cab775423940bff5092a831}{onResponse} = cb;
  \hyperlink{kvredis_8c_a3cbe7f3161b3c1838ebc56a3bbcfd8a6}{lspg\_query\_queue\_on}++;

\};
\end{DoxyCode}
\hypertarget{pgpmac_8h_a1adfdb5ca9fdb5060849d726bf540117}{\index{pgpmac.\-h@{pgpmac.\-h}!lspg\-\_\-run@{lspg\-\_\-run}}
\index{lspg\-\_\-run@{lspg\-\_\-run}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspg\-\_\-run}]{\setlength{\rightskip}{0pt plus 5cm}void lspg\-\_\-run (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_a1adfdb5ca9fdb5060849d726bf540117}


Start 'er runnin'. 



Definition at line 1777 of file lspg.\-c.


\begin{DoxyCode}
                \{
  pthread\_create( &\hyperlink{lspg_8c_a04eb0cda0d5e5afeae7c393b51689765}{lspg\_thread}, NULL, \hyperlink{lspg_8c_aaf4fadd2943fa3a2ecb5d840e84d68fa}{lspg\_worker}, NULL);
  \hyperlink{lsevents_8c_ab0617d3f0594b51d10e34bf397096654}{lsevents\_add\_listener}( \textcolor{stringliteral}{"Sample(Detected|Absent)"}, 
      \hyperlink{lspg_8c_aaba848ff514781cf8468cf23bc4d214f}{lspmac\_sample\_detector\_cb});
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_a4253474d4dd305aec0afdd5552b3ddd5}{\index{pgpmac.\-h@{pgpmac.\-h}!lspg\-\_\-seq\-\_\-run\-\_\-prep\-\_\-all@{lspg\-\_\-seq\-\_\-run\-\_\-prep\-\_\-all}}
\index{lspg\-\_\-seq\-\_\-run\-\_\-prep\-\_\-all@{lspg\-\_\-seq\-\_\-run\-\_\-prep\-\_\-all}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspg\-\_\-seq\-\_\-run\-\_\-prep\-\_\-all}]{\setlength{\rightskip}{0pt plus 5cm}void lspg\-\_\-seq\-\_\-run\-\_\-prep\-\_\-all (
\begin{DoxyParamCaption}
\item[{long long}]{skey, }
\item[{double}]{kappa, }
\item[{double}]{phi, }
\item[{double}]{cx, }
\item[{double}]{cy, }
\item[{double}]{ax, }
\item[{double}]{ay, }
\item[{double}]{az}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_a4253474d4dd305aec0afdd5552b3ddd5}


Convinence function to call seq run prep. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em skey} & px.\-shots key for this image \\
\hline
\mbox{\tt in}  & {\em kappa} & current kappa postion \\
\hline
\mbox{\tt in}  & {\em phi} & current phi postition \\
\hline
\mbox{\tt in}  & {\em cx} & current center table x \\
\hline
\mbox{\tt in}  & {\em cy} & current center table y \\
\hline
\mbox{\tt in}  & {\em ax} & current alignment table x \\
\hline
\mbox{\tt in}  & {\em ay} & current alignment table y \\
\hline
\mbox{\tt in}  & {\em az} & current alignment table z \\
\hline
\end{DoxyParams}


Definition at line 1095 of file lspg.\-c.


\begin{DoxyCode}
                             \{
  \hyperlink{lspg_8c_af7d6efd861b152a371442791deb42bd3}{lspg\_seq\_run\_prep\_call}( skey, \hyperlink{lspmac_8c_a0be79ccb7ebf3a665248fd856112b9fd}{kappa}, \hyperlink{lspmac_8c_ac8070dc568ad974a3db42b51eca828cc}{phi}, cx, 
      cy, ax, ay, az);
  \hyperlink{lspg_8c_ac0b01f501322432a8fa37f31898c3499}{lspg\_seq\_run\_prep\_wait}();
  \hyperlink{lspg_8c_a472b09ddf716c80207f97e2bb5d37d66}{lspg\_seq\_run\_prep\_done}();
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_af72c4b037347737df09348ab703f6802}{\index{pgpmac.\-h@{pgpmac.\-h}!lspg\-\_\-starttransfer\-\_\-call@{lspg\-\_\-starttransfer\-\_\-call}}
\index{lspg\-\_\-starttransfer\-\_\-call@{lspg\-\_\-starttransfer\-\_\-call}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspg\-\_\-starttransfer\-\_\-call}]{\setlength{\rightskip}{0pt plus 5cm}void lspg\-\_\-starttransfer\-\_\-call (
\begin{DoxyParamCaption}
\item[{unsigned int}]{nextsample, }
\item[{int}]{sample\-\_\-detected, }
\item[{double}]{ax, }
\item[{double}]{ay, }
\item[{double}]{az, }
\item[{double}]{horz, }
\item[{double}]{vert, }
\item[{double}]{esttime}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_af72c4b037347737df09348ab703f6802}


Definition at line 302 of file lspg.\-c.


\begin{DoxyCode}
                                                                               
                                                                              \{
  pthread\_mutex\_lock( &(\hyperlink{lspg_8c_af18499d17171eff473cfc49d4a0a5562}{lspg\_starttransfer}.\hyperlink{structlspg__starttransfer__struct_a47824bb2701a699d43a7a916e2010705}{mutex}));
  \hyperlink{lspg_8c_af18499d17171eff473cfc49d4a0a5562}{lspg\_starttransfer}.\hyperlink{structlspg__starttransfer__struct_ad3a6356e5ccce15c982ddecf9634999f}{new\_value\_ready} = 0;
  pthread\_mutex\_unlock( &(\hyperlink{lspg_8c_af18499d17171eff473cfc49d4a0a5562}{lspg\_starttransfer}.\hyperlink{structlspg__starttransfer__struct_a47824bb2701a699d43a7a916e2010705}{mutex}));

  \hyperlink{kvredis_8c_a0bb9ef42da8fa21c4df48ec384ab69f4}{lspg\_query\_push}( \hyperlink{lspg_8c_a289005bed571909f5ce4de2ff4e70e36}{lspg\_starttransfer\_cb}, \textcolor{stringliteral}{"
      SELECT px.starttransfer( %d, %d, %.3f, %.3f, %.3f, %.3f, %.3f, %.3f"},
                   nextsample, \hyperlink{lspmac_8c_ac59ab990e48033a811aeb0281fb588fc}{sample\_detected}, ax, ay, az, horz
      , vert, esttime);
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_ad989179281d8b65b940250a4580007d0}{\index{pgpmac.\-h@{pgpmac.\-h}!lspg\-\_\-starttransfer\-\_\-done@{lspg\-\_\-starttransfer\-\_\-done}}
\index{lspg\-\_\-starttransfer\-\_\-done@{lspg\-\_\-starttransfer\-\_\-done}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspg\-\_\-starttransfer\-\_\-done}]{\setlength{\rightskip}{0pt plus 5cm}void lspg\-\_\-starttransfer\-\_\-done (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_ad989179281d8b65b940250a4580007d0}


Definition at line 317 of file lspg.\-c.


\begin{DoxyCode}
                               \{
  pthread\_mutex\_unlock( &(\hyperlink{lspg_8c_af18499d17171eff473cfc49d4a0a5562}{lspg\_starttransfer}.\hyperlink{structlspg__starttransfer__struct_a47824bb2701a699d43a7a916e2010705}{mutex}));
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_a189e9fd5cbc06dd09e5549f6e229fa5e}{\index{pgpmac.\-h@{pgpmac.\-h}!lspg\-\_\-starttransfer\-\_\-wait@{lspg\-\_\-starttransfer\-\_\-wait}}
\index{lspg\-\_\-starttransfer\-\_\-wait@{lspg\-\_\-starttransfer\-\_\-wait}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspg\-\_\-starttransfer\-\_\-wait}]{\setlength{\rightskip}{0pt plus 5cm}void lspg\-\_\-starttransfer\-\_\-wait (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_a189e9fd5cbc06dd09e5549f6e229fa5e}


Definition at line 311 of file lspg.\-c.


\begin{DoxyCode}
                               \{
  pthread\_mutex\_lock( &(\hyperlink{lspg_8c_af18499d17171eff473cfc49d4a0a5562}{lspg\_starttransfer}.\hyperlink{structlspg__starttransfer__struct_a47824bb2701a699d43a7a916e2010705}{mutex}));
  \textcolor{keywordflow}{while}( \hyperlink{lspg_8c_af18499d17171eff473cfc49d4a0a5562}{lspg\_starttransfer}.\hyperlink{structlspg__starttransfer__struct_ad3a6356e5ccce15c982ddecf9634999f}{new\_value\_ready} ==
       0)
    pthread\_cond\_wait( &(\hyperlink{lspg_8c_af18499d17171eff473cfc49d4a0a5562}{lspg\_starttransfer}.\hyperlink{structlspg__starttransfer__struct_a1a569a2afabd7910219ff9d2d48c1b38}{cond}), &(
      \hyperlink{lspg_8c_af18499d17171eff473cfc49d4a0a5562}{lspg\_starttransfer}.\hyperlink{structlspg__starttransfer__struct_a47824bb2701a699d43a7a916e2010705}{mutex}));
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_a67a44f70405c8b6a01cec6ac3d166efb}{\index{pgpmac.\-h@{pgpmac.\-h}!lspg\-\_\-waitcryo\-\_\-all@{lspg\-\_\-waitcryo\-\_\-all}}
\index{lspg\-\_\-waitcryo\-\_\-all@{lspg\-\_\-waitcryo\-\_\-all}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspg\-\_\-waitcryo\-\_\-all}]{\setlength{\rightskip}{0pt plus 5cm}void lspg\-\_\-waitcryo\-\_\-all (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_a67a44f70405c8b6a01cec6ac3d166efb}


no need to get fancy with the wait cryo command It should not return until the robot is almost ready for air rights 



Definition at line 507 of file lspg.\-c.


\begin{DoxyCode}
                         \{
  pthread\_mutex\_lock( &\hyperlink{lspg_8c_a5f699604dcc5d3d64fd6cb5c363d29c9}{lspg\_waitcryo}.\hyperlink{structlspg__waitcryo__struct_a62b50ead380fc8a6be35956eba384ba6}{mutex});
  \hyperlink{lspg_8c_a5f699604dcc5d3d64fd6cb5c363d29c9}{lspg\_waitcryo}.\hyperlink{structlspg__waitcryo__struct_a97298b773fd8c1f2ef20159093a08246}{new\_value\_ready} = 0;

  \hyperlink{kvredis_8c_a0bb9ef42da8fa21c4df48ec384ab69f4}{lspg\_query\_push}( \hyperlink{lspg_8c_a7497a7c924b31c727ea487a3efb77fb6}{lspg\_waitcryo\_cb}, \textcolor{stringliteral}{"SELECT
       px.waitcryo())"});

  \textcolor{keywordflow}{while}( \hyperlink{lspg_8c_a5f699604dcc5d3d64fd6cb5c363d29c9}{lspg\_waitcryo}.\hyperlink{structlspg__waitcryo__struct_a97298b773fd8c1f2ef20159093a08246}{new\_value\_ready} == 0)
    pthread\_cond\_wait( &\hyperlink{lspg_8c_a5f699604dcc5d3d64fd6cb5c363d29c9}{lspg\_waitcryo}.\hyperlink{structlspg__waitcryo__struct_a54c275159d9f096e0d1884e64d099298}{cond}, &\hyperlink{lspg_8c_a5f699604dcc5d3d64fd6cb5c363d29c9}{lspg\_waitcryo}
      .\hyperlink{structlspg__waitcryo__struct_a62b50ead380fc8a6be35956eba384ba6}{mutex});

  pthread\_mutex\_unlock( &\hyperlink{lspg_8c_a5f699604dcc5d3d64fd6cb5c363d29c9}{lspg\_waitcryo}.\hyperlink{structlspg__waitcryo__struct_a62b50ead380fc8a6be35956eba384ba6}{mutex});
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_a7497a7c924b31c727ea487a3efb77fb6}{\index{pgpmac.\-h@{pgpmac.\-h}!lspg\-\_\-waitcryo\-\_\-cb@{lspg\-\_\-waitcryo\-\_\-cb}}
\index{lspg\-\_\-waitcryo\-\_\-cb@{lspg\-\_\-waitcryo\-\_\-cb}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspg\-\_\-waitcryo\-\_\-cb}]{\setlength{\rightskip}{0pt plus 5cm}void lspg\-\_\-waitcryo\-\_\-cb (
\begin{DoxyParamCaption}
\item[{{\bf lspg\-\_\-query\-\_\-queue\-\_\-t} $\ast$}]{qqp, }
\item[{P\-Gresult $\ast$}]{pgr}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_a7497a7c924b31c727ea487a3efb77fb6}


Definition at line 497 of file lspg.\-c.


\begin{DoxyCode}
                                                               \{
  pthread\_mutex\_lock( &\hyperlink{lspg_8c_a5f699604dcc5d3d64fd6cb5c363d29c9}{lspg\_waitcryo}.\hyperlink{structlspg__waitcryo__struct_a62b50ead380fc8a6be35956eba384ba6}{mutex});
  \hyperlink{lspg_8c_a5f699604dcc5d3d64fd6cb5c363d29c9}{lspg\_waitcryo}.\hyperlink{structlspg__waitcryo__struct_a97298b773fd8c1f2ef20159093a08246}{new\_value\_ready} = 1;
  pthread\_cond\_signal( &\hyperlink{lspg_8c_a5f699604dcc5d3d64fd6cb5c363d29c9}{lspg\_waitcryo}.\hyperlink{structlspg__waitcryo__struct_a54c275159d9f096e0d1884e64d099298}{cond});
  pthread\_mutex\_unlock( &\hyperlink{lspg_8c_a5f699604dcc5d3d64fd6cb5c363d29c9}{lspg\_waitcryo}.\hyperlink{structlspg__waitcryo__struct_a62b50ead380fc8a6be35956eba384ba6}{mutex});
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_a95e3fd7c1685d7e6ab6d0a295ab42f78}{\index{pgpmac.\-h@{pgpmac.\-h}!lspg\-\_\-zoom\-\_\-lut\-\_\-call@{lspg\-\_\-zoom\-\_\-lut\-\_\-call}}
\index{lspg\-\_\-zoom\-\_\-lut\-\_\-call@{lspg\-\_\-zoom\-\_\-lut\-\_\-call}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspg\-\_\-zoom\-\_\-lut\-\_\-call}]{\setlength{\rightskip}{0pt plus 5cm}void lspg\-\_\-zoom\-\_\-lut\-\_\-call (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_a95e3fd7c1685d7e6ab6d0a295ab42f78}
\hypertarget{pgpmac_8h_ac4bf3a54deeaeb6e93dc3183388ad104}{\index{pgpmac.\-h@{pgpmac.\-h}!lspmac\-\_\-get\-B\-I\-Position@{lspmac\-\_\-get\-B\-I\-Position}}
\index{lspmac\-\_\-get\-B\-I\-Position@{lspmac\-\_\-get\-B\-I\-Position}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspmac\-\_\-get\-B\-I\-Position}]{\setlength{\rightskip}{0pt plus 5cm}int lspmac\-\_\-get\-B\-I\-Position (
\begin{DoxyParamCaption}
\item[{{\bf lspmac\-\_\-bi\-\_\-t} $\ast$}]{}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_ac4bf3a54deeaeb6e93dc3183388ad104}


get binary input value 



Definition at line 1565 of file lspmac.\-c.


\begin{DoxyCode}
                                            \{
  \textcolor{keywordtype}{int} rtn;
  pthread\_mutex\_lock( &bip->mutex);
  rtn = bip->position;
  pthread\_mutex\_unlock( &bip->mutex);
  \textcolor{keywordflow}{return} rtn;
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_a6a1b639686b771c1213b6e23716a7898}{\index{pgpmac.\-h@{pgpmac.\-h}!lspmac\-\_\-get\-Position@{lspmac\-\_\-get\-Position}}
\index{lspmac\-\_\-get\-Position@{lspmac\-\_\-get\-Position}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspmac\-\_\-get\-Position}]{\setlength{\rightskip}{0pt plus 5cm}double lspmac\-\_\-get\-Position (
\begin{DoxyParamCaption}
\item[{{\bf lspmac\-\_\-motor\-\_\-t} $\ast$}]{mp}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_a6a1b639686b771c1213b6e23716a7898}


get the motor position (with locking) 


\begin{DoxyParams}{Parameters}
{\em mp} & the motor object \\
\hline
\end{DoxyParams}


Definition at line 1336 of file lspmac.\-c.


\begin{DoxyCode}
                                               \{
  \textcolor{keywordtype}{double} rtn;
  pthread\_mutex\_lock( &(mp->\hyperlink{structlspmac__motor__struct_a188c5b1e991750ce2ffd53e0192e0907}{mutex}));
  rtn = mp->\hyperlink{structlspmac__motor__struct_af8ffb3aed907d8664b65b37601954411}{position};
  pthread\_mutex\_unlock( &(mp->\hyperlink{structlspmac__motor__struct_a188c5b1e991750ce2ffd53e0192e0907}{mutex}));
  \textcolor{keywordflow}{return} rtn;
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_a9fbadf816a842c8f131cf8ee47b54e29}{\index{pgpmac.\-h@{pgpmac.\-h}!lspmac\-\_\-home1\-\_\-queue@{lspmac\-\_\-home1\-\_\-queue}}
\index{lspmac\-\_\-home1\-\_\-queue@{lspmac\-\_\-home1\-\_\-queue}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspmac\-\_\-home1\-\_\-queue}]{\setlength{\rightskip}{0pt plus 5cm}void lspmac\-\_\-home1\-\_\-queue (
\begin{DoxyParamCaption}
\item[{{\bf lspmac\-\_\-motor\-\_\-t} $\ast$}]{mp}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_a9fbadf816a842c8f131cf8ee47b54e29}


Home the motor. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em mp} & motor we are concerned about \\
\hline
\end{DoxyParams}


Definition at line 1203 of file lspmac.\-c.


\begin{DoxyCode}
                          \{
  \textcolor{keywordtype}{int} \hyperlink{namespacemk__pgpmac__redis_afa643a23a5984fe44c2182ada3dfa401}{i};
  \textcolor{keywordtype}{int} motor\_num;
  \textcolor{keywordtype}{int} coord\_num;
  \textcolor{keywordtype}{char} **home;

  pthread\_mutex\_lock( &(mp->\hyperlink{structlspmac__motor__struct_a188c5b1e991750ce2ffd53e0192e0907}{mutex}));

  motor\_num = \hyperlink{lsredis_8c_a1923f998441f4f451204dfd214d52218}{lsredis\_getl}( mp->\hyperlink{structlspmac__motor__struct_ad6a51cca3c7e5f79168e5c33fd9e736b}{motor\_num});
  coord\_num = \hyperlink{lsredis_8c_a1923f998441f4f451204dfd214d52218}{lsredis\_getl}( mp->\hyperlink{structlspmac__motor__struct_a5614e003272e8323f8809bf7b6559532}{coord\_num});
  home      = \hyperlink{lsredis_8c_abe31d0e11c41b2235307612c963bb652}{lsredis\_get\_string\_array}( mp->\hyperlink{structlspmac__motor__struct_a6dc1ceab86687f741d4c4a574501959c}{home});
  
  \textcolor{comment}{// Each of the motors should have this defined}
  \textcolor{comment}{// but let's not seg fault if home is missing}
  \textcolor{comment}{//}
  \textcolor{keywordflow}{if}( home == NULL || *home == NULL) \{
    \textcolor{comment}{//}
    \textcolor{comment}{// Note we are already initialized}
    \textcolor{comment}{// so if we are here there is something wrong.}
    \textcolor{comment}{//}
    \hyperlink{lslogging_8c_a0e756b36671055ef02a8f04d2ba8a93b}{lslogging\_log\_message}( \textcolor{stringliteral}{"lspmac\_home1\_queue: null or
       empty home strings for motor %s"}, mp->\hyperlink{structlspmac__motor__struct_aa90af2f6f1489f1befe1d0891e51575a}{name});
    pthread\_mutex\_unlock( &(mp->\hyperlink{structlspmac__motor__struct_a188c5b1e991750ce2ffd53e0192e0907}{mutex}));
    \textcolor{keywordflow}{return};
  \}

  \textcolor{comment}{// We've already been called.  Don't home again until}
  \textcolor{comment}{// we're finish with the last time.}
  \textcolor{comment}{//}
  \textcolor{keywordflow}{if}( mp->\hyperlink{structlspmac__motor__struct_aa74108855693f94fc2ff76333c9fb6ac}{homing}) \{
    pthread\_mutex\_unlock( &(mp->\hyperlink{structlspmac__motor__struct_a188c5b1e991750ce2ffd53e0192e0907}{mutex}));
    \textcolor{keywordflow}{return};
  \}    


  \textcolor{comment}{//}
  \textcolor{comment}{// Don't go on if any other motors in this coordinate system are homing.}
  \textcolor{comment}{// It's possible to write the homing program to home all the motors in the
       coordinate}
  \textcolor{comment}{// system.  TODO  (hint hint)}
  \textcolor{comment}{//}
  \textcolor{keywordflow}{if}( coord\_num > 0) \{
    \textcolor{keywordflow}{for}( i=0; i<\hyperlink{lspmac_8c_a56260f012c50a591ee7f97e500f16994}{lspmac\_nmotors}; i++) \{
      \textcolor{keywordflow}{if}( &(\hyperlink{lspmac_8c_a894c709ddd0652583d6db22e86282503}{lspmac\_motors}[i]) == mp)
        \textcolor{keywordflow}{continue};
      \textcolor{keywordflow}{if}( \hyperlink{lsredis_8c_a1923f998441f4f451204dfd214d52218}{lsredis\_getl}(\hyperlink{lspmac_8c_a894c709ddd0652583d6db22e86282503}{lspmac\_motors}[i].coord\_num) == 
      coord\_num) \{
        \textcolor{keywordtype}{int} nogo;
        nogo = 0;
        pthread\_mutex\_lock( &(\hyperlink{lspmac_8c_a894c709ddd0652583d6db22e86282503}{lspmac\_motors}[i].mutex));
        \textcolor{comment}{//}
        \textcolor{comment}{//  Don't go on if}
        \textcolor{comment}{//}
        \textcolor{comment}{//    we are homing         or      ( not in position               
       while     in open loop)}
        \textcolor{comment}{//}
        \textcolor{keywordflow}{if}( \hyperlink{lspmac_8c_a894c709ddd0652583d6db22e86282503}{lspmac\_motors}[i].homing || (((\hyperlink{lspmac_8c_a894c709ddd0652583d6db22e86282503}{lspmac\_motors}
      [i].status2 & 0x01)==0) && ((\hyperlink{lspmac_8c_a894c709ddd0652583d6db22e86282503}{lspmac\_motors}[i].status1 & 0x040000) 
      != 0)))
          nogo = 1;
        pthread\_mutex\_unlock( &(\hyperlink{lspmac_8c_a894c709ddd0652583d6db22e86282503}{lspmac\_motors}[i].mutex));
        \textcolor{keywordflow}{if}( nogo) \{
          pthread\_mutex\_unlock( &(mp->\hyperlink{structlspmac__motor__struct_a188c5b1e991750ce2ffd53e0192e0907}{mutex}));
          \textcolor{keywordflow}{return};
        \}
      \}
    \}
  \}
  mp->\hyperlink{structlspmac__motor__struct_aa74108855693f94fc2ff76333c9fb6ac}{homing}   = 1;
  mp->\hyperlink{structlspmac__motor__struct_ab7bd8bff48953ce05c758598d75877ac}{not\_done} = 1;     \textcolor{comment}{// set up waiting for cond}
  mp->\hyperlink{structlspmac__motor__struct_a68c471836f52707fa8582f7860cf500f}{motion\_seen} = 0;
  \textcolor{comment}{// This opens the control loop.}
  \textcolor{comment}{// The status routine should notice this and the fact that}
  \textcolor{comment}{// the homing flag is set and call on the home2 routine}
  \textcolor{comment}{//}
  \textcolor{comment}{// Only send the open loop command if we are not in}
  \textcolor{comment}{// open loop mode already.  This test might prevent a race condition}
  \textcolor{comment}{// where we've already moved the home2 routine (and queue the homing program
       motion)}
  \textcolor{comment}{// before the open loop command is dequeued and acted on.}
  \textcolor{comment}{//}
  \textcolor{keywordflow}{if}( ~(mp->\hyperlink{structlspmac__motor__struct_acb52b612b9237e8eec0b97fb1e76a35d}{status1}) & 0x040000) \{
    \hyperlink{lspmac_8c_afab9e8f0502a92ee5cf93209af710f81}{lspmac\_SockSendDPline}( mp->\hyperlink{structlspmac__motor__struct_aa90af2f6f1489f1befe1d0891e51575a}{name}, \textcolor{stringliteral}{"#%d$*"}, 
      motor\_num);
  \}

  pthread\_mutex\_unlock( &(mp->\hyperlink{structlspmac__motor__struct_a188c5b1e991750ce2ffd53e0192e0907}{mutex}));
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_ae3e30b0ba9b5d5a291fa29b77ba920d8}{\index{pgpmac.\-h@{pgpmac.\-h}!lspmac\-\_\-init@{lspmac\-\_\-init}}
\index{lspmac\-\_\-init@{lspmac\-\_\-init}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspmac\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}void lspmac\-\_\-init (
\begin{DoxyParamCaption}
\item[{int}]{, }
\item[{int}]{}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_ae3e30b0ba9b5d5a291fa29b77ba920d8}


Initialize this module. 



Definition at line 2891 of file lspmac.\-c.


\begin{DoxyCode}
                   \{
  \hyperlink{structmd2StatusStruct}{md2\_status\_t} *\hyperlink{namespacemk__pgpmac__redis_a11daf2847f2dc94562b5b61b3f412574}{p};

  \textcolor{comment}{// Set our global harvest flags}
  \hyperlink{lspmac_8c_a07b7b8254772075e6a4ced500b589c36}{getivars} = ivarsflag;
  \hyperlink{lspmac_8c_a50e9c0a06654fd81b3446a6e54ff12c3}{getmvars} = mvarsflag;

  \textcolor{comment}{// All important status mutex}
  pthread\_mutex\_init( &\hyperlink{lspmac_8c_a7a3e763682bd7f987d07f149e94b3bf8}{md2\_status\_mutex}, NULL);

  \textcolor{comment}{//}
  \textcolor{comment}{// Get the MD2 initialization strings}
  \textcolor{comment}{//}
  \hyperlink{lspmac_8c_a45e8803dd459ea079a96fcbfb4709885}{lspmac\_md2\_init} = \hyperlink{lsredis_8c_ad3bb3ebbae1ffbd03e062ecdd663cc6a}{lsredis\_get\_obj}( \textcolor{stringliteral}{"
      md2\_pmac.init"});

  \textcolor{comment}{//}
  \textcolor{comment}{// Initialize the motor objects}
  \textcolor{comment}{//}

  p = &\hyperlink{lspmac_8c_ad5bce7451d48127bace5af445d03b492}{md2\_status};

  \hyperlink{lspmac_8c_a8237e646ce032a840637a4ef7bff49b9}{omega}  = \hyperlink{lspmac_8c_a95c0a2d36e4e2a0f170fcf3583e7c422}{lspmac\_motor\_init}( &(\hyperlink{lspmac_8c_a894c709ddd0652583d6db22e86282503}{lspmac\_motors}
      [ 0]), 0, 0, &p->\hyperlink{structmd2StatusStruct_a6ce303bec89082cae1e9b1fddf6b6c10}{omega\_act\_pos},     &p->\hyperlink{structmd2StatusStruct_af6cf3cd65b9ef205685a0d970f168907}{omega\_status\_1}
      ,     &p->\hyperlink{structmd2StatusStruct_a8577c9df7b663b548b2759ac3db721cd}{omega\_status\_2},     \textcolor{stringliteral}{"Omega   #1 &1 A"}, \textcolor{stringliteral}{"omega"},       
      \hyperlink{lspmac_8c_aa4ea5a4c387ef167702c58eaddcb4151}{lspmac\_moveabs\_queue});
  \hyperlink{lspmac_8c_a6cb218bdccfe5a93471c161f15a15cab}{alignx} = \hyperlink{lspmac_8c_a95c0a2d36e4e2a0f170fcf3583e7c422}{lspmac\_motor\_init}( &(\hyperlink{lspmac_8c_a894c709ddd0652583d6db22e86282503}{lspmac\_motors}
      [ 1]), 0, 1, &p->\hyperlink{structmd2StatusStruct_a9653a75bc0b66c5f86d8b0206dc39b4f}{alignx\_act\_pos},    &p->\hyperlink{structmd2StatusStruct_a56accf8cb00c59bff87ed75df7dafbbe}{alignx\_status\_1}
      ,    &p->\hyperlink{structmd2StatusStruct_a2feb35ceab8129fd2cc34d1104af8b8f}{alignx\_status\_2},    \textcolor{stringliteral}{"Align X #2 &3 X"}, \textcolor{stringliteral}{"align.x"},     
      \hyperlink{lspmac_8c_aa4ea5a4c387ef167702c58eaddcb4151}{lspmac\_moveabs\_queue});
  \hyperlink{lspmac_8c_a737c246c3948e644a18d191a931e1acd}{aligny} = \hyperlink{lspmac_8c_a95c0a2d36e4e2a0f170fcf3583e7c422}{lspmac\_motor\_init}( &(\hyperlink{lspmac_8c_a894c709ddd0652583d6db22e86282503}{lspmac\_motors}
      [ 2]), 0, 2, &p->\hyperlink{structmd2StatusStruct_a0d40a01d2aa93c443526e826440f77fc}{aligny\_act\_pos},    &p->\hyperlink{structmd2StatusStruct_a2f2a11fe2fc7a446323def2be465185a}{aligny\_status\_1}
      ,    &p->\hyperlink{structmd2StatusStruct_a1f98d8b9831e32d77129f9b0f1d7d255}{aligny\_status\_2},    \textcolor{stringliteral}{"Align Y #3 &3 Y"}, \textcolor{stringliteral}{"align.y"},     
      \hyperlink{lspmac_8c_aa4ea5a4c387ef167702c58eaddcb4151}{lspmac\_moveabs\_queue});
  \hyperlink{lspmac_8c_ae7642b1da0f7c7f8448104c691d40a12}{alignz} = \hyperlink{lspmac_8c_a95c0a2d36e4e2a0f170fcf3583e7c422}{lspmac\_motor\_init}( &(\hyperlink{lspmac_8c_a894c709ddd0652583d6db22e86282503}{lspmac\_motors}
      [ 3]), 0, 3, &p->\hyperlink{structmd2StatusStruct_a480f892fe91b05b2980fb00064807e2b}{alignz\_act\_pos},    &p->\hyperlink{structmd2StatusStruct_aadbfac5709de57e449a37e2937d6ade7}{alignz\_status\_1}
      ,    &p->\hyperlink{structmd2StatusStruct_ac378da16eeaab2bc47f3f8f88f7411ed}{alignz\_status\_2},    \textcolor{stringliteral}{"Align Z #4 &3 Z"}, \textcolor{stringliteral}{"align.z"},     
      \hyperlink{lspmac_8c_aa4ea5a4c387ef167702c58eaddcb4151}{lspmac\_moveabs\_queue});
  \hyperlink{lspmac_8c_aa90d2363b744acbd4d45133b7a716d8f}{anal}   = \hyperlink{lspmac_8c_a95c0a2d36e4e2a0f170fcf3583e7c422}{lspmac\_motor\_init}( &(\hyperlink{lspmac_8c_a894c709ddd0652583d6db22e86282503}{lspmac\_motors}
      [ 4]), 0, 4, &p->\hyperlink{structmd2StatusStruct_a49d1151b0e819646587be0ca9c9d612a}{analyzer\_act\_pos},  &p->\hyperlink{structmd2StatusStruct_ab876b484f55bcce576fcd89dcc3f7267}{analyzer\_status\_1}
      ,  &p->\hyperlink{structmd2StatusStruct_a4f88bb778e4e18f1fbf7672ac11e7433}{analyzer\_status\_2},  \textcolor{stringliteral}{"Anal    #5"},      \textcolor{stringliteral}{"lightPolar"},  
      \hyperlink{lspmac_8c_aa4ea5a4c387ef167702c58eaddcb4151}{lspmac\_moveabs\_queue});
  \hyperlink{lspmac_8c_ad53a42cfaa04eff0336a44c8c9986333}{zoom}   = \hyperlink{lspmac_8c_a95c0a2d36e4e2a0f170fcf3583e7c422}{lspmac\_motor\_init}( &(\hyperlink{lspmac_8c_a894c709ddd0652583d6db22e86282503}{lspmac\_motors}
      [ 5]), 1, 0, &p->\hyperlink{structmd2StatusStruct_a920b80e9f5f08aedac3ad541d5ffc8ae}{zoom\_act\_pos},      &p->\hyperlink{structmd2StatusStruct_af28e978b761dc07eefed3971547cfd4d}{zoom\_status\_1}, 
           &p->\hyperlink{structmd2StatusStruct_a34e4200315a083deb8a970e21bbbe277}{zoom\_status\_2},      \textcolor{stringliteral}{"Zoom    #6 &4 Z"}, \textcolor{stringliteral}{"cam.zoom"},    
      \hyperlink{lspmac_8c_ad6ae1e37afd118f24ab1c6878da53878}{lspmac\_movezoom\_queue});
  \hyperlink{lspmac_8c_a139200ddaa9856a7ffcec0e6cbaa8f1b}{apery}  = \hyperlink{lspmac_8c_a95c0a2d36e4e2a0f170fcf3583e7c422}{lspmac\_motor\_init}( &(\hyperlink{lspmac_8c_a894c709ddd0652583d6db22e86282503}{lspmac\_motors}
      [ 6]), 1, 1, &p->\hyperlink{structmd2StatusStruct_a2a434d2b57dbb669de0765486a1516ff}{aperturey\_act\_pos}, &p->\hyperlink{structmd2StatusStruct_a2ef953eaddf7058bf4276585e6ff066b}{aperturey\_status\_1}
      , &p->\hyperlink{structmd2StatusStruct_a0a7738f13a0fa80626cafc2299b104b4}{aperturey\_status\_2}, \textcolor{stringliteral}{"Aper Y  #7 &5 Y"}, \textcolor{stringliteral}{"appy"},        
      \hyperlink{lspmac_8c_aa4ea5a4c387ef167702c58eaddcb4151}{lspmac\_moveabs\_queue});
  \hyperlink{lspmac_8c_ab93bd6ee850b285ca3a95e64d15e9477}{aperz}  = \hyperlink{lspmac_8c_a95c0a2d36e4e2a0f170fcf3583e7c422}{lspmac\_motor\_init}( &(\hyperlink{lspmac_8c_a894c709ddd0652583d6db22e86282503}{lspmac\_motors}
      [ 7]), 1, 2, &p->\hyperlink{structmd2StatusStruct_a62d584ce23cfd9aa626d3c03649b455c}{aperturez\_act\_pos}, &p->\hyperlink{structmd2StatusStruct_a27880dd795e1ba4fea4870c64ee3aa84}{aperturez\_status\_1}
      , &p->\hyperlink{structmd2StatusStruct_ae407a99e428d9f4a7444a02c8bc3414e}{aperturez\_status\_2}, \textcolor{stringliteral}{"Aper Z  #8 &5 Z"}, \textcolor{stringliteral}{"appz"},        
      \hyperlink{lspmac_8c_aa4ea5a4c387ef167702c58eaddcb4151}{lspmac\_moveabs\_queue});
  \hyperlink{lspmac_8c_a51358daaea8b5236f08414877d8af6c2}{capy}   = \hyperlink{lspmac_8c_a95c0a2d36e4e2a0f170fcf3583e7c422}{lspmac\_motor\_init}( &(\hyperlink{lspmac_8c_a894c709ddd0652583d6db22e86282503}{lspmac\_motors}
      [ 8]), 1, 3, &p->\hyperlink{structmd2StatusStruct_ae25122a6db146501b51609b9cb59b044}{capy\_act\_pos},      &p->\hyperlink{structmd2StatusStruct_a7f4e945e80b1980b9e69366a69ad79cc}{capy\_status\_1}, 
           &p->\hyperlink{structmd2StatusStruct_a5d7c10d9a16ebcc53ac4a0770ab2ef62}{capy\_status\_2},      \textcolor{stringliteral}{"Cap Y   #9 &5 U"}, \textcolor{stringliteral}{"capy"},        
      \hyperlink{lspmac_8c_aa4ea5a4c387ef167702c58eaddcb4151}{lspmac\_moveabs\_queue});
  \hyperlink{lspmac_8c_aa45f268d0af9f3d465acfab128919718}{capz}   = \hyperlink{lspmac_8c_a95c0a2d36e4e2a0f170fcf3583e7c422}{lspmac\_motor\_init}( &(\hyperlink{lspmac_8c_a894c709ddd0652583d6db22e86282503}{lspmac\_motors}
      [ 9]), 1, 4, &p->\hyperlink{structmd2StatusStruct_a257c04efac3a33d5d34b21d64c6f1266}{capz\_act\_pos},      &p->\hyperlink{structmd2StatusStruct_a719db4477f35331eaa8b7b44150e88a2}{capz\_status\_1}, 
           &p->\hyperlink{structmd2StatusStruct_a3abb998bb89433aed16121d0dae6275a}{capz\_status\_2},      \textcolor{stringliteral}{"Cap Z  #10 &5 V"}, \textcolor{stringliteral}{"capz"},        
      \hyperlink{lspmac_8c_aa4ea5a4c387ef167702c58eaddcb4151}{lspmac\_moveabs\_queue});
  \hyperlink{lspmac_8c_a589431b3a79c21c251fcb97cc9126991}{scint}  = \hyperlink{lspmac_8c_a95c0a2d36e4e2a0f170fcf3583e7c422}{lspmac\_motor\_init}( &(\hyperlink{lspmac_8c_a894c709ddd0652583d6db22e86282503}{lspmac\_motors}
      [10]), 2, 0, &p->\hyperlink{structmd2StatusStruct_a1c146fc792c4285eed5b2c446c214f98}{scint\_act\_pos},     &p->\hyperlink{structmd2StatusStruct_a1723870357f428ac5c2758a2c9a475c7}{scint\_status\_1}
      ,     &p->\hyperlink{structmd2StatusStruct_a4e5bc72e2f4007370f1c29ea272c952f}{scint\_status\_2},     \textcolor{stringliteral}{"Scin Z #11 &5 W"}, \textcolor{stringliteral}{"scint"},       
      \hyperlink{lspmac_8c_aa4ea5a4c387ef167702c58eaddcb4151}{lspmac\_moveabs\_queue});
  \hyperlink{lspmac_8c_ac940d950d9efeaf3f0ae67e9bf331188}{cenx}   = \hyperlink{lspmac_8c_a95c0a2d36e4e2a0f170fcf3583e7c422}{lspmac\_motor\_init}( &(\hyperlink{lspmac_8c_a894c709ddd0652583d6db22e86282503}{lspmac\_motors}
      [11]), 2, 1, &p->\hyperlink{structmd2StatusStruct_ae7924b6e91e1de82f6f7910cb3a9c9bd}{centerx\_act\_pos},   &p->\hyperlink{structmd2StatusStruct_aa619cdbd7a563408c6b825ddc4f74ebb}{centerx\_status\_1}
      ,   &p->\hyperlink{structmd2StatusStruct_ae4fad6debe138ed7815d463e83f8d0f6}{centerx\_status\_2},   \textcolor{stringliteral}{"Cen X  #17 &2 X"}, \textcolor{stringliteral}{"centering.x"}, 
      \hyperlink{lspmac_8c_aa4ea5a4c387ef167702c58eaddcb4151}{lspmac\_moveabs\_queue});
  \hyperlink{lspmac_8c_aaed18e738ba7bfb6c771a44f5d7ea827}{ceny}   = \hyperlink{lspmac_8c_a95c0a2d36e4e2a0f170fcf3583e7c422}{lspmac\_motor\_init}( &(\hyperlink{lspmac_8c_a894c709ddd0652583d6db22e86282503}{lspmac\_motors}
      [12]), 2, 2, &p->\hyperlink{structmd2StatusStruct_a6be71a92a599d490ca808af8c7e7faa0}{centery\_act\_pos},   &p->\hyperlink{structmd2StatusStruct_a57f65ebe28ef88f1c632d9f35d9167eb}{centery\_status\_1}
      ,   &p->\hyperlink{structmd2StatusStruct_aa242098c185cce8f852cd6e081ef0b1d}{centery\_status\_2},   \textcolor{stringliteral}{"Cen Y  #18 &2 Y"}, \textcolor{stringliteral}{"centering.y"}, 
      \hyperlink{lspmac_8c_aa4ea5a4c387ef167702c58eaddcb4151}{lspmac\_moveabs\_queue});
  \hyperlink{lspmac_8c_a0be79ccb7ebf3a665248fd856112b9fd}{kappa}  = \hyperlink{lspmac_8c_a95c0a2d36e4e2a0f170fcf3583e7c422}{lspmac\_motor\_init}( &(\hyperlink{lspmac_8c_a894c709ddd0652583d6db22e86282503}{lspmac\_motors}
      [13]), 2, 3, &p->\hyperlink{structmd2StatusStruct_ac384fb7073387dd5dcb2e85a00ec8a77}{kappa\_act\_pos},     &p->\hyperlink{structmd2StatusStruct_ab152694bc32d37c1d180f55e8d282020}{kappa\_status\_1}
      ,     &p->\hyperlink{structmd2StatusStruct_af6891f5f8dcfc62668f64c583042c6bc}{kappa\_status\_2},     \textcolor{stringliteral}{"Kappa  #19 &7 X"}, \textcolor{stringliteral}{"kappa"},       
      \hyperlink{lspmac_8c_aa4ea5a4c387ef167702c58eaddcb4151}{lspmac\_moveabs\_queue});
  \hyperlink{lspmac_8c_ac8070dc568ad974a3db42b51eca828cc}{phi}    = \hyperlink{lspmac_8c_a95c0a2d36e4e2a0f170fcf3583e7c422}{lspmac\_motor\_init}( &(\hyperlink{lspmac_8c_a894c709ddd0652583d6db22e86282503}{lspmac\_motors}[
      14]), 2, 4, &p->\hyperlink{structmd2StatusStruct_a4de22995a72ff6e72a1a9ccab6d00620}{phi\_act\_pos},       &p->\hyperlink{structmd2StatusStruct_ad8b8fd90ffff43016e2adaab5ccbfa02}{phi\_status\_1},     
        &p->\hyperlink{structmd2StatusStruct_a0e6cea4c32cb34e602b9ac3d21259219}{phi\_status\_2},       \textcolor{stringliteral}{"Phi    #20 &7 Y"}, \textcolor{stringliteral}{"phi"},         
      \hyperlink{lspmac_8c_aa4ea5a4c387ef167702c58eaddcb4151}{lspmac\_moveabs\_queue});

  \hyperlink{lspmac_8c_a26dec4623af9beed912b8e7e6f99822c}{fshut}  = \hyperlink{lspmac_8c_a40aa4aeb5c799a6a3a089137da4fd6a8}{lspmac\_fshut\_init}( &(\hyperlink{lspmac_8c_a894c709ddd0652583d6db22e86282503}{lspmac\_motors}
      [15]));
  \hyperlink{lspmac_8c_aeb09895663eff333b7a75acb319a9fc1}{flight} = \hyperlink{lspmac_8c_a676f13681af304b58475f8ba45f86f28}{lspmac\_dac\_init}( &(\hyperlink{lspmac_8c_a894c709ddd0652583d6db22e86282503}{lspmac\_motors}[1
      6]), &p->\hyperlink{structmd2StatusStruct_a3be73c48b09190241a2bcb801af5b97c}{front\_dac},   \textcolor{stringliteral}{"M1200"}, \textcolor{stringliteral}{"frontLight.intensity"}, 
      \hyperlink{lspmac_8c_a7d601716497857c2b5c072c1aed37b71}{lspmac\_movedac\_queue});
  \hyperlink{lspmac_8c_a85d6eaa4b4a82bb3112574f458d1dc50}{blight} = \hyperlink{lspmac_8c_a676f13681af304b58475f8ba45f86f28}{lspmac\_dac\_init}( &(\hyperlink{lspmac_8c_a894c709ddd0652583d6db22e86282503}{lspmac\_motors}[1
      7]), &p->\hyperlink{structmd2StatusStruct_a33ce490348c8de255cf49b96469d3d4e}{back\_dac},    \textcolor{stringliteral}{"M1201"}, \textcolor{stringliteral}{"backLight.intensity"},  
      \hyperlink{lspmac_8c_a7d601716497857c2b5c072c1aed37b71}{lspmac\_movedac\_queue});
  \hyperlink{lspmac_8c_a8a3ca6fcf5e24dcc26170736843e53b2}{fscint} = \hyperlink{lspmac_8c_a676f13681af304b58475f8ba45f86f28}{lspmac\_dac\_init}( &(\hyperlink{lspmac_8c_a894c709ddd0652583d6db22e86282503}{lspmac\_motors}[1
      8]), &p->\hyperlink{structmd2StatusStruct_a031be48adfa016c637d6eae49054c435}{scint\_piezo}, \textcolor{stringliteral}{"M1203"}, \textcolor{stringliteral}{"scint.focus"},          
      \hyperlink{lspmac_8c_a7d601716497857c2b5c072c1aed37b71}{lspmac\_movedac\_queue});

  \hyperlink{lspmac_8c_abee73a0d9e5f3af9eb88d5cfd6b953c3}{smart\_mag\_oo}  = \hyperlink{lspmac_8c_aeaa263af25d139f249d8b825a058d0ce}{lspmac\_bo\_init}( &(\hyperlink{lspmac_8c_a894c709ddd0652583d6db22e86282503}{lspmac\_motors}
      [19]), \textcolor{stringliteral}{"smartMagnet"},\textcolor{stringliteral}{"M1100=%d"}, &(\hyperlink{lspmac_8c_ad5bce7451d48127bace5af445d03b492}{md2\_status}.\hyperlink{structmd2StatusStruct_ab09c1342dc12052b8f5b35f78ef95000}{acc11c\_5}), 0x01)
      ;
  \hyperlink{lspmac_8c_af813a2eff0b7efa4c70633559054e84c}{blight\_ud}     = \hyperlink{lspmac_8c_aeaa263af25d139f249d8b825a058d0ce}{lspmac\_bo\_init}( &(\hyperlink{lspmac_8c_a894c709ddd0652583d6db22e86282503}{lspmac\_motors}
      [20]), \textcolor{stringliteral}{"backLight"},  \textcolor{stringliteral}{"M1101=%d"}, &(\hyperlink{lspmac_8c_ad5bce7451d48127bace5af445d03b492}{md2\_status}.\hyperlink{structmd2StatusStruct_ab09c1342dc12052b8f5b35f78ef95000}{acc11c\_5}), 0x02)
      ;
  \hyperlink{lspmac_8c_ae78d9a757d4c85419fff9c94b15e25d7}{cryo}          = \hyperlink{lspmac_8c_aeaa263af25d139f249d8b825a058d0ce}{lspmac\_bo\_init}( &(\hyperlink{lspmac_8c_a894c709ddd0652583d6db22e86282503}{lspmac\_motors}
      [21]), \textcolor{stringliteral}{"cryo"},       \textcolor{stringliteral}{"M1102=%d"}, &(\hyperlink{lspmac_8c_ad5bce7451d48127bace5af445d03b492}{md2\_status}.\hyperlink{structmd2StatusStruct_ab09c1342dc12052b8f5b35f78ef95000}{acc11c\_5}), 0x04)
      ;
  \hyperlink{lspmac_8c_a9d9c5030d817483ca9518027c91adac4}{dryer}         = \hyperlink{lspmac_8c_aeaa263af25d139f249d8b825a058d0ce}{lspmac\_bo\_init}( &(\hyperlink{lspmac_8c_a894c709ddd0652583d6db22e86282503}{lspmac\_motors}
      [22]), \textcolor{stringliteral}{"dryer"},      \textcolor{stringliteral}{"M1103=%d"}, &(\hyperlink{lspmac_8c_ad5bce7451d48127bace5af445d03b492}{md2\_status}.\hyperlink{structmd2StatusStruct_ab09c1342dc12052b8f5b35f78ef95000}{acc11c\_5}), 0x08)
      ;
  \hyperlink{lspmac_8c_addb26c80065506faa1de3c1b468fe03f}{fluo}          = \hyperlink{lspmac_8c_aeaa263af25d139f249d8b825a058d0ce}{lspmac\_bo\_init}( &(\hyperlink{lspmac_8c_a894c709ddd0652583d6db22e86282503}{lspmac\_motors}
      [23]), \textcolor{stringliteral}{"fluo"},       \textcolor{stringliteral}{"M1104=%d"}, &(\hyperlink{lspmac_8c_ad5bce7451d48127bace5af445d03b492}{md2\_status}.\hyperlink{structmd2StatusStruct_ab09c1342dc12052b8f5b35f78ef95000}{acc11c\_5}), 0x10)
      ;
  \hyperlink{lspmac_8c_a6630442dc65ce8a30a24ed718b301971}{flight\_oo}     = \hyperlink{lspmac_8c_a25e8b92da927708fab6ac41feee6f502}{lspmac\_soft\_motor\_init}( &(
      \hyperlink{lspmac_8c_a894c709ddd0652583d6db22e86282503}{lspmac\_motors}[24]), \textcolor{stringliteral}{"frontLight"},        
      \hyperlink{lspmac_8c_a1c529ad597a2ff5cb06a199a04ca9a8c}{lspmac\_moveabs\_frontlight\_oo\_queue});
  \hyperlink{lspmac_8c_af55c51d52c4586b647114f95d7ac1f42}{blight\_f}      = \hyperlink{lspmac_8c_a25e8b92da927708fab6ac41feee6f502}{lspmac\_soft\_motor\_init}( &(
      \hyperlink{lspmac_8c_a894c709ddd0652583d6db22e86282503}{lspmac\_motors}[25]), \textcolor{stringliteral}{"backLight.factor"},  
      \hyperlink{lspmac_8c_ae8f8f355aefad437e4364469024e2e07}{lspmac\_moveabs\_blight\_factor\_queue});
  \hyperlink{lspmac_8c_aabf4ec595b5183c1777d029ca56134b0}{flight\_f}      = \hyperlink{lspmac_8c_a25e8b92da927708fab6ac41feee6f502}{lspmac\_soft\_motor\_init}( &(
      \hyperlink{lspmac_8c_a894c709ddd0652583d6db22e86282503}{lspmac\_motors}[26]), \textcolor{stringliteral}{"frontLight.factor"}, 
      \hyperlink{lspmac_8c_a64c4eff486a01a8e170a65c0d68777aa}{lspmac\_moveabs\_flight\_factor\_queue});

  \hyperlink{lspmac_8c_aade15098d213bb25522048e4a231941a}{lp\_air}          = \hyperlink{lspmac_8c_ac27a61fa5aca398b0db588674e7f6dc7}{lspmac\_bi\_init}( &(\hyperlink{lspmac_8c_a37c46609cb32aea5178c4d59d7892d13}{lspmac\_bis}[
       0]), &(\hyperlink{lspmac_8c_ad5bce7451d48127bace5af445d03b492}{md2\_status}.\hyperlink{structmd2StatusStruct_a69fc2e30a5de0a11c992d133e7a761cd}{acc11c\_1}),  0x01, \textcolor{stringliteral}{"Low Pressure Air OK"},  \textcolor{stringliteral}{"
      Low Pressure Air Failed"});
  \hyperlink{lspmac_8c_abb29b117ad38156ba16fcf44eeb427af}{hp\_air}          = \hyperlink{lspmac_8c_ac27a61fa5aca398b0db588674e7f6dc7}{lspmac\_bi\_init}( &(\hyperlink{lspmac_8c_a37c46609cb32aea5178c4d59d7892d13}{lspmac\_bis}[
       1]), &(\hyperlink{lspmac_8c_ad5bce7451d48127bace5af445d03b492}{md2\_status}.\hyperlink{structmd2StatusStruct_a69fc2e30a5de0a11c992d133e7a761cd}{acc11c\_1}),  0x02, \textcolor{stringliteral}{"High Pressure Air OK"}, \textcolor{stringliteral}{"
      High Pressure Air Failed"});
  \hyperlink{lspmac_8c_a28df32fd6be9160603aa1bb74a823574}{cryo\_switch}     = \hyperlink{lspmac_8c_ac27a61fa5aca398b0db588674e7f6dc7}{lspmac\_bi\_init}( &(\hyperlink{lspmac_8c_a37c46609cb32aea5178c4d59d7892d13}{lspmac\_bis}
      [ 2]), &(\hyperlink{lspmac_8c_ad5bce7451d48127bace5af445d03b492}{md2\_status}.\hyperlink{structmd2StatusStruct_a69fc2e30a5de0a11c992d133e7a761cd}{acc11c\_1}),  0x04, \textcolor{stringliteral}{"CryoSwitchChanged"},    \textcolor{stringliteral}{
      "CryoSwitchChanged"});
  \hyperlink{lspmac_8c_ac0d0bc95bcbcbd154b30c72a9645c8b2}{blight\_down}     = \hyperlink{lspmac_8c_ac27a61fa5aca398b0db588674e7f6dc7}{lspmac\_bi\_init}( &(\hyperlink{lspmac_8c_a37c46609cb32aea5178c4d59d7892d13}{lspmac\_bis}
      [ 3]), &(\hyperlink{lspmac_8c_ad5bce7451d48127bace5af445d03b492}{md2\_status}.\hyperlink{structmd2StatusStruct_a69fc2e30a5de0a11c992d133e7a761cd}{acc11c\_1}),  0x08, \textcolor{stringliteral}{"Backlight Down"},       \textcolor{stringliteral}{
      "Backlight Not Down"});
  \hyperlink{lspmac_8c_a7fba65f6555c5c7908852c6cf1ad0c94}{blight\_up}       = \hyperlink{lspmac_8c_ac27a61fa5aca398b0db588674e7f6dc7}{lspmac\_bi\_init}( &(\hyperlink{lspmac_8c_a37c46609cb32aea5178c4d59d7892d13}{lspmac\_bis}
      [ 4]), &(\hyperlink{lspmac_8c_ad5bce7451d48127bace5af445d03b492}{md2\_status}.\hyperlink{structmd2StatusStruct_a69fc2e30a5de0a11c992d133e7a761cd}{acc11c\_1}),  0x10, \textcolor{stringliteral}{"Backlight Up"},         \textcolor{stringliteral}{
      "Backlight Not Up"});
  \hyperlink{lspmac_8c_a871d4cdea0a1a8db85b8658a07655212}{cryo\_back}       = \hyperlink{lspmac_8c_ac27a61fa5aca398b0db588674e7f6dc7}{lspmac\_bi\_init}( &(\hyperlink{lspmac_8c_a37c46609cb32aea5178c4d59d7892d13}{lspmac\_bis}
      [ 5]), &(\hyperlink{lspmac_8c_ad5bce7451d48127bace5af445d03b492}{md2\_status}.\hyperlink{structmd2StatusStruct_a69fc2e30a5de0a11c992d133e7a761cd}{acc11c\_1}),  0x40, \textcolor{stringliteral}{"Cryo Back"},            \textcolor{stringliteral}{
      "Cryo Not Back"});
  \hyperlink{lspmac_8c_a67092de6f3fcc0b245e4970437eaff6b}{fluor\_back}    = \hyperlink{lspmac_8c_ac27a61fa5aca398b0db588674e7f6dc7}{lspmac\_bi\_init}( &(\hyperlink{lspmac_8c_a37c46609cb32aea5178c4d59d7892d13}{lspmac\_bis}
      [ 6]), &(\hyperlink{lspmac_8c_ad5bce7451d48127bace5af445d03b492}{md2\_status}.\hyperlink{structmd2StatusStruct_ad186f06cb4670b00b8af8264d1da66a4}{acc11c\_2}),  0x01, \textcolor{stringliteral}{"Fluor. Det. Parked"},   \textcolor{stringliteral}{
      "Fluor. Det. Not Parked"});
  \hyperlink{lspmac_8c_ac59ab990e48033a811aeb0281fb588fc}{sample\_detected} = \hyperlink{lspmac_8c_ac27a61fa5aca398b0db588674e7f6dc7}{lspmac\_bi\_init}( &(\hyperlink{lspmac_8c_a37c46609cb32aea5178c4d59d7892d13}{lspmac\_bis}
      [ 7]), &(\hyperlink{lspmac_8c_ad5bce7451d48127bace5af445d03b492}{md2\_status}.\hyperlink{structmd2StatusStruct_ad186f06cb4670b00b8af8264d1da66a4}{acc11c\_2}),  0x02, \textcolor{stringliteral}{"SamplePresent"},        \textcolor{stringliteral}{
      "SampleAbsent"});
  \hyperlink{lspmac_8c_a5538a6aa526eeed65ff237303da2d348}{etel\_ready}      = \hyperlink{lspmac_8c_ac27a61fa5aca398b0db588674e7f6dc7}{lspmac\_bi\_init}( &(\hyperlink{lspmac_8c_a37c46609cb32aea5178c4d59d7892d13}{lspmac\_bis}
      [ 8]), &(\hyperlink{lspmac_8c_ad5bce7451d48127bace5af445d03b492}{md2\_status}.\hyperlink{structmd2StatusStruct_ad186f06cb4670b00b8af8264d1da66a4}{acc11c\_2}),  0x20, \textcolor{stringliteral}{"ETEL Ready"},           \textcolor{stringliteral}{
      "ETEL Not Ready"});
  \hyperlink{lspmac_8c_ab48d4a2cf0225796db9aad49f034dc59}{etel\_on}         = \hyperlink{lspmac_8c_ac27a61fa5aca398b0db588674e7f6dc7}{lspmac\_bi\_init}( &(\hyperlink{lspmac_8c_a37c46609cb32aea5178c4d59d7892d13}{lspmac\_bis}
      [ 9]), &(\hyperlink{lspmac_8c_ad5bce7451d48127bace5af445d03b492}{md2\_status}.\hyperlink{structmd2StatusStruct_ad186f06cb4670b00b8af8264d1da66a4}{acc11c\_2}),  0x40, \textcolor{stringliteral}{"ETEL On"},              \textcolor{stringliteral}{
      "ETEL Off"});
  \hyperlink{lspmac_8c_a1e690d4ad981d020ea2c850282dca3be}{etel\_init\_ok}    = \hyperlink{lspmac_8c_ac27a61fa5aca398b0db588674e7f6dc7}{lspmac\_bi\_init}( &(\hyperlink{lspmac_8c_a37c46609cb32aea5178c4d59d7892d13}{lspmac\_bis}
      [10]), &(\hyperlink{lspmac_8c_ad5bce7451d48127bace5af445d03b492}{md2\_status}.\hyperlink{structmd2StatusStruct_ad186f06cb4670b00b8af8264d1da66a4}{acc11c\_2}),  0x80, \textcolor{stringliteral}{"ETEL Init OK"},         \textcolor{stringliteral}{
      "ETEL Init Not OK"});
  \hyperlink{lspmac_8c_ab552f2e28dd9cccefafe01f27717101b}{minikappa\_ok}    = \hyperlink{lspmac_8c_ac27a61fa5aca398b0db588674e7f6dc7}{lspmac\_bi\_init}( &(\hyperlink{lspmac_8c_a37c46609cb32aea5178c4d59d7892d13}{lspmac\_bis}
      [11]), &(\hyperlink{lspmac_8c_ad5bce7451d48127bace5af445d03b492}{md2\_status}.\hyperlink{structmd2StatusStruct_a20a15620e12888f61c0aed1e47e97932}{acc11c\_3}),  0x01, \textcolor{stringliteral}{"Minikappa OK"},         \textcolor{stringliteral}{
      "Minikappa Not OK"});
  \hyperlink{lspmac_8c_a2dc6fa78bb6313fe8b696d646eaa2443}{smart\_mag\_on}    = \hyperlink{lspmac_8c_ac27a61fa5aca398b0db588674e7f6dc7}{lspmac\_bi\_init}( &(\hyperlink{lspmac_8c_a37c46609cb32aea5178c4d59d7892d13}{lspmac\_bis}
      [12]), &(\hyperlink{lspmac_8c_ad5bce7451d48127bace5af445d03b492}{md2\_status}.\hyperlink{structmd2StatusStruct_a20a15620e12888f61c0aed1e47e97932}{acc11c\_3}),  0x04, \textcolor{stringliteral}{"Smart Magnet On"},      \textcolor{stringliteral}{
      "Smart Magnet Not On"});
  \hyperlink{lspmac_8c_afaff4fbb5f03b0d2469fc7a14f174d69}{arm\_parked}      = \hyperlink{lspmac_8c_ac27a61fa5aca398b0db588674e7f6dc7}{lspmac\_bi\_init}( &(\hyperlink{lspmac_8c_a37c46609cb32aea5178c4d59d7892d13}{lspmac\_bis}
      [13]), &(\hyperlink{lspmac_8c_ad5bce7451d48127bace5af445d03b492}{md2\_status}.\hyperlink{structmd2StatusStruct_a20a15620e12888f61c0aed1e47e97932}{acc11c\_3}),  0x08, \textcolor{stringliteral}{"Arm Parked"},           \textcolor{stringliteral}{
      "Arm Not Parked"});
  \hyperlink{lspmac_8c_a37903ed8430ac4d9ead609a78eb62f32}{smart\_mag\_err}   = \hyperlink{lspmac_8c_ac27a61fa5aca398b0db588674e7f6dc7}{lspmac\_bi\_init}( &(\hyperlink{lspmac_8c_a37c46609cb32aea5178c4d59d7892d13}{lspmac\_bis}
      [14]), &(\hyperlink{lspmac_8c_ad5bce7451d48127bace5af445d03b492}{md2\_status}.\hyperlink{structmd2StatusStruct_a20a15620e12888f61c0aed1e47e97932}{acc11c\_3}),  0x10, \textcolor{stringliteral}{"Smart Magnet Error"},   \textcolor{stringliteral}{
      "Smart Magnet OK"});
  \hyperlink{lspmac_8c_ae98a0792d6b4b96a33df0a31bdec6342}{shutter\_open}    = \hyperlink{lspmac_8c_ac27a61fa5aca398b0db588674e7f6dc7}{lspmac\_bi\_init}( &(\hyperlink{lspmac_8c_a37c46609cb32aea5178c4d59d7892d13}{lspmac\_bis}
      [15]), &(\hyperlink{lspmac_8c_ad5bce7451d48127bace5af445d03b492}{md2\_status}.\hyperlink{structmd2StatusStruct_a20a15620e12888f61c0aed1e47e97932}{acc11c\_3}), 0x100, \textcolor{stringliteral}{"Shutter Open"},         \textcolor{stringliteral}{
      "Shutter Not Open"});
  \hyperlink{lspmac_8c_a4892e918830dd12093d28c53a1c2df98}{smart\_mag\_off}   = \hyperlink{lspmac_8c_ac27a61fa5aca398b0db588674e7f6dc7}{lspmac\_bi\_init}( &(\hyperlink{lspmac_8c_a37c46609cb32aea5178c4d59d7892d13}{lspmac\_bis}
      [16]), &(\hyperlink{lspmac_8c_ad5bce7451d48127bace5af445d03b492}{md2\_status}.\hyperlink{structmd2StatusStruct_ab09c1342dc12052b8f5b35f78ef95000}{acc11c\_5}),  0x01, \textcolor{stringliteral}{"Smart Magnet Off"},     \textcolor{stringliteral}{
      "Smart Magnet Not Off"});
  

  \textcolor{comment}{//}
  \textcolor{comment}{// Initialize several commands that get called, perhaps, alot}
  \textcolor{comment}{//}
  

  \hyperlink{lspmac_8c_a6fcbbe47fe9912533962601f5befdb29}{rr\_cmd}.\hyperlink{structtagEthernetCmd_a6a155eb3ae546dd29369c4a33ddb3310}{RequestType} = \hyperlink{lspmac_8c_a5485d08fdc80533b5cebadff63696ed2}{VR\_UPLOAD};
  \hyperlink{lspmac_8c_a6fcbbe47fe9912533962601f5befdb29}{rr\_cmd}.\hyperlink{structtagEthernetCmd_a0dc566e7edbb226f1a4ea443d93d56e2}{Request}     = \hyperlink{lspmac_8c_aad3c7b4a9403e56c09eceadcf21252c0}{VR\_PMAC\_READREADY};
  \hyperlink{lspmac_8c_a6fcbbe47fe9912533962601f5befdb29}{rr\_cmd}.\hyperlink{structtagEthernetCmd_aec0ee9a5f6c7e3bc6e4bd98f1bd52783}{wValue}      = 0;
  \hyperlink{lspmac_8c_a6fcbbe47fe9912533962601f5befdb29}{rr\_cmd}.\hyperlink{structtagEthernetCmd_a92f5a374e87d4f496b64b4888850d6e6}{wIndex}      = 0;
  \hyperlink{lspmac_8c_a6fcbbe47fe9912533962601f5befdb29}{rr\_cmd}.\hyperlink{structtagEthernetCmd_af5df25ff13ca30fa33719d0df1ab7e97}{wLength}     = htons(2);
  memset( \hyperlink{lspmac_8c_a6fcbbe47fe9912533962601f5befdb29}{rr\_cmd}.\hyperlink{structtagEthernetCmd_a872dab798127d6f589974a79c5d0aef1}{bData}, 0, \textcolor{keyword}{sizeof}(\hyperlink{lspmac_8c_a6fcbbe47fe9912533962601f5befdb29}{rr\_cmd}.\hyperlink{structtagEthernetCmd_a872dab798127d6f589974a79c5d0aef1}{bData}));

  \hyperlink{lspmac_8c_ae7b21213b9c78b6745213409f1ef7320}{gb\_cmd}.\hyperlink{structtagEthernetCmd_a6a155eb3ae546dd29369c4a33ddb3310}{RequestType} = \hyperlink{lspmac_8c_a5485d08fdc80533b5cebadff63696ed2}{VR\_UPLOAD};
  \hyperlink{lspmac_8c_ae7b21213b9c78b6745213409f1ef7320}{gb\_cmd}.\hyperlink{structtagEthernetCmd_a0dc566e7edbb226f1a4ea443d93d56e2}{Request}     = \hyperlink{lspmac_8c_a50e444b5ceb6d62a1be43c88c55c549c}{VR\_PMAC\_GETBUFFER};
  \hyperlink{lspmac_8c_ae7b21213b9c78b6745213409f1ef7320}{gb\_cmd}.\hyperlink{structtagEthernetCmd_aec0ee9a5f6c7e3bc6e4bd98f1bd52783}{wValue}      = 0;
  \hyperlink{lspmac_8c_ae7b21213b9c78b6745213409f1ef7320}{gb\_cmd}.\hyperlink{structtagEthernetCmd_a92f5a374e87d4f496b64b4888850d6e6}{wIndex}      = 0;
  \hyperlink{lspmac_8c_ae7b21213b9c78b6745213409f1ef7320}{gb\_cmd}.\hyperlink{structtagEthernetCmd_af5df25ff13ca30fa33719d0df1ab7e97}{wLength}     = htons(1400);
  memset( \hyperlink{lspmac_8c_ae7b21213b9c78b6745213409f1ef7320}{gb\_cmd}.\hyperlink{structtagEthernetCmd_a872dab798127d6f589974a79c5d0aef1}{bData}, 0, \textcolor{keyword}{sizeof}(\hyperlink{lspmac_8c_ae7b21213b9c78b6745213409f1ef7320}{gb\_cmd}.\hyperlink{structtagEthernetCmd_a872dab798127d6f589974a79c5d0aef1}{bData}));

  \hyperlink{lspmac_8c_a8908812f4ff25c196679e00d330edd81}{cr\_cmd}.\hyperlink{structtagEthernetCmd_a6a155eb3ae546dd29369c4a33ddb3310}{RequestType} = \hyperlink{lspmac_8c_a5485d08fdc80533b5cebadff63696ed2}{VR\_UPLOAD};
  \hyperlink{lspmac_8c_a8908812f4ff25c196679e00d330edd81}{cr\_cmd}.\hyperlink{structtagEthernetCmd_a0dc566e7edbb226f1a4ea443d93d56e2}{Request}     = \hyperlink{lspmac_8c_a8f4ce4666a23a3fb153d680bd1cb6556}{VR\_CTRL\_RESPONSE};
  \hyperlink{lspmac_8c_a8908812f4ff25c196679e00d330edd81}{cr\_cmd}.\hyperlink{structtagEthernetCmd_aec0ee9a5f6c7e3bc6e4bd98f1bd52783}{wValue}      = 0;
  \hyperlink{lspmac_8c_a8908812f4ff25c196679e00d330edd81}{cr\_cmd}.\hyperlink{structtagEthernetCmd_a92f5a374e87d4f496b64b4888850d6e6}{wIndex}      = 0;
  \hyperlink{lspmac_8c_a8908812f4ff25c196679e00d330edd81}{cr\_cmd}.\hyperlink{structtagEthernetCmd_af5df25ff13ca30fa33719d0df1ab7e97}{wLength}     = htons(1400);
  memset( \hyperlink{lspmac_8c_a8908812f4ff25c196679e00d330edd81}{cr\_cmd}.\hyperlink{structtagEthernetCmd_a872dab798127d6f589974a79c5d0aef1}{bData}, 0, \textcolor{keyword}{sizeof}(\hyperlink{lspmac_8c_a8908812f4ff25c196679e00d330edd81}{cr\_cmd}.\hyperlink{structtagEthernetCmd_a872dab798127d6f589974a79c5d0aef1}{bData}));

  \textcolor{comment}{//}
  \textcolor{comment}{// Initialize some mutexs and conditions}
  \textcolor{comment}{//}

  pthread\_mutex\_init( &\hyperlink{lspmac_8c_acc1bb77b9bcbc4d970f841a41fd274b3}{pmac\_queue\_mutex}, NULL);
  pthread\_cond\_init(  &\hyperlink{lspmac_8c_a8a25bd9c593c6985107f90f999ce0b08}{pmac\_queue\_cond}, NULL);

  \hyperlink{lspmac_8c_a112158e0cd50449a440ac55c7af7bea2}{lspmac\_shutter\_state} = 0;                         \textcolor{comment}{//
       assume the shutter is now closed: not a big deal if we are wrong}
  pthread\_mutex\_init( &\hyperlink{lspmac_8c_a1b78a13c654409333569815e1c109d38}{lspmac\_shutter\_mutex}, NULL);
  pthread\_cond\_init(  &\hyperlink{lspmac_8c_afbd51c2cefcee87afe994c9e9f372241}{lspmac\_shutter\_cond}, NULL);
  \hyperlink{lspmac_8c_adba7f5f4bbeabc4dac859221d4c684ba}{pmacfd}.fd = -1;

  pthread\_mutex\_init( &\hyperlink{lspmac_8c_a85679cac947e199c88794f8e5a12bf5f}{lspmac\_moving\_mutex}, NULL);
  pthread\_cond\_init(  &\hyperlink{lspmac_8c_a57547d211906c981ef20257eba99f8df}{lspmac\_moving\_cond}, NULL);

  pthread\_mutex\_init( &\hyperlink{lspmac_8c_a2ff142105e17d933871d09759e7082f8}{lspmac\_ascii\_mutex}, NULL);

  pthread\_mutex\_init( &\hyperlink{lspmac_8c_a3e7ae750b8988cd2eb93895e3ea1a49e}{lspmac\_ascii\_buffers\_mutex}, 
      NULL);

  \textcolor{comment}{//}
  \textcolor{comment}{// clear the ascii communications buffers}
  \textcolor{comment}{//}
  \{
    uint32\_t cc;
    cc = 0;
    \hyperlink{lspmac_8c_ac60f32e1ab6d81a60155e355db752726}{lspmac\_send\_command}( \hyperlink{lspmac_8c_a5485d08fdc80533b5cebadff63696ed2}{VR\_UPLOAD}, \hyperlink{lspmac_8c_ab79207cc3145740f8c070a24c91b11e0}{VR\_PMAC\_SETMEM}
      , 0x0e9e, 0, 4, (\textcolor{keywordtype}{char} *)&cc, NULL, 1, NULL);

    cc = 0x18;
    \hyperlink{lspmac_8c_ac60f32e1ab6d81a60155e355db752726}{lspmac\_send\_command}( \hyperlink{lspmac_8c_a5485d08fdc80533b5cebadff63696ed2}{VR\_UPLOAD}, \hyperlink{lspmac_8c_ab79207cc3145740f8c070a24c91b11e0}{VR\_PMAC\_SETMEM}
      , 0x0e9e, 0, 4, (\textcolor{keywordtype}{char} *)&cc, NULL, 1, NULL);
  \}

  \hyperlink{lspmac_8c_afab9e8f0502a92ee5cf93209af710f81}{lspmac\_SockSendDPline}( NULL, \textcolor{stringliteral}{"I5=0"});
  \hyperlink{lspmac_8c_afab9e8f0502a92ee5cf93209af710f81}{lspmac\_SockSendDPline}( NULL, \textcolor{stringliteral}{"ENABLE PLCC 0,2"});
  \hyperlink{lspmac_8c_afab9e8f0502a92ee5cf93209af710f81}{lspmac\_SockSendDPline}( NULL, \textcolor{stringliteral}{"DISABLE PLCC 1"});
  \hyperlink{lspmac_8c_afab9e8f0502a92ee5cf93209af710f81}{lspmac\_SockSendDPline}( NULL, \textcolor{stringliteral}{"I5=3"});
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_a62273d5e9fd9a14838f4126fb94a5138}{\index{pgpmac.\-h@{pgpmac.\-h}!lspmac\-\_\-jogabs\-\_\-queue@{lspmac\-\_\-jogabs\-\_\-queue}}
\index{lspmac\-\_\-jogabs\-\_\-queue@{lspmac\-\_\-jogabs\-\_\-queue}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspmac\-\_\-jogabs\-\_\-queue}]{\setlength{\rightskip}{0pt plus 5cm}void lspmac\-\_\-jogabs\-\_\-queue (
\begin{DoxyParamCaption}
\item[{{\bf lspmac\-\_\-motor\-\_\-t} $\ast$}]{, }
\item[{double}]{}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_a62273d5e9fd9a14838f4126fb94a5138}


Use jog to move motor to requested position. 



Definition at line 2665 of file lspmac.\-c.


\begin{DoxyCode}
                            \{
  
  \hyperlink{lspmac_8c_a4ccd25a1a3a83cd7c9187975e52a9484}{lspmac\_move\_or\_jog\_abs\_queue}( mp, 
      requested\_position, 1);
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_a71a8e9cb210ac33874abe4e15149b964}{\index{pgpmac.\-h@{pgpmac.\-h}!lspmac\-\_\-move\-\_\-or\-\_\-jog\-\_\-abs\-\_\-queue@{lspmac\-\_\-move\-\_\-or\-\_\-jog\-\_\-abs\-\_\-queue}}
\index{lspmac\-\_\-move\-\_\-or\-\_\-jog\-\_\-abs\-\_\-queue@{lspmac\-\_\-move\-\_\-or\-\_\-jog\-\_\-abs\-\_\-queue}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspmac\-\_\-move\-\_\-or\-\_\-jog\-\_\-abs\-\_\-queue}]{\setlength{\rightskip}{0pt plus 5cm}void lspmac\-\_\-move\-\_\-or\-\_\-jog\-\_\-abs\-\_\-queue (
\begin{DoxyParamCaption}
\item[{{\bf lspmac\-\_\-motor\-\_\-t} $\ast$}]{mp, }
\item[{double}]{requested\-\_\-position, }
\item[{int}]{use\-\_\-jo}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_a71a8e9cb210ac33874abe4e15149b964}


Move method for normal stepper and servo motor objects. 

$<$ format string for coordinate system move

$<$ coordinate system bit

$<$ the requested position in units of \char`\"{}counts\char`\"{}

$<$ motor and coordinate system;

$<$ our axis 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em mp} & The motor to move \\
\hline
\mbox{\tt in}  & {\em requested\-\_\-position} & Where to move it \\
\hline
\mbox{\tt in}  & {\em use\-\_\-jo} & 1 to force jog, 0 for motion prog \\
\hline
\end{DoxyParams}


Definition at line 2515 of file lspmac.\-c.


\begin{DoxyCode}
                            \{
  \textcolor{keywordtype}{char} *fmt;                    
  \textcolor{keywordtype}{int} q100;                     
  \textcolor{keywordtype}{int} requested\_pos\_cnts;       
  \textcolor{keywordtype}{int} coord\_num, motor\_num;     
  \textcolor{keywordtype}{char} *axis;                   
  \textcolor{keywordtype}{double} u2c;

  pthread\_mutex\_lock( &(mp->\hyperlink{structlspmac__motor__struct_a188c5b1e991750ce2ffd53e0192e0907}{mutex}));

  u2c       = \hyperlink{lsredis_8c_aa8daf63b794b6b6341018feec205cb7d}{lsredis\_getd}(   mp->\hyperlink{structlspmac__motor__struct_a8838915ebb6f9989944117c8197d5e86}{u2c});
  motor\_num = \hyperlink{lsredis_8c_a1923f998441f4f451204dfd214d52218}{lsredis\_getl}(   mp->\hyperlink{structlspmac__motor__struct_ad6a51cca3c7e5f79168e5c33fd9e736b}{motor\_num});
  coord\_num = \hyperlink{lsredis_8c_a1923f998441f4f451204dfd214d52218}{lsredis\_getl}(   mp->\hyperlink{structlspmac__motor__struct_a5614e003272e8323f8809bf7b6559532}{coord\_num});
  axis      = \hyperlink{lsredis_8c_ac1994e56114b2315294527d76311f829}{lsredis\_getstr}( mp->\hyperlink{structlspmac__motor__struct_a7437ef16c2dce65bde4dda1ea00e9df3}{axis});

  \textcolor{keywordflow}{if}( u2c == 0.0) \{
    \textcolor{comment}{//}
    \textcolor{comment}{// Shouldn't try moving a motor that has no units defined}
    \textcolor{comment}{//}
    pthread\_mutex\_unlock( &(mp->\hyperlink{structlspmac__motor__struct_a188c5b1e991750ce2ffd53e0192e0907}{mutex}));
    \textcolor{keywordflow}{return};
  \}
  mp->\hyperlink{structlspmac__motor__struct_af8cdc94c6e2478b12ce942d4cf1d7499}{requested\_position} = requested\_position;
  mp->\hyperlink{structlspmac__motor__struct_ab7bd8bff48953ce05c758598d75877ac}{not\_done}     = 1;
  mp->\hyperlink{structlspmac__motor__struct_a68c471836f52707fa8582f7860cf500f}{motion\_seen}  = 0;
  mp->\hyperlink{structlspmac__motor__struct_a59a7f007476b2428fd3c5bd7f24440e8}{command\_sent} = 0;
  mp->\hyperlink{structlspmac__motor__struct_a6e8dc9c11dc52a439fe9837230f93ce2}{requested\_pos\_cnts} = u2c * requested\_position;  
  requested\_pos\_cnts = mp->\hyperlink{structlspmac__motor__struct_a6e8dc9c11dc52a439fe9837230f93ce2}{requested\_pos\_cnts};

  \textcolor{keywordflow}{if}( use\_jog || axis == NULL || *axis == 0) \{
    use\_jog = 1;
  \} \textcolor{keywordflow}{else} \{
    use\_jog = 0;
    q100 = 1 << (coord\_num -1);
  \}

  pthread\_mutex\_unlock( &(mp->\hyperlink{structlspmac__motor__struct_a188c5b1e991750ce2ffd53e0192e0907}{mutex}));

  \textcolor{keywordflow}{if}( !use\_jog) \{
    \textcolor{comment}{//}
    \textcolor{comment}{// Make sure the coordinate system is not moving something, wait if it is}
    \textcolor{comment}{// TODO: put in a timeout so we have a way out if something goes wrong}
    \textcolor{comment}{// TODO: are we sure this thread is not the one moving it?}
    \textcolor{comment}{//}
    pthread\_mutex\_lock( &\hyperlink{lspmac_8c_a85679cac947e199c88794f8e5a12bf5f}{lspmac\_moving\_mutex});
    \hyperlink{lslogging_8c_a0e756b36671055ef02a8f04d2ba8a93b}{lslogging\_log\_message}( \textcolor{stringliteral}{"lspmac\_moveabs\_queue: waiting
       for previous moves to end.  lspmac\_moving\_flags = %0x"}, \hyperlink{lspmac_8c_a7a32c617c183166308241e270959df56}{lspmac\_moving\_flags}
      );
    \textcolor{keywordflow}{while}( (\hyperlink{lspmac_8c_a7a32c617c183166308241e270959df56}{lspmac\_moving\_flags} & q100) != 0)
      pthread\_cond\_wait( &\hyperlink{lspmac_8c_a57547d211906c981ef20257eba99f8df}{lspmac\_moving\_cond}, &
      \hyperlink{lspmac_8c_a85679cac947e199c88794f8e5a12bf5f}{lspmac\_moving\_mutex});
    pthread\_mutex\_unlock( &\hyperlink{lspmac_8c_a85679cac947e199c88794f8e5a12bf5f}{lspmac\_moving\_mutex});
    \hyperlink{lslogging_8c_a0e756b36671055ef02a8f04d2ba8a93b}{lslogging\_log\_message}( \textcolor{stringliteral}{"lspmac\_moveabs\_queue: Done. 
       lspmac\_moving\_flags = %0x"}, \hyperlink{lspmac_8c_a7a32c617c183166308241e270959df56}{lspmac\_moving\_flags});

    \textcolor{comment}{//}
    \textcolor{comment}{// Set the "we are moving this coordinate system" flag}
    \textcolor{comment}{//}
    \hyperlink{lspmac_8c_afab9e8f0502a92ee5cf93209af710f81}{lspmac\_SockSendDPline}( NULL, \textcolor{stringliteral}{"M5075=(M5075 | %d)"}, 
      q100);
    
    \textcolor{keywordflow}{switch}( *axis) \{
    \textcolor{keywordflow}{case} \textcolor{charliteral}{'A'}:
      fmt = \textcolor{stringliteral}{"&%d Q16=%d Q100=%d B146R"};
      \textcolor{keywordflow}{break};

    \textcolor{keywordflow}{case} \textcolor{charliteral}{'B'}:
      fmt = \textcolor{stringliteral}{"&%d Q17=%d Q100=%d B147R"};
      \textcolor{keywordflow}{break};

    \textcolor{keywordflow}{case} \textcolor{charliteral}{'C'}:
      fmt = \textcolor{stringliteral}{"&%d Q18=%d Q100=%d B148R"};
      \textcolor{keywordflow}{break};
    \textcolor{keywordflow}{case} \textcolor{charliteral}{'X'}:
      fmt = \textcolor{stringliteral}{"&%d Q10=%d Q100=%d B140R"};
      \textcolor{keywordflow}{break};

    \textcolor{keywordflow}{case} \textcolor{charliteral}{'Y'}:
      fmt = \textcolor{stringliteral}{"&%d Q11=%d Q100=%d B141R"};
      \textcolor{keywordflow}{break};

    \textcolor{keywordflow}{case} \textcolor{charliteral}{'Z'}:
      fmt = \textcolor{stringliteral}{"&%d Q12=%d Q100=%d B142R"};
      \textcolor{keywordflow}{break};

    \textcolor{keywordflow}{case} \textcolor{charliteral}{'U'}:
      fmt = \textcolor{stringliteral}{"&%d Q13=%d Q100=%d B143R"};
      \textcolor{keywordflow}{break};

    \textcolor{keywordflow}{case} \textcolor{charliteral}{'V'}:
      fmt = \textcolor{stringliteral}{"&%d Q14=%d Q100=%d B144R"};
      \textcolor{keywordflow}{break};

    \textcolor{keywordflow}{case} \textcolor{charliteral}{'W'}:
      fmt = \textcolor{stringliteral}{"&%d Q15=%d Q100=%d B145R"};
      \textcolor{keywordflow}{break};
    \}

    \textcolor{comment}{//}
    \textcolor{comment}{// Make sure the flag has been seen}
    \textcolor{comment}{//}
    pthread\_mutex\_lock( &\hyperlink{lspmac_8c_a85679cac947e199c88794f8e5a12bf5f}{lspmac\_moving\_mutex});
    \hyperlink{lslogging_8c_a0e756b36671055ef02a8f04d2ba8a93b}{lslogging\_log\_message}( \textcolor{stringliteral}{"lspmac\_moveabs\_queue: waiting
       for moving flag to propagate.  lspmac\_moving\_flags = %0x"}, \hyperlink{lspmac_8c_a7a32c617c183166308241e270959df56}{lspmac\_moving\_flags}
      );
    \textcolor{keywordflow}{while}( (\hyperlink{lspmac_8c_a7a32c617c183166308241e270959df56}{lspmac\_moving\_flags} & q100) == 0)
      pthread\_cond\_wait( &\hyperlink{lspmac_8c_a57547d211906c981ef20257eba99f8df}{lspmac\_moving\_cond}, &
      \hyperlink{lspmac_8c_a85679cac947e199c88794f8e5a12bf5f}{lspmac\_moving\_mutex});
    pthread\_mutex\_unlock( &\hyperlink{lspmac_8c_a85679cac947e199c88794f8e5a12bf5f}{lspmac\_moving\_mutex});
    \hyperlink{lslogging_8c_a0e756b36671055ef02a8f04d2ba8a93b}{lslogging\_log\_message}( \textcolor{stringliteral}{"lspmac\_moveabs\_queue: Done. 
       lspmac\_moving\_flags = %0x"}, \hyperlink{lspmac_8c_a7a32c617c183166308241e270959df56}{lspmac\_moving\_flags});
  \}
  pthread\_mutex\_lock( &(mp->\hyperlink{structlspmac__motor__struct_a188c5b1e991750ce2ffd53e0192e0907}{mutex}));
  \textcolor{keywordflow}{if}( use\_jog) \{
    \hyperlink{lspmac_8c_afab9e8f0502a92ee5cf93209af710f81}{lspmac\_SockSendDPline}( mp->\hyperlink{structlspmac__motor__struct_aa90af2f6f1489f1befe1d0891e51575a}{name}, \textcolor{stringliteral}{"#%d j=%d"}, 
      motor\_num, requested\_pos\_cnts);
  \} \textcolor{keywordflow}{else} \{
    \hyperlink{lspmac_8c_afab9e8f0502a92ee5cf93209af710f81}{lspmac\_SockSendDPline}( mp->\hyperlink{structlspmac__motor__struct_aa90af2f6f1489f1befe1d0891e51575a}{name}, fmt, coord\_num, 
      requested\_pos\_cnts, q100);
  \}
  pthread\_mutex\_unlock( &(mp->\hyperlink{structlspmac__motor__struct_a188c5b1e991750ce2ffd53e0192e0907}{mutex}));

  free( axis);
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_adeec17e53dfc490f2a954b97fe95f0a7}{\index{pgpmac.\-h@{pgpmac.\-h}!lspmac\-\_\-move\-\_\-or\-\_\-jog\-\_\-preset\-\_\-queue@{lspmac\-\_\-move\-\_\-or\-\_\-jog\-\_\-preset\-\_\-queue}}
\index{lspmac\-\_\-move\-\_\-or\-\_\-jog\-\_\-preset\-\_\-queue@{lspmac\-\_\-move\-\_\-or\-\_\-jog\-\_\-preset\-\_\-queue}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspmac\-\_\-move\-\_\-or\-\_\-jog\-\_\-preset\-\_\-queue}]{\setlength{\rightskip}{0pt plus 5cm}void lspmac\-\_\-move\-\_\-or\-\_\-jog\-\_\-preset\-\_\-queue (
\begin{DoxyParamCaption}
\item[{{\bf lspmac\-\_\-motor\-\_\-t} $\ast$}]{, }
\item[{char $\ast$}]{, }
\item[{int}]{}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_adeec17e53dfc490f2a954b97fe95f0a7}


move using a preset value 



Definition at line 2635 of file lspmac.\-c.


\begin{DoxyCode}
                                       \{
  \textcolor{keywordtype}{double} pos;
  \textcolor{keywordtype}{int} err;

  \textcolor{keywordflow}{if}( preset == NULL || *preset == 0)
    \textcolor{keywordflow}{return};

  err = \hyperlink{lsredis_8c_a1ad60526a09ca679f39174ce5d773abe}{lsredis\_find\_preset}( mp->name, preset, &pos);

  \textcolor{keywordflow}{if}( err != 0)
    \hyperlink{lspmac_8c_a4ccd25a1a3a83cd7c9187975e52a9484}{lspmac\_move\_or\_jog\_abs\_queue}( mp, pos, use\_jog)
      ;
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_a6809c317931c4af226e0a0217764afae}{\index{pgpmac.\-h@{pgpmac.\-h}!lspmac\-\_\-move\-\_\-or\-\_\-jog\-\_\-queue@{lspmac\-\_\-move\-\_\-or\-\_\-jog\-\_\-queue}}
\index{lspmac\-\_\-move\-\_\-or\-\_\-jog\-\_\-queue@{lspmac\-\_\-move\-\_\-or\-\_\-jog\-\_\-queue}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspmac\-\_\-move\-\_\-or\-\_\-jog\-\_\-queue}]{\setlength{\rightskip}{0pt plus 5cm}void lspmac\-\_\-move\-\_\-or\-\_\-jog\-\_\-queue (
\begin{DoxyParamCaption}
\item[{{\bf lspmac\-\_\-motor\-\_\-t} $\ast$}]{, }
\item[{double}]{, }
\item[{int}]{}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_a6809c317931c4af226e0a0217764afae}
\hypertarget{pgpmac_8h_a6f5751d89f83b4b436c6f8bc636e4156}{\index{pgpmac.\-h@{pgpmac.\-h}!lspmac\-\_\-move\-\_\-preset\-\_\-queue@{lspmac\-\_\-move\-\_\-preset\-\_\-queue}}
\index{lspmac\-\_\-move\-\_\-preset\-\_\-queue@{lspmac\-\_\-move\-\_\-preset\-\_\-queue}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspmac\-\_\-move\-\_\-preset\-\_\-queue}]{\setlength{\rightskip}{0pt plus 5cm}void lspmac\-\_\-move\-\_\-preset\-\_\-queue (
\begin{DoxyParamCaption}
\item[{{\bf lspmac\-\_\-motor\-\_\-t} $\ast$}]{mp, }
\item[{char $\ast$}]{preset\-\_\-name}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_a6f5751d89f83b4b436c6f8bc636e4156}


Move a given motor to one of its preset positions. 

No movement if the preset is not found. 
\begin{DoxyParams}{Parameters}
{\em mp} & lspmac motor pointer \\
\hline
{\em name} & Name of the preset to use \\
\hline
\end{DoxyParams}


Definition at line 2284 of file lspmac.\-c.


\begin{DoxyCode}
                                                                      \{
  \textcolor{keywordtype}{double} pos;
  \textcolor{keywordtype}{int} err;

  \hyperlink{lslogging_8c_a0e756b36671055ef02a8f04d2ba8a93b}{lslogging\_log\_message}( \textcolor{stringliteral}{"lspmac\_move\_preset\_queue: Called
       with motor %s and preset named '%s'"}, mp->\hyperlink{structlspmac__motor__struct_aa90af2f6f1489f1befe1d0891e51575a}{name}, preset\_name);

  err = \hyperlink{lsredis_8c_a1ad60526a09ca679f39174ce5d773abe}{lsredis\_find\_preset}( mp->\hyperlink{structlspmac__motor__struct_aa90af2f6f1489f1befe1d0891e51575a}{name}, preset\_name, &pos
      );
  \textcolor{keywordflow}{if}( err == 0)
    \textcolor{keywordflow}{return};

  mp->\hyperlink{structlspmac__motor__struct_a20db3de86854b627815b3d940555ea75}{moveAbs}( mp, pos);
  \hyperlink{lslogging_8c_a0e756b36671055ef02a8f04d2ba8a93b}{lslogging\_log\_message}( \textcolor{stringliteral}{"lspmac\_move\_preset\_queue: moving
       %s to preset '%s' (%f)"}, mp->\hyperlink{structlspmac__motor__struct_aa90af2f6f1489f1befe1d0891e51575a}{name}, preset\_name, pos);
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_af9edebb71a4ebca5dad3df63164e2004}{\index{pgpmac.\-h@{pgpmac.\-h}!lspmac\-\_\-moveabs\-\_\-queue@{lspmac\-\_\-moveabs\-\_\-queue}}
\index{lspmac\-\_\-moveabs\-\_\-queue@{lspmac\-\_\-moveabs\-\_\-queue}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspmac\-\_\-moveabs\-\_\-queue}]{\setlength{\rightskip}{0pt plus 5cm}void lspmac\-\_\-moveabs\-\_\-queue (
\begin{DoxyParamCaption}
\item[{{\bf lspmac\-\_\-motor\-\_\-t} $\ast$}]{, }
\item[{double}]{}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_af9edebb71a4ebca5dad3df63164e2004}


Use coordinate system motion program, if available, to move motor to requested position. 



Definition at line 2655 of file lspmac.\-c.


\begin{DoxyCode}
                            \{
  
  \hyperlink{lspmac_8c_a4ccd25a1a3a83cd7c9187975e52a9484}{lspmac\_move\_or\_jog\_abs\_queue}( mp, 
      requested\_position, 0);
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_aae2282edace621ee65c682d03b7ccc36}{\index{pgpmac.\-h@{pgpmac.\-h}!lspmac\-\_\-moveabs\-\_\-wait@{lspmac\-\_\-moveabs\-\_\-wait}}
\index{lspmac\-\_\-moveabs\-\_\-wait@{lspmac\-\_\-moveabs\-\_\-wait}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspmac\-\_\-moveabs\-\_\-wait}]{\setlength{\rightskip}{0pt plus 5cm}void lspmac\-\_\-moveabs\-\_\-wait (
\begin{DoxyParamCaption}
\item[{{\bf lspmac\-\_\-motor\-\_\-t} $\ast$}]{mp}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_aae2282edace621ee65c682d03b7ccc36}


Wait for motor to finish moving. 

Assume motion already queued, now just wait 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em mp} & The motor object to wait for \\
\hline
\end{DoxyParams}


Definition at line 2677 of file lspmac.\-c.


\begin{DoxyCode}
                           \{
  \textcolor{keyword}{struct }timespec wt;
  \textcolor{keywordtype}{int} return\_code;

  \textcolor{comment}{//}
  \textcolor{comment}{// Copy the queue item for the most recent move request}
  \textcolor{comment}{//}
  pthread\_mutex\_lock( &(mp->\hyperlink{structlspmac__motor__struct_a188c5b1e991750ce2ffd53e0192e0907}{mutex}));
  
  \textcolor{keywordflow}{while}( mp->\hyperlink{structlspmac__motor__struct_a59a7f007476b2428fd3c5bd7f24440e8}{command\_sent} == 0)
    pthread\_cond\_wait( &mp->\hyperlink{structlspmac__motor__struct_aa0ea4108b8fed5b41ff91ca7266f3d84}{cond}, &mp->\hyperlink{structlspmac__motor__struct_a188c5b1e991750ce2ffd53e0192e0907}{mutex});
  pthread\_mutex\_unlock( &(mp->\hyperlink{structlspmac__motor__struct_a188c5b1e991750ce2ffd53e0192e0907}{mutex}));

  \textcolor{comment}{//}
  \textcolor{comment}{// wait for the motion to have started}
  \textcolor{comment}{// This will time out if the motion ends before we can read the status back}
  \textcolor{comment}{// hence the added complication of time stamp of the sent packet.}
  \textcolor{comment}{//}
  \textcolor{comment}{// This sets up a one second wait}
  \textcolor{comment}{//}
  clock\_gettime( CLOCK\_REALTIME, &wt);
  wt.tv\_sec++;

  return\_code=0;

  pthread\_mutex\_lock( &(mp->\hyperlink{structlspmac__motor__struct_a188c5b1e991750ce2ffd53e0192e0907}{mutex}));
  \textcolor{keywordflow}{while}( mp->\hyperlink{structlspmac__motor__struct_a68c471836f52707fa8582f7860cf500f}{motion\_seen} == 0 && return\_code == 0)
    return\_code = pthread\_cond\_timedwait( &(mp->\hyperlink{structlspmac__motor__struct_aa0ea4108b8fed5b41ff91ca7266f3d84}{cond}), &(mp->\hyperlink{structlspmac__motor__struct_a188c5b1e991750ce2ffd53e0192e0907}{mutex}), &
      wt);
  
  \textcolor{keywordflow}{if}( return\_code == 0) \{
    \textcolor{comment}{//}
    \textcolor{comment}{// wait for the motion that we know has started to finish}
    \textcolor{comment}{//}
    \textcolor{keywordflow}{while}( mp->\hyperlink{structlspmac__motor__struct_ab7bd8bff48953ce05c758598d75877ac}{not\_done})
      pthread\_cond\_wait( &(mp->\hyperlink{structlspmac__motor__struct_aa0ea4108b8fed5b41ff91ca7266f3d84}{cond}), &(mp->\hyperlink{structlspmac__motor__struct_a188c5b1e991750ce2ffd53e0192e0907}{mutex}));
  \}

  \textcolor{comment}{//}
  \textcolor{comment}{// if return code was not 0 then we know we shouldn't wait for not\_done flag.}
  \textcolor{comment}{// In this case the motion ended before we read the status registers}
  \textcolor{comment}{//}
  pthread\_mutex\_unlock( &(mp->\hyperlink{structlspmac__motor__struct_a188c5b1e991750ce2ffd53e0192e0907}{mutex}));

\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_a3a7fb93fb3fb9c4454613f30bfb0b1ee}{\index{pgpmac.\-h@{pgpmac.\-h}!lspmac\-\_\-run@{lspmac\-\_\-run}}
\index{lspmac\-\_\-run@{lspmac\-\_\-run}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspmac\-\_\-run}]{\setlength{\rightskip}{0pt plus 5cm}void lspmac\-\_\-run (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_a3a7fb93fb3fb9c4454613f30bfb0b1ee}


Start up the lspmac thread. 



Definition at line 3263 of file lspmac.\-c.


\begin{DoxyCode}
                  \{
  \textcolor{keywordtype}{char} **inits;
  \hyperlink{structlspmac__motor__struct}{lspmac\_motor\_t} *mp;
  \textcolor{keywordtype}{char} evts[64];
  \textcolor{keywordtype}{int} \hyperlink{namespacemk__pgpmac__redis_afa643a23a5984fe44c2182ada3dfa401}{i};
  \textcolor{keywordtype}{int} active;

  pthread\_create( &\hyperlink{lspmac_8c_a6b7011dd7d2c2d3afadff8d3e50e7677}{pmac\_thread}, NULL, \hyperlink{lspmac_8c_abdec5883055967b1eda043670870f55f}{lspmac\_worker}, 
      NULL);

  \hyperlink{lsevents_8c_ab0617d3f0594b51d10e34bf397096654}{lsevents\_add\_listener}( \textcolor{stringliteral}{"CryoSwitchChanged"},    
      \hyperlink{lspmac_8c_afc00ddac633f8c8a3a699e3d22de2770}{lspmac\_cryoSwitchChanged\_cb});
  \hyperlink{lsevents_8c_ab0617d3f0594b51d10e34bf397096654}{lsevents\_add\_listener}( \textcolor{stringliteral}{"scint In Position"},    
      \hyperlink{lspmac_8c_a8707350625ca81a089a90f8b64ce6d28}{lspmac\_scint\_inPosition\_cb});
  \hyperlink{lsevents_8c_ab0617d3f0594b51d10e34bf397096654}{lsevents\_add\_listener}( \textcolor{stringliteral}{"scintDried"},           
      \hyperlink{lspmac_8c_a585676eb411025c7b44da958d4e98eb2}{lspmac\_scint\_dried\_cb});
  \hyperlink{lsevents_8c_ab0617d3f0594b51d10e34bf397096654}{lsevents\_add\_listener}( \textcolor{stringliteral}{"backLight 1"},             
      \hyperlink{lspmac_8c_a094f66824c57b27c9dad2ca36bd75e44}{lspmac\_backLight\_up\_cb});
  \hyperlink{lsevents_8c_ab0617d3f0594b51d10e34bf397096654}{lsevents\_add\_listener}( \textcolor{stringliteral}{"backLight 0"},             
      \hyperlink{lspmac_8c_a571cf14b82b5aae163af5aec3201cd3e}{lspmac\_backLight\_down\_cb});
  \hyperlink{lsevents_8c_ab0617d3f0594b51d10e34bf397096654}{lsevents\_add\_listener}( \textcolor{stringliteral}{"cam.zoom In Position"}, 
      \hyperlink{lspmac_8c_a55791bd8a07e5ca1dd2aeedf3c23942c}{lspmac\_light\_zoom\_cb});

  \textcolor{keywordflow}{for}( i=0; i<\hyperlink{lspmac_8c_a56260f012c50a591ee7f97e500f16994}{lspmac\_nmotors}; i++) \{
    snprintf( evts, \textcolor{keyword}{sizeof}( evts)-1, \textcolor{stringliteral}{"%s command done"}, \hyperlink{lspmac_8c_a894c709ddd0652583d6db22e86282503}{lspmac\_motors}
      [i].name);
    evts[\textcolor{keyword}{sizeof}(evts)-1] = 0;
    \hyperlink{lsevents_8c_ab0617d3f0594b51d10e34bf397096654}{lsevents\_add\_listener}( evts, \hyperlink{lspmac_8c_a611168a1076b2de45c596ed95c68445a}{lspmac\_command\_done\_cb}
      );
  \}



  \hyperlink{lspmac_8c_a3816a9a1a3bb5bb89fcec8a30d863970}{lspmac\_zoom\_lut\_setup}();
  \hyperlink{lspmac_8c_ad52a5dbc2f06247eca7619195936b85f}{lspmac\_flight\_lut\_setup}();
  \hyperlink{lspmac_8c_a4aa8c178a56276eb64138d52fe65dc8c}{lspmac\_blight\_lut\_setup}();
  \hyperlink{lspmac_8c_a54ceac41b127ad8bbad07bd90c6729dc}{lspmac\_fscint\_lut\_setup}();

  \textcolor{comment}{//}
  \textcolor{comment}{// Clear the command interfaces}
  \textcolor{comment}{//}
  \hyperlink{lspmac_8c_a8707477f9799b4cc8c6f465ecfeee24b}{lspmac\_SockSendControlCharPrint}( NULL, \textcolor{stringliteral}{'\(\backslash\)x18'})
      ;
  \{
    uint32\_t cc;
    cc = 0;
    \hyperlink{lspmac_8c_ac60f32e1ab6d81a60155e355db752726}{lspmac\_send\_command}( \hyperlink{lspmac_8c_a5485d08fdc80533b5cebadff63696ed2}{VR\_UPLOAD}, \hyperlink{lspmac_8c_ab79207cc3145740f8c070a24c91b11e0}{VR\_PMAC\_SETMEM}
      , 0x0e9e, 0, 4, (\textcolor{keywordtype}{char} *)&cc, NULL, 1, NULL);

    cc = 0x18;
    \hyperlink{lspmac_8c_ac60f32e1ab6d81a60155e355db752726}{lspmac\_send\_command}( \hyperlink{lspmac_8c_a5485d08fdc80533b5cebadff63696ed2}{VR\_UPLOAD}, \hyperlink{lspmac_8c_ab79207cc3145740f8c070a24c91b11e0}{VR\_PMAC\_SETMEM}
      , 0x0e9e, 0, 4, (\textcolor{keywordtype}{char} *)&cc, NULL, 1, NULL);
  \}

  \textcolor{comment}{//}
  \textcolor{comment}{// Initialize the MD2 pmac (ie, turn on the right plcc's etc)}
  \textcolor{comment}{//}
  \textcolor{comment}{/*}
\textcolor{comment}{  for( inits = lsredis\_get\_string\_array(lspmac\_md2\_init); *inits != NULL;
       inits++) \{}
\textcolor{comment}{    lspmac\_SockSendDPline( NULL, *inits);}
\textcolor{comment}{  \}}
\textcolor{comment}{  */}

  \textcolor{comment}{//}
  \textcolor{comment}{// Initialize the pmac's support for each motor}
  \textcolor{comment}{// (ie, set the various flag for when a motor is active or not)}
  \textcolor{comment}{//}
  \textcolor{keywordflow}{for}( i=0; i<\hyperlink{lspmac_8c_a56260f012c50a591ee7f97e500f16994}{lspmac\_nmotors}; i++) \{
    mp = &(\hyperlink{lspmac_8c_a894c709ddd0652583d6db22e86282503}{lspmac\_motors}[\hyperlink{namespacemk__pgpmac__redis_afa643a23a5984fe44c2182ada3dfa401}{i}]);
    active = \hyperlink{lsredis_8c_abbb4e5ece19ebd130e1be18036752a08}{lsredis\_getb}( mp->\hyperlink{structlspmac__motor__struct_aed4998885bcd5a2a30069637180f58e3}{active});

    \textcolor{comment}{// if there is a problem with "active" then don't do anything}
    \textcolor{comment}{// On the other hand, various combinations of yes/no true/fals 1/0 should
       work}
    \textcolor{comment}{//}
    \textcolor{keywordflow}{switch}( active) \{
    \textcolor{keywordflow}{case} 1:
      inits = \hyperlink{lsredis_8c_abe31d0e11c41b2235307612c963bb652}{lsredis\_get\_string\_array}( mp->\hyperlink{structlspmac__motor__struct_ac2a02f137e4a35db816bc728290d3558}{active\_init}
      );
      \textcolor{keywordflow}{break};

    \textcolor{keywordflow}{case} 0:
      inits = \hyperlink{lsredis_8c_abe31d0e11c41b2235307612c963bb652}{lsredis\_get\_string\_array}( mp->
      \hyperlink{structlspmac__motor__struct_ab329ce9b277eca9984c18417dece7bf7}{inactive\_init});
      \textcolor{keywordflow}{break};

    \textcolor{keywordflow}{default}:
      \hyperlink{lslogging_8c_a0e756b36671055ef02a8f04d2ba8a93b}{lslogging\_log\_message}( \textcolor{stringliteral}{"lspmac\_run: motor %s is
       neither active nor inactive (!?)"}, mp->\hyperlink{structlspmac__motor__struct_aa90af2f6f1489f1befe1d0891e51575a}{name});
      inits = NULL;
    \}
    \textcolor{keywordflow}{if}( inits != NULL) \{
      \textcolor{keywordflow}{while}( *inits != NULL) \{
        \hyperlink{lspmac_8c_afab9e8f0502a92ee5cf93209af710f81}{lspmac\_SockSendDPline}( NULL, *inits);
        inits++;
      \}
    \}
  \}
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_a49a53bb92535ca2b62208dce41760fbb}{\index{pgpmac.\-h@{pgpmac.\-h}!lspmac\-\_\-\-Sock\-Send\-D\-Pline@{lspmac\-\_\-\-Sock\-Send\-D\-Pline}}
\index{lspmac\-\_\-\-Sock\-Send\-D\-Pline@{lspmac\-\_\-\-Sock\-Send\-D\-Pline}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspmac\-\_\-\-Sock\-Send\-D\-Pline}]{\setlength{\rightskip}{0pt plus 5cm}void lspmac\-\_\-\-Sock\-Send\-D\-Pline (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{, }
\item[{char $\ast$}]{fmt, }
\item[{}]{...}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_a49a53bb92535ca2b62208dce41760fbb}


prepare (queue up) a line to send the dpram ascii command interface 



Definition at line 1910 of file lspmac.\-c.


\begin{DoxyCode}
                                                         \{
  va\_list arg\_ptr;
  uint32\_t index;
  \textcolor{keywordtype}{char} *pl;
  
  pthread\_mutex\_lock( &\hyperlink{lspmac_8c_a2ff142105e17d933871d09759e7082f8}{lspmac\_ascii\_mutex});
  index = \hyperlink{lspmac_8c_a09701de0235acaeae5abf4e04268be33}{lspmac\_dpascii\_on}++ % \hyperlink{lspmac_8c_a3a407e2e4d57ac45ecd700f8bad3d3b5}{LSPMAC\_DPASCII\_QUEUE\_LENGTH}
      ;

  pl = \hyperlink{lspmac_8c_a2bd5340143f40b5e6404a381fb438710}{lspmac\_dpascii\_queue}[index].\hyperlink{structlspmac__dpascii__queue__struct_a318d65317b14eba9e38efd0ab0133a5c}{pl};

  va\_start( arg\_ptr, fmt);
  vsnprintf( pl, 159, fmt, arg\_ptr);
  pl[159] = 0;
  va\_end( arg\_ptr);

  \hyperlink{lspmac_8c_a2bd5340143f40b5e6404a381fb438710}{lspmac\_dpascii\_queue}[index].\hyperlink{structlspmac__dpascii__queue__struct_a8775c09713a917f4ddd80a3a5a8a4668}{event} = event;

  pthread\_mutex\_unlock( &\hyperlink{lspmac_8c_a2ff142105e17d933871d09759e7082f8}{lspmac\_ascii\_mutex});
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_a79f86193e36c823157049061b94627a7}{\index{pgpmac.\-h@{pgpmac.\-h}!lspmac\-\_\-\-Sock\-Sendline@{lspmac\-\_\-\-Sock\-Sendline}}
\index{lspmac\-\_\-\-Sock\-Sendline@{lspmac\-\_\-\-Sock\-Sendline}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspmac\-\_\-\-Sock\-Sendline}]{\setlength{\rightskip}{0pt plus 5cm}{\bf pmac\-\_\-cmd\-\_\-queue\-\_\-t}$\ast$ lspmac\-\_\-\-Sock\-Sendline (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{event, }
\item[{char $\ast$}]{fmt, }
\item[{}]{...}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_a79f86193e36c823157049061b94627a7}


Send a one line command. 

Uses printf style arguments. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em event} & base name for events \\
\hline
\mbox{\tt in}  & {\em fmt} & Printf style format string \\
\hline
\end{DoxyParams}


Definition at line 1058 of file lspmac.\-c.


\begin{DoxyCode}
                                         \{
  va\_list arg\_ptr;
  \textcolor{keywordtype}{char} payload[1400];

  va\_start( arg\_ptr, fmt);
  vsnprintf( payload, \textcolor{keyword}{sizeof}(payload)-1, fmt, arg\_ptr);
  payload[ \textcolor{keyword}{sizeof}(payload)-1] = 0;
  va\_end( arg\_ptr);

  \hyperlink{lslogging_8c_a0e756b36671055ef02a8f04d2ba8a93b}{lslogging\_log\_message}( payload);

  \textcolor{keywordflow}{return} \hyperlink{lspmac_8c_ac60f32e1ab6d81a60155e355db752726}{lspmac\_send\_command}( \hyperlink{lspmac_8c_af24ecdc10723dc8fd6320fef416ae514}{VR\_DOWNLOAD}, 
      \hyperlink{lspmac_8c_a772b2ea2ad93989ae4275c79a93525ee}{VR\_PMAC\_SENDLINE}, 0, 0, strlen( payload), payload, 
      \hyperlink{lspmac_8c_a81e8e315099cf9b6eef0335b01f97bfd}{lspmac\_GetShortReplyCB}, 0, event);
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_aa8bf745a9ec388783009e2275a8b56f8}{\index{pgpmac.\-h@{pgpmac.\-h}!lspmac\-\_\-video\-\_\-rotate@{lspmac\-\_\-video\-\_\-rotate}}
\index{lspmac\-\_\-video\-\_\-rotate@{lspmac\-\_\-video\-\_\-rotate}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspmac\-\_\-video\-\_\-rotate}]{\setlength{\rightskip}{0pt plus 5cm}void lspmac\-\_\-video\-\_\-rotate (
\begin{DoxyParamCaption}
\item[{double}]{secs}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_aa8bf745a9ec388783009e2275a8b56f8}


Special motion program to collect centering video. 



Definition at line 2486 of file lspmac.\-c.


\begin{DoxyCode}
                                       \{
  \textcolor{keywordtype}{double} q10;           \textcolor{comment}{// starting position (counts)}
  \textcolor{keywordtype}{double} q11;           \textcolor{comment}{// delta counts}
  \textcolor{keywordtype}{double} q12;           \textcolor{comment}{// milliseconds to run over delta}
  
  \textcolor{keywordtype}{double} u2c;

  \textcolor{keywordflow}{if}( secs <= 0.0)
    \textcolor{keywordflow}{return};

  \hyperlink{lspmac_8c_ae06d2291c1996ffb7dcf7d132e25b038}{omega\_zero\_search} = 1;

  pthread\_mutex\_lock( &(\hyperlink{lspmac_8c_a8237e646ce032a840637a4ef7bff49b9}{omega}->\hyperlink{structlspmac__motor__struct_a188c5b1e991750ce2ffd53e0192e0907}{mutex}));
  u2c = \hyperlink{lsredis_8c_aa8daf63b794b6b6341018feec205cb7d}{lsredis\_getd}( \hyperlink{lspmac_8c_a8237e646ce032a840637a4ef7bff49b9}{omega}->\hyperlink{structlspmac__motor__struct_a8838915ebb6f9989944117c8197d5e86}{u2c});

  q10 = 0;
  q11 = 360.0 * u2c;
  q12 = 1000 * secs;
  

  \hyperlink{lspmac_8c_aea11895d2ec4a3324f4baa9d24cd192d}{omega\_zero\_velocity} = 360.0 * u2c / secs;  \textcolor{comment}{//
       counts/second to back calculate zero crossing time}

  \hyperlink{lspmac_8c_afab9e8f0502a92ee5cf93209af710f81}{lspmac\_SockSendDPline}( \hyperlink{lspmac_8c_a8237e646ce032a840637a4ef7bff49b9}{omega}->\hyperlink{structlspmac__motor__struct_aa90af2f6f1489f1befe1d0891e51575a}{name}, \textcolor{stringliteral}{"&1
       Q10=%.1f Q11=%.1f Q12=%.1f Q13=(I117) Q14=(I116) B240R"}, q10, q11, q12);
  pthread\_mutex\_unlock( &(\hyperlink{lspmac_8c_a8237e646ce032a840637a4ef7bff49b9}{omega}->\hyperlink{structlspmac__motor__struct_a188c5b1e991750ce2ffd53e0192e0907}{mutex}));
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_ac356cd43e46799929242dcf5214df7f6}{\index{pgpmac.\-h@{pgpmac.\-h}!lsredis\-\_\-cmpnstr@{lsredis\-\_\-cmpnstr}}
\index{lsredis\-\_\-cmpnstr@{lsredis\-\_\-cmpnstr}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lsredis\-\_\-cmpnstr}]{\setlength{\rightskip}{0pt plus 5cm}int lsredis\-\_\-cmpnstr (
\begin{DoxyParamCaption}
\item[{{\bf lsredis\-\_\-obj\-\_\-t} $\ast$}]{p, }
\item[{char $\ast$}]{s, }
\item[{int}]{n}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_ac356cd43e46799929242dcf5214df7f6}


Definition at line 235 of file lsredis.\-c.


\begin{DoxyCode}
                                                       \{
  \textcolor{keywordtype}{int} rtn;
  pthread\_mutex\_lock( &p->\hyperlink{structlsredis__obj__struct_a0da18e7d0f7d52459bbc6fbc696d5252}{mutex});
  \textcolor{keywordflow}{while}( p->\hyperlink{structlsredis__obj__struct_a338ffa4123bd06b39c8b58f5e695575e}{valid} == 0)
    pthread\_cond\_wait( &p->\hyperlink{structlsredis__obj__struct_a356f6a228bb19ac7d66fdb1c875d68be}{cond}, &p->\hyperlink{structlsredis__obj__struct_a0da18e7d0f7d52459bbc6fbc696d5252}{mutex});
  
  rtn = strncmp( p->\hyperlink{structlsredis__obj__struct_a0465c65288e8101805a6f91049164517}{value}, s, n);
  pthread\_mutex\_unlock( &p->\hyperlink{structlsredis__obj__struct_a0da18e7d0f7d52459bbc6fbc696d5252}{mutex});
  \textcolor{keywordflow}{return} rtn;
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_a9fc8fd0db4c71c5eae68682b43103078}{\index{pgpmac.\-h@{pgpmac.\-h}!lsredis\-\_\-cmpstr@{lsredis\-\_\-cmpstr}}
\index{lsredis\-\_\-cmpstr@{lsredis\-\_\-cmpstr}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lsredis\-\_\-cmpstr}]{\setlength{\rightskip}{0pt plus 5cm}int lsredis\-\_\-cmpstr (
\begin{DoxyParamCaption}
\item[{{\bf lsredis\-\_\-obj\-\_\-t} $\ast$}]{p, }
\item[{char $\ast$}]{s}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_a9fc8fd0db4c71c5eae68682b43103078}


Definition at line 224 of file lsredis.\-c.


\begin{DoxyCode}
                                               \{
  \textcolor{keywordtype}{int} rtn;
  pthread\_mutex\_lock( &p->\hyperlink{structlsredis__obj__struct_a0da18e7d0f7d52459bbc6fbc696d5252}{mutex});
  \textcolor{keywordflow}{while}( p->\hyperlink{structlsredis__obj__struct_a338ffa4123bd06b39c8b58f5e695575e}{valid} == 0)
    pthread\_cond\_wait( &p->\hyperlink{structlsredis__obj__struct_a356f6a228bb19ac7d66fdb1c875d68be}{cond}, &p->\hyperlink{structlsredis__obj__struct_a0da18e7d0f7d52459bbc6fbc696d5252}{mutex});
  
  rtn = strcmp( p->\hyperlink{structlsredis__obj__struct_a0465c65288e8101805a6f91049164517}{value}, s);
  pthread\_mutex\_unlock( &p->\hyperlink{structlsredis__obj__struct_a0da18e7d0f7d52459bbc6fbc696d5252}{mutex});
  \textcolor{keywordflow}{return} rtn;
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_a1ad60526a09ca679f39174ce5d773abe}{\index{pgpmac.\-h@{pgpmac.\-h}!lsredis\-\_\-find\-\_\-preset@{lsredis\-\_\-find\-\_\-preset}}
\index{lsredis\-\_\-find\-\_\-preset@{lsredis\-\_\-find\-\_\-preset}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lsredis\-\_\-find\-\_\-preset}]{\setlength{\rightskip}{0pt plus 5cm}int lsredis\-\_\-find\-\_\-preset (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{base, }
\item[{char $\ast$}]{preset\-\_\-name, }
\item[{double $\ast$}]{dval}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_a1ad60526a09ca679f39174ce5d773abe}


Definition at line 755 of file lsredis.\-c.


\begin{DoxyCode}
                                                                      \{
  \textcolor{keywordtype}{char} s[512];
  \textcolor{keywordtype}{int} \hyperlink{namespacemk__pgpmac__redis_afa643a23a5984fe44c2182ada3dfa401}{i};
  \textcolor{keywordtype}{int} err;
  ENTRY htab\_input, *htab\_output;
  \hyperlink{structlsredis__obj__struct}{lsredis\_obj\_t} *\hyperlink{namespacemk__pgpmac__redis_a11daf2847f2dc94562b5b61b3f412574}{p};

  i = 0;
  \textcolor{keywordflow}{for}( i=0; i<1024; i++) \{
    snprintf( s, \textcolor{keyword}{sizeof}( s)-1, \textcolor{stringliteral}{"%s.%s.presets.%d.name"}, \hyperlink{lsredis_8c_acdca9095c7a3288d7febe9f4c440a6e9}{lsredis\_head}
      , base, i);
    s[\textcolor{keyword}{sizeof}(s)-1] = 0;
    htab\_input.key  = s;
    htab\_input.data = NULL;
    err = hsearch\_r( htab\_input, FIND, &htab\_output, &\hyperlink{lsredis_8c_a42aec6aa74072797ec0344847b0e9e39}{lsredis\_htab})
      ;
    \textcolor{keywordflow}{if}( err == 0) \{
      \textcolor{comment}{// We've run out of names to look for: done}
      \hyperlink{lslogging_8c_a0e756b36671055ef02a8f04d2ba8a93b}{lslogging\_log\_message}( \textcolor{stringliteral}{"lsredis\_find\_preset: no
       preset for motor %s named '%s'"}, base, preset\_name);
      *dval = 0.0;
      \textcolor{keywordflow}{return} 0;
    \}

    \textcolor{comment}{// Check if we have a match}
    p = htab\_output->data;
    \textcolor{keywordflow}{if}( \hyperlink{lsredis_8c_a9fc8fd0db4c71c5eae68682b43103078}{lsredis\_cmpstr}( p, preset\_name)==0) \{
      \textcolor{comment}{// got a match, now look for the position}
      snprintf( s, \textcolor{keyword}{sizeof}( s)-1, \textcolor{stringliteral}{"%s.%s.presets.%d.position"}, \hyperlink{lsredis_8c_acdca9095c7a3288d7febe9f4c440a6e9}{lsredis\_head}
      , base, i);
      s[\textcolor{keyword}{sizeof}(s)-1] = 0;
      htab\_input.key = s;
      htab\_input.data = NULL;
      err = hsearch\_r( htab\_input, FIND, &htab\_output, &\hyperlink{lsredis_8c_a42aec6aa74072797ec0344847b0e9e39}{lsredis\_htab}
      );
      \textcolor{keywordflow}{if}( err == 0) \{
        \textcolor{comment}{// Name but not position? odd.}
        \hyperlink{lslogging_8c_a0e756b36671055ef02a8f04d2ba8a93b}{lslogging\_log\_message}( \textcolor{stringliteral}{"lsredis\_find\_preset:
       Error, motor %s preset '%s' has no position defined"}, base, preset\_name);
        *dval = 0.0;
        \textcolor{keywordflow}{return} 0;
      \}
      p = htab\_output->data;
      *dval = \hyperlink{lsredis_8c_aa8daf63b794b6b6341018feec205cb7d}{lsredis\_getd}( p);
      \textcolor{keywordflow}{return} 1;
    \}
  \}
  \textcolor{comment}{// How'd we get here?}
  \textcolor{comment}{// did someone really define that many presets?  And then looked for one
       that's not there?}
  *dval = 0;
  \textcolor{keywordflow}{return} 0;
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_a6d9f550b9ba36acd237925164abe3ffc}{\index{pgpmac.\-h@{pgpmac.\-h}!lsredis\-\_\-get\-\_\-obj@{lsredis\-\_\-get\-\_\-obj}}
\index{lsredis\-\_\-get\-\_\-obj@{lsredis\-\_\-get\-\_\-obj}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lsredis\-\_\-get\-\_\-obj}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lsredis\-\_\-obj\-\_\-t}$\ast$ lsredis\-\_\-get\-\_\-obj (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{, }
\item[{}]{...}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_a6d9f550b9ba36acd237925164abe3ffc}


Definition at line 523 of file lsredis.\-c.


\begin{DoxyCode}
                                                \{
  \hyperlink{structlsredis__obj__struct}{lsredis\_obj\_t} *rtn;
  va\_list arg\_ptr;
  \textcolor{keywordtype}{char} k[512];
  \textcolor{keywordtype}{char} *kp;
  \textcolor{keywordtype}{int} nkp;

  va\_start( arg\_ptr, fmt);
  vsnprintf( k, \textcolor{keyword}{sizeof}(k)-1, fmt, arg\_ptr);
  k[\textcolor{keyword}{sizeof}(k)-1] = 0;
  va\_end( arg\_ptr);

  nkp = strlen(k) + strlen( \hyperlink{lsredis_8c_acdca9095c7a3288d7febe9f4c440a6e9}{lsredis\_head}) + 16;             \textcolor{comment}{// 16
       is overkill. I know. Get over it.}
  kp = calloc( nkp, \textcolor{keyword}{sizeof}( \textcolor{keywordtype}{char}));
  \textcolor{keywordflow}{if}( kp == NULL) \{
    \hyperlink{lslogging_8c_a0e756b36671055ef02a8f04d2ba8a93b}{lslogging\_log\_message}( \textcolor{stringliteral}{"lsredis\_get\_obj: Out of memory
      "});
    exit( -1);
  \}
  
  snprintf( kp, nkp-1, \textcolor{stringliteral}{"%s.%s"}, \hyperlink{lsredis_8c_acdca9095c7a3288d7febe9f4c440a6e9}{lsredis\_head}, k);
  kp[nkp-1] = 0;

  pthread\_mutex\_lock( &\hyperlink{lsredis_8c_a390e8acf789b0fa41b43a794dd27e28f}{lsredis\_mutex});
  \textcolor{keywordflow}{while}( \hyperlink{lsredis_8c_a7461eb2b5974a2ffac2189007d39193c}{lsredis\_running} == 0)
    pthread\_cond\_wait( &\hyperlink{lsredis_8c_a2f63408d16b5603541b124a78f36a5a8}{lsredis\_cond}, &\hyperlink{lsredis_8c_a390e8acf789b0fa41b43a794dd27e28f}{lsredis\_mutex});

  rtn = \hyperlink{lsredis_8c_ac3fb8589e280bfa18ecbca6619fea637}{\_lsredis\_get\_obj}( kp);
  pthread\_mutex\_unlock( &\hyperlink{lsredis_8c_a390e8acf789b0fa41b43a794dd27e28f}{lsredis\_mutex});

  free( kp);
  \textcolor{keywordflow}{return} rtn;
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_abe31d0e11c41b2235307612c963bb652}{\index{pgpmac.\-h@{pgpmac.\-h}!lsredis\-\_\-get\-\_\-string\-\_\-array@{lsredis\-\_\-get\-\_\-string\-\_\-array}}
\index{lsredis\-\_\-get\-\_\-string\-\_\-array@{lsredis\-\_\-get\-\_\-string\-\_\-array}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lsredis\-\_\-get\-\_\-string\-\_\-array}]{\setlength{\rightskip}{0pt plus 5cm}char$\ast$$\ast$ lsredis\-\_\-get\-\_\-string\-\_\-array (
\begin{DoxyParamCaption}
\item[{{\bf lsredis\-\_\-obj\-\_\-t} $\ast$}]{p}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_abe31d0e11c41b2235307612c963bb652}


Definition at line 364 of file lsredis.\-c.


\begin{DoxyCode}
                                                   \{
  \textcolor{keywordtype}{char} **rtn;

  pthread\_mutex\_lock( &p->\hyperlink{structlsredis__obj__struct_a0da18e7d0f7d52459bbc6fbc696d5252}{mutex});
  \textcolor{keywordflow}{while}( p->\hyperlink{structlsredis__obj__struct_a338ffa4123bd06b39c8b58f5e695575e}{valid} == 0)
    pthread\_cond\_wait( &p->\hyperlink{structlsredis__obj__struct_a356f6a228bb19ac7d66fdb1c875d68be}{cond}, &p->\hyperlink{structlsredis__obj__struct_a0da18e7d0f7d52459bbc6fbc696d5252}{mutex});

  rtn = p->\hyperlink{structlsredis__obj__struct_ac065eeede0e08f25bcfedd45022fe593}{avalue};
  pthread\_mutex\_unlock( &p->\hyperlink{structlsredis__obj__struct_a0da18e7d0f7d52459bbc6fbc696d5252}{mutex});
  
  \textcolor{keywordflow}{return} rtn;
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_abbb4e5ece19ebd130e1be18036752a08}{\index{pgpmac.\-h@{pgpmac.\-h}!lsredis\-\_\-getb@{lsredis\-\_\-getb}}
\index{lsredis\-\_\-getb@{lsredis\-\_\-getb}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lsredis\-\_\-getb}]{\setlength{\rightskip}{0pt plus 5cm}int lsredis\-\_\-getb (
\begin{DoxyParamCaption}
\item[{{\bf lsredis\-\_\-obj\-\_\-t} $\ast$}]{p}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_abbb4e5ece19ebd130e1be18036752a08}


Definition at line 377 of file lsredis.\-c.


\begin{DoxyCode}
                                    \{
  \textcolor{keywordtype}{int} rtn;

  pthread\_mutex\_lock( &p->\hyperlink{structlsredis__obj__struct_a0da18e7d0f7d52459bbc6fbc696d5252}{mutex});
  \textcolor{keywordflow}{while}( p->\hyperlink{structlsredis__obj__struct_a338ffa4123bd06b39c8b58f5e695575e}{valid} == 0)
    pthread\_cond\_wait( &p->\hyperlink{structlsredis__obj__struct_a356f6a228bb19ac7d66fdb1c875d68be}{cond}, &p->\hyperlink{structlsredis__obj__struct_a0da18e7d0f7d52459bbc6fbc696d5252}{mutex});

  rtn = p->\hyperlink{structlsredis__obj__struct_ac3df3eaa275c1e8e333024c1fa8353af}{bvalue};
  pthread\_mutex\_unlock( &p->\hyperlink{structlsredis__obj__struct_a0da18e7d0f7d52459bbc6fbc696d5252}{mutex});
  
  \textcolor{keywordflow}{return} rtn;
\}  
\end{DoxyCode}
\hypertarget{pgpmac_8h_aa8daf63b794b6b6341018feec205cb7d}{\index{pgpmac.\-h@{pgpmac.\-h}!lsredis\-\_\-getd@{lsredis\-\_\-getd}}
\index{lsredis\-\_\-getd@{lsredis\-\_\-getd}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lsredis\-\_\-getd}]{\setlength{\rightskip}{0pt plus 5cm}double lsredis\-\_\-getd (
\begin{DoxyParamCaption}
\item[{{\bf lsredis\-\_\-obj\-\_\-t} $\ast$}]{p}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_aa8daf63b794b6b6341018feec205cb7d}


Definition at line 338 of file lsredis.\-c.


\begin{DoxyCode}
                                       \{
  \textcolor{keywordtype}{double} rtn;

  pthread\_mutex\_lock( &p->\hyperlink{structlsredis__obj__struct_a0da18e7d0f7d52459bbc6fbc696d5252}{mutex});
  \textcolor{keywordflow}{while}( p->\hyperlink{structlsredis__obj__struct_a338ffa4123bd06b39c8b58f5e695575e}{valid} == 0)
    pthread\_cond\_wait( &p->\hyperlink{structlsredis__obj__struct_a356f6a228bb19ac7d66fdb1c875d68be}{cond}, &p->\hyperlink{structlsredis__obj__struct_a0da18e7d0f7d52459bbc6fbc696d5252}{mutex});

  rtn = p->\hyperlink{structlsredis__obj__struct_ab60d0a71cabad6b921b6edb5a8f68996}{dvalue};
  pthread\_mutex\_unlock( &p->\hyperlink{structlsredis__obj__struct_a0da18e7d0f7d52459bbc6fbc696d5252}{mutex});
  
  \textcolor{keywordflow}{return} rtn;
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_a1923f998441f4f451204dfd214d52218}{\index{pgpmac.\-h@{pgpmac.\-h}!lsredis\-\_\-getl@{lsredis\-\_\-getl}}
\index{lsredis\-\_\-getl@{lsredis\-\_\-getl}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lsredis\-\_\-getl}]{\setlength{\rightskip}{0pt plus 5cm}long int lsredis\-\_\-getl (
\begin{DoxyParamCaption}
\item[{{\bf lsredis\-\_\-obj\-\_\-t} $\ast$}]{p}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_a1923f998441f4f451204dfd214d52218}


Definition at line 351 of file lsredis.\-c.


\begin{DoxyCode}
                                         \{
  \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} rtn;

  pthread\_mutex\_lock( &p->\hyperlink{structlsredis__obj__struct_a0da18e7d0f7d52459bbc6fbc696d5252}{mutex});
  \textcolor{keywordflow}{while}( p->\hyperlink{structlsredis__obj__struct_a338ffa4123bd06b39c8b58f5e695575e}{valid} == 0)
    pthread\_cond\_wait( &p->\hyperlink{structlsredis__obj__struct_a356f6a228bb19ac7d66fdb1c875d68be}{cond}, &p->\hyperlink{structlsredis__obj__struct_a0da18e7d0f7d52459bbc6fbc696d5252}{mutex});

  rtn = p->\hyperlink{structlsredis__obj__struct_a26211a0ab3fc02e7776e24dbc1f1256c}{lvalue};
  pthread\_mutex\_unlock( &p->\hyperlink{structlsredis__obj__struct_a0da18e7d0f7d52459bbc6fbc696d5252}{mutex});
  
  \textcolor{keywordflow}{return} rtn;
\}  
\end{DoxyCode}
\hypertarget{pgpmac_8h_ac1994e56114b2315294527d76311f829}{\index{pgpmac.\-h@{pgpmac.\-h}!lsredis\-\_\-getstr@{lsredis\-\_\-getstr}}
\index{lsredis\-\_\-getstr@{lsredis\-\_\-getstr}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lsredis\-\_\-getstr}]{\setlength{\rightskip}{0pt plus 5cm}char$\ast$ lsredis\-\_\-getstr (
\begin{DoxyParamCaption}
\item[{{\bf lsredis\-\_\-obj\-\_\-t} $\ast$}]{p}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_ac1994e56114b2315294527d76311f829}


return a copy of the key's string value 



Definition at line 262 of file lsredis.\-c.


\begin{DoxyCode}
                                        \{
  \textcolor{keywordtype}{char} *rtn;

  \textcolor{comment}{//}
  \textcolor{comment}{// Have to use strdup since we cannot guarantee that p->value won't be freed
       while the caller is still using it}
  \textcolor{comment}{//}
  pthread\_mutex\_lock( &p->\hyperlink{structlsredis__obj__struct_a0da18e7d0f7d52459bbc6fbc696d5252}{mutex});
  \textcolor{keywordflow}{while}( p->\hyperlink{structlsredis__obj__struct_a338ffa4123bd06b39c8b58f5e695575e}{valid} == 0)
    pthread\_cond\_wait( &p->\hyperlink{structlsredis__obj__struct_a356f6a228bb19ac7d66fdb1c875d68be}{cond}, &p->\hyperlink{structlsredis__obj__struct_a0da18e7d0f7d52459bbc6fbc696d5252}{mutex});

  rtn = strdup(p->\hyperlink{structlsredis__obj__struct_a0465c65288e8101805a6f91049164517}{value});
  pthread\_mutex\_unlock( &p->\hyperlink{structlsredis__obj__struct_a0da18e7d0f7d52459bbc6fbc696d5252}{mutex});
  \textcolor{keywordflow}{return} rtn;
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_aef0f12fda57e476a50b14acdc9f30b58}{\index{pgpmac.\-h@{pgpmac.\-h}!lsredis\-\_\-init@{lsredis\-\_\-init}}
\index{lsredis\-\_\-init@{lsredis\-\_\-init}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lsredis\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}void lsredis\-\_\-init (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{pub, }
\item[{char $\ast$}]{re, }
\item[{char $\ast$}]{head}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_aef0f12fda57e476a50b14acdc9f30b58}


Initialize this module, that is, set up the connections. 


\begin{DoxyParams}{Parameters}
{\em pub} & Publish under this (unique) name \\
\hline
{\em re} & Regular expression to select keys we want to mirror \\
\hline
{\em head} & Prepend this (+ a dot) to the beginning of requested objects \\
\hline
\end{DoxyParams}


Definition at line 809 of file lsredis.\-c.


\begin{DoxyCode}
                                                    \{
  \textcolor{keywordtype}{int} err;
  \textcolor{keywordtype}{int} nerrmsg;
  \textcolor{keywordtype}{char} *errmsg;

  \textcolor{comment}{//}
  \textcolor{comment}{// set up hash map to store redis objects}
  \textcolor{comment}{//}
  err = hcreate\_r( 8192, &\hyperlink{lsredis_8c_a42aec6aa74072797ec0344847b0e9e39}{lsredis\_htab});
  \textcolor{keywordflow}{if}( err == 0) \{
    \hyperlink{lslogging_8c_a0e756b36671055ef02a8f04d2ba8a93b}{lslogging\_log\_message}( \textcolor{stringliteral}{"lsredis\_init: Cannot create
       hash table.  Really bad things are going to happen.  hcreate\_r returned %d"}, err);
  \}

  \hyperlink{lsredis_8c_acdca9095c7a3288d7febe9f4c440a6e9}{lsredis\_head}      = strdup( \hyperlink{namespacemk__pgpmac__redis_a760ff4955cbf5beef4ae36a28c30b01a}{head});
  \hyperlink{lsredis_8c_a0c81dce2e75584eeb14ab7d9dd86c72e}{lsredis\_publisher} = strdup( pub);

  pthread\_mutex\_init( &\hyperlink{lsredis_8c_a390e8acf789b0fa41b43a794dd27e28f}{lsredis\_mutex}, NULL);
  pthread\_cond\_init( &\hyperlink{lsredis_8c_a2f63408d16b5603541b124a78f36a5a8}{lsredis\_cond}, NULL);

  \hyperlink{lsredis_8c_a4d65536cb1094fb5deda0a852b181232}{subac} = redisAsyncConnect(\textcolor{stringliteral}{"127.0.0.1"}, 6379);
  \textcolor{keywordflow}{if}( \hyperlink{lsredis_8c_a4d65536cb1094fb5deda0a852b181232}{subac}->err) \{
    \hyperlink{lslogging_8c_a0e756b36671055ef02a8f04d2ba8a93b}{lslogging\_log\_message}( \textcolor{stringliteral}{"Error: %s"}, \hyperlink{lsredis_8c_a4d65536cb1094fb5deda0a852b181232}{subac}->errstr
      );
  \}

  \hyperlink{lsredis_8c_a0cd3bdc79d035eb1595371c845d14367}{subfd}.fd           = \hyperlink{lsredis_8c_a4d65536cb1094fb5deda0a852b181232}{subac}->c.fd;
  \hyperlink{lsredis_8c_a0cd3bdc79d035eb1595371c845d14367}{subfd}.events       = 0;
  \hyperlink{lsredis_8c_a4d65536cb1094fb5deda0a852b181232}{subac}->ev.data     = &\hyperlink{lsredis_8c_a0cd3bdc79d035eb1595371c845d14367}{subfd};
  \hyperlink{lsredis_8c_a4d65536cb1094fb5deda0a852b181232}{subac}->ev.addRead  = \hyperlink{lsredis_8c_adee3bccecc86dd531ac5f89491632439}{lsredis\_addRead};
  \hyperlink{lsredis_8c_a4d65536cb1094fb5deda0a852b181232}{subac}->ev.delRead  = \hyperlink{lsredis_8c_a2e1f2258b3cc864ce3eef4eda556e2a6}{lsredis\_delRead};
  \hyperlink{lsredis_8c_a4d65536cb1094fb5deda0a852b181232}{subac}->ev.addWrite = \hyperlink{lsredis_8c_a3cb6eda5c8ae80019e7a1c078940e9e9}{lsredis\_addWrite};
  \hyperlink{lsredis_8c_a4d65536cb1094fb5deda0a852b181232}{subac}->ev.delWrite = \hyperlink{lsredis_8c_a04f0119cfa1156dc34d35b237358822a}{lsredis\_delWrite};
  \hyperlink{lsredis_8c_a4d65536cb1094fb5deda0a852b181232}{subac}->ev.cleanup  = \hyperlink{lsredis_8c_a45f946a5262c23b362be17c2cb0310c2}{lsredis\_cleanup};

  \hyperlink{lsredis_8c_afc92245910ec04f9a341c092def45564}{roac} = redisAsyncConnect(\textcolor{stringliteral}{"127.0.0.1"}, 6379);
  \textcolor{keywordflow}{if}( \hyperlink{lsredis_8c_afc92245910ec04f9a341c092def45564}{roac}->err) \{
    \hyperlink{lslogging_8c_a0e756b36671055ef02a8f04d2ba8a93b}{lslogging\_log\_message}( \textcolor{stringliteral}{"Error: %s"}, \hyperlink{lsredis_8c_afc92245910ec04f9a341c092def45564}{roac}->errstr);
  \}

  \hyperlink{lsredis_8c_add819e43a356d0575ec64c346c6fed57}{rofd}.fd           = \hyperlink{lsredis_8c_afc92245910ec04f9a341c092def45564}{roac}->c.fd;
  \hyperlink{lsredis_8c_add819e43a356d0575ec64c346c6fed57}{rofd}.events       = 0;
  \hyperlink{lsredis_8c_afc92245910ec04f9a341c092def45564}{roac}->ev.data     = &\hyperlink{lsredis_8c_add819e43a356d0575ec64c346c6fed57}{rofd};
  \hyperlink{lsredis_8c_afc92245910ec04f9a341c092def45564}{roac}->ev.addRead  = \hyperlink{lsredis_8c_adee3bccecc86dd531ac5f89491632439}{lsredis\_addRead};
  \hyperlink{lsredis_8c_afc92245910ec04f9a341c092def45564}{roac}->ev.delRead  = \hyperlink{lsredis_8c_a2e1f2258b3cc864ce3eef4eda556e2a6}{lsredis\_delRead};
  \hyperlink{lsredis_8c_afc92245910ec04f9a341c092def45564}{roac}->ev.addWrite = \hyperlink{lsredis_8c_a3cb6eda5c8ae80019e7a1c078940e9e9}{lsredis\_addWrite};
  \hyperlink{lsredis_8c_afc92245910ec04f9a341c092def45564}{roac}->ev.delWrite = \hyperlink{lsredis_8c_a04f0119cfa1156dc34d35b237358822a}{lsredis\_delWrite};
  \hyperlink{lsredis_8c_afc92245910ec04f9a341c092def45564}{roac}->ev.cleanup  = \hyperlink{lsredis_8c_a45f946a5262c23b362be17c2cb0310c2}{lsredis\_cleanup};

  \textcolor{comment}{//wrac = redisAsyncConnect("10.1.0.3", 6379);}
  \hyperlink{lsredis_8c_a7ea13129ad9e41a0ed2fc19fa75ffb0d}{wrac} = redisAsyncConnect(\textcolor{stringliteral}{"127.0.0.1"}, 6379);
  \textcolor{keywordflow}{if}( \hyperlink{lsredis_8c_a7ea13129ad9e41a0ed2fc19fa75ffb0d}{wrac}->err) \{
    \hyperlink{lslogging_8c_a0e756b36671055ef02a8f04d2ba8a93b}{lslogging\_log\_message}( \textcolor{stringliteral}{"Error: %s"}, \hyperlink{lsredis_8c_a7ea13129ad9e41a0ed2fc19fa75ffb0d}{wrac}->errstr);
  \}

  \hyperlink{lsredis_8c_a13acbee14dbe8cdb98e238abb921d048}{wrfd}.fd           = \hyperlink{lsredis_8c_a7ea13129ad9e41a0ed2fc19fa75ffb0d}{wrac}->c.fd;
  \hyperlink{lsredis_8c_a13acbee14dbe8cdb98e238abb921d048}{wrfd}.events       = 0;
  \hyperlink{lsredis_8c_a7ea13129ad9e41a0ed2fc19fa75ffb0d}{wrac}->ev.data     = &\hyperlink{lsredis_8c_a13acbee14dbe8cdb98e238abb921d048}{wrfd};
  \hyperlink{lsredis_8c_a7ea13129ad9e41a0ed2fc19fa75ffb0d}{wrac}->ev.addRead  = \hyperlink{lsredis_8c_adee3bccecc86dd531ac5f89491632439}{lsredis\_addRead};
  \hyperlink{lsredis_8c_a7ea13129ad9e41a0ed2fc19fa75ffb0d}{wrac}->ev.delRead  = \hyperlink{lsredis_8c_a2e1f2258b3cc864ce3eef4eda556e2a6}{lsredis\_delRead};
  \hyperlink{lsredis_8c_a7ea13129ad9e41a0ed2fc19fa75ffb0d}{wrac}->ev.addWrite = \hyperlink{lsredis_8c_a3cb6eda5c8ae80019e7a1c078940e9e9}{lsredis\_addWrite};
  \hyperlink{lsredis_8c_a7ea13129ad9e41a0ed2fc19fa75ffb0d}{wrac}->ev.delWrite = \hyperlink{lsredis_8c_a04f0119cfa1156dc34d35b237358822a}{lsredis\_delWrite};
  \hyperlink{lsredis_8c_a7ea13129ad9e41a0ed2fc19fa75ffb0d}{wrac}->ev.cleanup  = \hyperlink{lsredis_8c_a45f946a5262c23b362be17c2cb0310c2}{lsredis\_cleanup};

  err = regcomp( &\hyperlink{lsredis_8c_abee04898347f9b2551fa0435b1cc597e}{lsredis\_key\_select\_regex}, re, 
      REG\_EXTENDED);
  \textcolor{keywordflow}{if}( err != 0) \{
    nerrmsg = regerror( err, &\hyperlink{lsredis_8c_abee04898347f9b2551fa0435b1cc597e}{lsredis\_key\_select\_regex},
       NULL, 0);
    \textcolor{keywordflow}{if}( nerrmsg > 0) \{
      errmsg = calloc( nerrmsg, \textcolor{keyword}{sizeof}( \textcolor{keywordtype}{char}));
      nerrmsg = regerror( err, &\hyperlink{lsredis_8c_abee04898347f9b2551fa0435b1cc597e}{lsredis\_key\_select\_regex}
      , errmsg, nerrmsg);
      \hyperlink{lslogging_8c_a0e756b36671055ef02a8f04d2ba8a93b}{lslogging\_log\_message}( \textcolor{stringliteral}{"lsredis\_select: %s"}, errmsg)
      ;
      free( errmsg);
    \}
  \}
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_ac58fca47533e695c8775e0d2b9128766}{\index{pgpmac.\-h@{pgpmac.\-h}!lsredis\-\_\-regexec@{lsredis\-\_\-regexec}}
\index{lsredis\-\_\-regexec@{lsredis\-\_\-regexec}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lsredis\-\_\-regexec}]{\setlength{\rightskip}{0pt plus 5cm}int lsredis\-\_\-regexec (
\begin{DoxyParamCaption}
\item[{const regex\-\_\-t $\ast$}]{preg, }
\item[{{\bf lsredis\-\_\-obj\-\_\-t} $\ast$}]{p, }
\item[{size\-\_\-t}]{nmatch, }
\item[{regmatch\-\_\-t $\ast$}]{pmatch, }
\item[{int}]{eflags}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_ac58fca47533e695c8775e0d2b9128766}


Definition at line 246 of file lsredis.\-c.


\begin{DoxyCode}
                                                                               
                                  \{
  \textcolor{keywordtype}{int} rtn;

  pthread\_mutex\_lock( &p->\hyperlink{structlsredis__obj__struct_a0da18e7d0f7d52459bbc6fbc696d5252}{mutex});
  \textcolor{keywordflow}{while}( p->\hyperlink{structlsredis__obj__struct_a338ffa4123bd06b39c8b58f5e695575e}{valid} == 0) 
    pthread\_cond\_wait( &p->\hyperlink{structlsredis__obj__struct_a356f6a228bb19ac7d66fdb1c875d68be}{cond}, &p->\hyperlink{structlsredis__obj__struct_a0da18e7d0f7d52459bbc6fbc696d5252}{mutex});

  rtn = regexec( preg, p->\hyperlink{structlsredis__obj__struct_a0465c65288e8101805a6f91049164517}{value}, nmatch, pmatch, eflags);

  pthread\_mutex\_unlock( &p->\hyperlink{structlsredis__obj__struct_a0da18e7d0f7d52459bbc6fbc696d5252}{mutex});

  \textcolor{keywordflow}{return} rtn;
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_ad438e4368d86bbe15a93dcf86deaded5}{\index{pgpmac.\-h@{pgpmac.\-h}!lsredis\-\_\-run@{lsredis\-\_\-run}}
\index{lsredis\-\_\-run@{lsredis\-\_\-run}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lsredis\-\_\-run}]{\setlength{\rightskip}{0pt plus 5cm}void lsredis\-\_\-run (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_ad438e4368d86bbe15a93dcf86deaded5}


Definition at line 1013 of file lsredis.\-c.


\begin{DoxyCode}
                   \{
  pthread\_create( &\hyperlink{lsredis_8c_a79c33eb11ad6819247930ade3a25671f}{lsredis\_thread}, NULL, \hyperlink{lsredis_8c_ade7b1ddfdc88c6964a4c90513e360f75}{lsredis\_worker}
      , NULL);
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_a9b9c64f883c7ded60badfe89cb15fa78}{\index{pgpmac.\-h@{pgpmac.\-h}!lsredis\-\_\-setstr@{lsredis\-\_\-setstr}}
\index{lsredis\-\_\-setstr@{lsredis\-\_\-setstr}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lsredis\-\_\-setstr}]{\setlength{\rightskip}{0pt plus 5cm}void lsredis\-\_\-setstr (
\begin{DoxyParamCaption}
\item[{{\bf lsredis\-\_\-obj\-\_\-t} $\ast$}]{p, }
\item[{char $\ast$}]{fmt, }
\item[{}]{...}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_a9b9c64f883c7ded60badfe89cb15fa78}


Set the value and update redis. 

Note that lsredis\-\_\-set\-\_\-value sets the value based on redis while here we set redis based on the value Arbitray maximum string length set here. T\-O\-D\-O\-: Probably this limit should be removed at some point.

redis\-Async\-Command\-Argv used instead of redis\-Async\-Command 'cause it's easier (and possible) to deal with strings that would otherwise cause hiredis to emit a bad command, like those containing spaces. $<$ up the count of times we need to see ourselves published before we start listening to others again

$<$ Unlock to prevent deadlock in case the service routine needs to set our value

$<$ redis\-Async\-Command\-Argv shouldn't need to access this after it's made up it's packet (before it returns) so we should be O\-K with this location disappearing soon. 

Definition at line 287 of file lsredis.\-c.


\begin{DoxyCode}
                                                       \{
  va\_list arg\_ptr;
  \textcolor{keywordtype}{char} \hyperlink{namespacemk__pgpmac__redis_ac732d49b0afca9a9951e3a252bae42fc}{v}[512];
  \textcolor{keywordtype}{char} *argv[4];

  va\_start( arg\_ptr, fmt);
  vsnprintf( v, \textcolor{keyword}{sizeof}(v)-1, fmt, arg\_ptr);
  v[\textcolor{keyword}{sizeof}(\hyperlink{namespacemk__pgpmac__redis_ac732d49b0afca9a9951e3a252bae42fc}{v})-1] = 0;
  va\_end( arg\_ptr);
  
  pthread\_mutex\_lock( &p->\hyperlink{structlsredis__obj__struct_a0da18e7d0f7d52459bbc6fbc696d5252}{mutex});

  \textcolor{comment}{//}
  \textcolor{comment}{// Don't send an update if a good value has not changed}
  \textcolor{comment}{//}
  \textcolor{keywordflow}{if}( p->\hyperlink{structlsredis__obj__struct_a338ffa4123bd06b39c8b58f5e695575e}{valid} && strcmp( v, p->\hyperlink{structlsredis__obj__struct_a0465c65288e8101805a6f91049164517}{value}) == 0) \{
    \textcolor{comment}{// nothing to do}
    pthread\_mutex\_unlock( &p->\hyperlink{structlsredis__obj__struct_a0da18e7d0f7d52459bbc6fbc696d5252}{mutex});
    \textcolor{keywordflow}{return};
  \}

  p->\hyperlink{structlsredis__obj__struct_a8bc1a536b7155a1e2a749c7c434b898b}{wait\_for\_me}++;                  
  pthread\_mutex\_unlock( &p->\hyperlink{structlsredis__obj__struct_a0da18e7d0f7d52459bbc6fbc696d5252}{mutex});        


  argv[0] = \textcolor{stringliteral}{"HSET"};
  argv[1] = p->\hyperlink{structlsredis__obj__struct_aa8c5a453b9424e5666320b8675a42f5c}{key};
  argv[2] = \textcolor{stringliteral}{"VALUE"};
  argv[3] = \hyperlink{namespacemk__pgpmac__redis_ac732d49b0afca9a9951e3a252bae42fc}{v};         


  pthread\_mutex\_lock( &\hyperlink{lsredis_8c_a390e8acf789b0fa41b43a794dd27e28f}{lsredis\_mutex});
  \textcolor{keywordflow}{while}( \hyperlink{lsredis_8c_a7461eb2b5974a2ffac2189007d39193c}{lsredis\_running} == 0)
    pthread\_cond\_wait( &\hyperlink{lsredis_8c_a2f63408d16b5603541b124a78f36a5a8}{lsredis\_cond}, &\hyperlink{lsredis_8c_a390e8acf789b0fa41b43a794dd27e28f}{lsredis\_mutex});

  redisAsyncCommand( \hyperlink{lsredis_8c_a7ea13129ad9e41a0ed2fc19fa75ffb0d}{wrac}, NULL, NULL, \textcolor{stringliteral}{"MULTI"});
  redisAsyncCommandArgv( \hyperlink{lsredis_8c_a7ea13129ad9e41a0ed2fc19fa75ffb0d}{wrac}, NULL, NULL, 4, (\textcolor{keyword}{const} \textcolor{keywordtype}{char} **)argv, NULL);

  redisAsyncCommand( \hyperlink{lsredis_8c_a7ea13129ad9e41a0ed2fc19fa75ffb0d}{wrac}, NULL, NULL, \textcolor{stringliteral}{"PUBLISH %s %s"}, \hyperlink{lsredis_8c_a0c81dce2e75584eeb14ab7d9dd86c72e}{lsredis\_publisher}
      , p->\hyperlink{structlsredis__obj__struct_aa8c5a453b9424e5666320b8675a42f5c}{key});
  redisAsyncCommand( \hyperlink{lsredis_8c_a7ea13129ad9e41a0ed2fc19fa75ffb0d}{wrac}, NULL, NULL, \textcolor{stringliteral}{"EXEC"});
  pthread\_mutex\_unlock( &\hyperlink{lsredis_8c_a390e8acf789b0fa41b43a794dd27e28f}{lsredis\_mutex});

  \textcolor{comment}{// Assume redis will take exactly the value we sent it}
  \textcolor{comment}{//}
  pthread\_mutex\_lock( &p->\hyperlink{structlsredis__obj__struct_a0da18e7d0f7d52459bbc6fbc696d5252}{mutex});
  \hyperlink{lsredis_8c_a05c7ed2bb1b5702a5c83ed3b51abb546}{\_lsredis\_set\_value}( p, v);
  pthread\_cond\_signal( &p->\hyperlink{structlsredis__obj__struct_a356f6a228bb19ac7d66fdb1c875d68be}{cond});
  pthread\_mutex\_unlock( &p->\hyperlink{structlsredis__obj__struct_a0da18e7d0f7d52459bbc6fbc696d5252}{mutex});
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_af712dd2e9419026eff2762ba062eeaf1}{\index{pgpmac.\-h@{pgpmac.\-h}!lstimer\-\_\-add\-\_\-timer@{lstimer\-\_\-add\-\_\-timer}}
\index{lstimer\-\_\-add\-\_\-timer@{lstimer\-\_\-add\-\_\-timer}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lstimer\-\_\-add\-\_\-timer}]{\setlength{\rightskip}{0pt plus 5cm}void lstimer\-\_\-add\-\_\-timer (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{event, }
\item[{int}]{shots, }
\item[{unsigned long int}]{secs, }
\item[{unsigned long int}]{nsecs}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_af712dd2e9419026eff2762ba062eeaf1}


Create a timer. 


\begin{DoxyParams}{Parameters}
{\em event} & Name of the event to send when the timer goes off \\
\hline
{\em shots} & Number of times to run. 0 means never, -\/1 means forever \\
\hline
{\em secs} & Number of seconds to wait \\
\hline
{\em nsecs} & Number of nano-\/seconds to run in addition to secs \\
\hline
\end{DoxyParams}


Definition at line 50 of file lstimer.\-c.


\begin{DoxyCode}
                                                                               
                        \{
  \textcolor{keywordtype}{int} \hyperlink{namespacemk__pgpmac__redis_afa643a23a5984fe44c2182ada3dfa401}{i};
  \textcolor{keyword}{struct }timespec \hyperlink{kvredis_8c_ad40ac52086f6b774928af45b09d54c6e}{now};


  \textcolor{comment}{// Time we were called.  Delay is based on call time, not queued time}
  \textcolor{comment}{//}
  clock\_gettime( CLOCK\_REALTIME, &\hyperlink{kvredis_8c_ad40ac52086f6b774928af45b09d54c6e}{now});
  

  pthread\_mutex\_lock( &\hyperlink{lstimer_8c_a170993cbed9b9ec8bc64b6642a3ed581}{lstimer\_mutex});

  \textcolor{keywordflow}{for}( i=0; i<\hyperlink{lstimer_8c_af020a0f708e86162a32d2ca6373c96bb}{LSTIMER\_LIST\_LENGTH}; i++) \{
    \textcolor{keywordflow}{if}( \hyperlink{lstimer_8c_a35b456765fe2c955cef445768d12ca6c}{lstimer\_list}[i].shots == 0)
      \textcolor{keywordflow}{break};
  \}

  \textcolor{keywordflow}{if}( i == LSTIMER\_LIST\_LENGTH) \{
    pthread\_mutex\_unlock( &\hyperlink{lstimer_8c_a170993cbed9b9ec8bc64b6642a3ed581}{lstimer\_mutex});
    
    \hyperlink{lslogging_8c_a0e756b36671055ef02a8f04d2ba8a93b}{lslogging\_log\_message}( \textcolor{stringliteral}{"lstimer\_add\_timer: out of
       timers for event: %s, shots: %d,  secs: %u, nsecs: %u"},
                          event, shots, secs, nsecs);
    \textcolor{keywordflow}{return};
  \}

  strncpy( \hyperlink{lstimer_8c_a35b456765fe2c955cef445768d12ca6c}{lstimer\_list}[i].event, event, \hyperlink{pgpmac_8h_ab61d790b5572f116e091babfda53627b}{LSEVENTS\_EVENT\_LENGTH}
       - 1);
  \hyperlink{lstimer_8c_a35b456765fe2c955cef445768d12ca6c}{lstimer\_list}[\hyperlink{namespacemk__pgpmac__redis_afa643a23a5984fe44c2182ada3dfa401}{i}].\hyperlink{structlstimer__list__struct_a54d564e392315b2730278bb925803184}{event}[\hyperlink{pgpmac_8h_ab61d790b5572f116e091babfda53627b}{LSEVENTS\_EVENT\_LENGTH}
       - 1] = 0;
  \hyperlink{lstimer_8c_a35b456765fe2c955cef445768d12ca6c}{lstimer\_list}[\hyperlink{namespacemk__pgpmac__redis_afa643a23a5984fe44c2182ada3dfa401}{i}].\hyperlink{structlstimer__list__struct_ac7ab4cd1f3065156f95b49e66bf05283}{shots}        = shots;
  \hyperlink{lstimer_8c_a35b456765fe2c955cef445768d12ca6c}{lstimer\_list}[\hyperlink{namespacemk__pgpmac__redis_afa643a23a5984fe44c2182ada3dfa401}{i}].\hyperlink{structlstimer__list__struct_aa5eac664fe8159916bc3cdfbf583f818}{delay\_secs}   = secs;
  \hyperlink{lstimer_8c_a35b456765fe2c955cef445768d12ca6c}{lstimer\_list}[\hyperlink{namespacemk__pgpmac__redis_afa643a23a5984fe44c2182ada3dfa401}{i}].\hyperlink{structlstimer__list__struct_a45e9fc0b669a1b2831d46b465822344c}{delay\_nsecs}  = nsecs;

  \hyperlink{lstimer_8c_a35b456765fe2c955cef445768d12ca6c}{lstimer\_list}[\hyperlink{namespacemk__pgpmac__redis_afa643a23a5984fe44c2182ada3dfa401}{i}].\hyperlink{structlstimer__list__struct_a6a7538fafa77c5769c8dd2bdd34500b7}{next\_secs}    = secs + \hyperlink{kvredis_8c_ad40ac52086f6b774928af45b09d54c6e}{now}.tv\_sec + (
      \hyperlink{kvredis_8c_ad40ac52086f6b774928af45b09d54c6e}{now}.tv\_nsec + nsecs) / 1000000000;
  \hyperlink{lstimer_8c_a35b456765fe2c955cef445768d12ca6c}{lstimer\_list}[\hyperlink{namespacemk__pgpmac__redis_afa643a23a5984fe44c2182ada3dfa401}{i}].\hyperlink{structlstimer__list__struct_acf993c87ab0ee8ffd74c3907022d6996}{next\_nsecs}   = (\hyperlink{kvredis_8c_ad40ac52086f6b774928af45b09d54c6e}{now}.tv\_nsec + nsecs
      ) % 1000000000;
  \hyperlink{lstimer_8c_a35b456765fe2c955cef445768d12ca6c}{lstimer\_list}[\hyperlink{namespacemk__pgpmac__redis_afa643a23a5984fe44c2182ada3dfa401}{i}].\hyperlink{structlstimer__list__struct_a8f881e66431efbed84b6ad029757bc67}{last\_secs}    = 0;
  \hyperlink{lstimer_8c_a35b456765fe2c955cef445768d12ca6c}{lstimer\_list}[\hyperlink{namespacemk__pgpmac__redis_afa643a23a5984fe44c2182ada3dfa401}{i}].\hyperlink{structlstimer__list__struct_a0b2ab04246481397116ac9770c3c6603}{last\_nsecs}   = 0;
  
  \hyperlink{lstimer_8c_a35b456765fe2c955cef445768d12ca6c}{lstimer\_list}[\hyperlink{namespacemk__pgpmac__redis_afa643a23a5984fe44c2182ada3dfa401}{i}].\hyperlink{structlstimer__list__struct_aa56c5b8ce7fa0ae93132cb9908195836}{ncalls}       = 0;
  \hyperlink{lstimer_8c_a35b456765fe2c955cef445768d12ca6c}{lstimer\_list}[\hyperlink{namespacemk__pgpmac__redis_afa643a23a5984fe44c2182ada3dfa401}{i}].\hyperlink{structlstimer__list__struct_a9633d830ecdce7852530079bb09a6d3c}{init\_secs}    = \hyperlink{kvredis_8c_ad40ac52086f6b774928af45b09d54c6e}{now}.tv\_sec;
  \hyperlink{lstimer_8c_a35b456765fe2c955cef445768d12ca6c}{lstimer\_list}[\hyperlink{namespacemk__pgpmac__redis_afa643a23a5984fe44c2182ada3dfa401}{i}].\hyperlink{structlstimer__list__struct_a72665e0a227b5ee0c82aee43dfaf440a}{init\_nsecs}   = \hyperlink{kvredis_8c_ad40ac52086f6b774928af45b09d54c6e}{now}.tv\_nsec;

  \textcolor{keywordflow}{if}( shots != 0) \{
    \hyperlink{lstimer_8c_a1a47dadbec1776920ab83409234c1833}{lstimer\_active\_timers}++;
    \hyperlink{lstimer_8c_a5a3c6ef3507448d284d91958878d3f75}{new\_timer}++;
  \}

  pthread\_cond\_signal(  &\hyperlink{lstimer_8c_a96b7516e4a15c4b879de82a569cd5f0a}{lstimer\_cond});
  pthread\_mutex\_unlock( &\hyperlink{lstimer_8c_a170993cbed9b9ec8bc64b6642a3ed581}{lstimer\_mutex});
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_a8cd37a8fb0f061456456a5d79bdd5189}{\index{pgpmac.\-h@{pgpmac.\-h}!lstimer\-\_\-init@{lstimer\-\_\-init}}
\index{lstimer\-\_\-init@{lstimer\-\_\-init}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lstimer\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}void lstimer\-\_\-init (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_a8cd37a8fb0f061456456a5d79bdd5189}


Initialize the timer list and pthread stuff. 



Definition at line 259 of file lstimer.\-c.


\begin{DoxyCode}
                    \{
  \textcolor{keywordtype}{int} \hyperlink{namespacemk__pgpmac__redis_afa643a23a5984fe44c2182ada3dfa401}{i};

  \textcolor{keywordflow}{for}( i=0; i<\hyperlink{lstimer_8c_af020a0f708e86162a32d2ca6373c96bb}{LSTIMER\_LIST\_LENGTH}; i++) \{
    \hyperlink{lstimer_8c_a35b456765fe2c955cef445768d12ca6c}{lstimer\_list}[\hyperlink{namespacemk__pgpmac__redis_afa643a23a5984fe44c2182ada3dfa401}{i}].\hyperlink{structlstimer__list__struct_ac7ab4cd1f3065156f95b49e66bf05283}{shots} = 0;
  \}


  pthread\_mutex\_init( &\hyperlink{lstimer_8c_a170993cbed9b9ec8bc64b6642a3ed581}{lstimer\_mutex}, NULL);
  pthread\_cond\_init(  &\hyperlink{lstimer_8c_a96b7516e4a15c4b879de82a569cd5f0a}{lstimer\_cond}, NULL);
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_a0b918acc1a4bf737cb62b5a70f8b553a}{\index{pgpmac.\-h@{pgpmac.\-h}!lstimer\-\_\-run@{lstimer\-\_\-run}}
\index{lstimer\-\_\-run@{lstimer\-\_\-run}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lstimer\-\_\-run}]{\setlength{\rightskip}{0pt plus 5cm}void lstimer\-\_\-run (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_a0b918acc1a4bf737cb62b5a70f8b553a}


Start up our thread. 



Definition at line 273 of file lstimer.\-c.


\begin{DoxyCode}
                   \{
  pthread\_create( &\hyperlink{lstimer_8c_a76660e8720b08f4adee2be9f44b5f419}{lstimer\_thread}, NULL, \hyperlink{lstimer_8c_ab8b409bb2a7ff78da22d988cfb3b537a}{lstimer\_worker}
      , NULL);
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_adf63440ffbc65024fef87ea6a11ea8b0}{\index{pgpmac.\-h@{pgpmac.\-h}!lsupdate\-\_\-init@{lsupdate\-\_\-init}}
\index{lsupdate\-\_\-init@{lsupdate\-\_\-init}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lsupdate\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}void lsupdate\-\_\-init (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_adf63440ffbc65024fef87ea6a11ea8b0}
\hypertarget{pgpmac_8h_af219e9b2cc124f109aa4c2c2e16b5d07}{\index{pgpmac.\-h@{pgpmac.\-h}!lsupdate\-\_\-run@{lsupdate\-\_\-run}}
\index{lsupdate\-\_\-run@{lsupdate\-\_\-run}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lsupdate\-\_\-run}]{\setlength{\rightskip}{0pt plus 5cm}void lsupdate\-\_\-run (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_af219e9b2cc124f109aa4c2c2e16b5d07}
\hypertarget{pgpmac_8h_a0851b1baecda6a67993efde41d77b1c1}{\index{pgpmac.\-h@{pgpmac.\-h}!md2cmds\-\_\-init@{md2cmds\-\_\-init}}
\index{md2cmds\-\_\-init@{md2cmds\-\_\-init}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{md2cmds\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}void md2cmds\-\_\-init (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_a0851b1baecda6a67993efde41d77b1c1}


Initialize the md2cmds module. 



Definition at line 1161 of file md2cmds.\-c.


\begin{DoxyCode}
                    \{
  memset( \hyperlink{md2cmds_8c_a5f0fe1e2dfa92cf345b8c29134ab1ede}{md2cmds\_cmd}, 0, \textcolor{keyword}{sizeof}( \hyperlink{md2cmds_8c_a5f0fe1e2dfa92cf345b8c29134ab1ede}{md2cmds\_cmd}));

  pthread\_mutex\_init( &\hyperlink{md2cmds_8c_ad67304bb851dc6268b0cda2f40fc5aa8}{md2cmds\_mutex}, NULL);
  pthread\_cond\_init( &\hyperlink{md2cmds_8c_a08d5b18ec9478d753c46a3e28d1f2126}{md2cmds\_cond}, NULL);

  pthread\_mutex\_init( &\hyperlink{md2cmds_8c_a4ea6e6bf63aefcd49f87c3921029451d}{md2cmds\_moving\_mutex}, NULL);
  pthread\_cond\_init(  &\hyperlink{md2cmds_8c_adeebdb8f552bff14bd666c187505ee9e}{md2cmds\_moving\_cond}, NULL);

  \hyperlink{md2cmds_8c_a6a34fb6876abbd580629d3708c805e7f}{md2cmds\_md\_status\_code} = \hyperlink{lsredis_8c_ad3bb3ebbae1ffbd03e062ecdd663cc6a}{lsredis\_get\_obj}
      ( \textcolor{stringliteral}{"md2\_status\_code"});
  \hyperlink{lsredis_8c_a9b9c64f883c7ded60badfe89cb15fa78}{lsredis\_setstr}( \hyperlink{md2cmds_8c_a6a34fb6876abbd580629d3708c805e7f}{md2cmds\_md\_status\_code}, \textcolor{stringliteral}{"
      7"});
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_aa62da7d423952334d41c7d282f45233d}{\index{pgpmac.\-h@{pgpmac.\-h}!md2cmds\-\_\-run@{md2cmds\-\_\-run}}
\index{md2cmds\-\_\-run@{md2cmds\-\_\-run}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{md2cmds\-\_\-run}]{\setlength{\rightskip}{0pt plus 5cm}void md2cmds\-\_\-run (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_aa62da7d423952334d41c7d282f45233d}


Start up the thread. 



Definition at line 1176 of file md2cmds.\-c.


\begin{DoxyCode}
                   \{
  pthread\_create( &\hyperlink{md2cmds_8c_aa230921945149692de98fff15c01962f}{md2cmds\_thread}, NULL,              
      \hyperlink{md2cmds_8c_ae967e769d23555a631f615e630f25b00}{md2cmds\_worker}, NULL);
  \hyperlink{lsevents_8c_ab0617d3f0594b51d10e34bf397096654}{lsevents\_add\_listener}( \textcolor{stringliteral}{"omega crossed zero"},        
      \hyperlink{md2cmds_8c_aa43887b7c9799bc88d51df13745d0e5c}{md2cmds\_rotate\_cb});
  \hyperlink{lsevents_8c_ab0617d3f0594b51d10e34bf397096654}{lsevents\_add\_listener}( \textcolor{stringliteral}{".+ (Moving|In Position)"},   
      \hyperlink{md2cmds_8c_a3970ef1a233dabcc5c1408e9d3865f13}{md2cmds\_maybe\_done\_moving\_cb});
  \hyperlink{lsevents_8c_ab0617d3f0594b51d10e34bf397096654}{lsevents\_add\_listener}( \textcolor{stringliteral}{"capz (Moving|In Position)"}, 
      \hyperlink{md2cmds_8c_aab9e2aa02903648acc342068f0664a96}{md2cmds\_time\_capz\_cb});
  \hyperlink{lsevents_8c_ab0617d3f0594b51d10e34bf397096654}{lsevents\_add\_listener}( \textcolor{stringliteral}{"move\_prep command done"},    
      \hyperlink{md2cmds_8c_abd60a276f9d4658561110a4ec68c6144}{md2cmds\_move\_prep\_done\_cb});
\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_a7762ca7b97b44b979e23ce88ca3b4249}{\index{pgpmac.\-h@{pgpmac.\-h}!pgpmac\-\_\-printf@{pgpmac\-\_\-printf}}
\index{pgpmac\-\_\-printf@{pgpmac\-\_\-printf}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{pgpmac\-\_\-printf}]{\setlength{\rightskip}{0pt plus 5cm}void pgpmac\-\_\-printf (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{fmt, }
\item[{}]{...}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_a7762ca7b97b44b979e23ce88ca3b4249}


Terminal output routine ala printf. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em fmt} & Printf style formating string \\
\hline
\end{DoxyParams}


Definition at line 328 of file pgpmac.\-c.


\begin{DoxyCode}
                     \{
  va\_list arg\_ptr;

  pthread\_mutex\_lock( &\hyperlink{pgpmac_8c_ad128c64890c7c0d4f836d9ec6e99216a}{ncurses\_mutex});

  va\_start( arg\_ptr, fmt);
  vwprintw( \hyperlink{pgpmac_8c_a65daf0f4a5bc6def23a9df98ff5ca57e}{term\_output}, fmt, arg\_ptr);
  va\_end( arg\_ptr);

  wnoutrefresh( \hyperlink{pgpmac_8c_a65daf0f4a5bc6def23a9df98ff5ca57e}{term\_output});
  wnoutrefresh( \hyperlink{pgpmac_8c_ab0487111dbe3c05d0bd835eb2fb9a3f7}{term\_input});
  doupdate();

  pthread\_mutex\_unlock( &\hyperlink{pgpmac_8c_ad128c64890c7c0d4f836d9ec6e99216a}{ncurses\_mutex});

\}
\end{DoxyCode}
\hypertarget{pgpmac_8h_a76b11c62b122ee0fd8399435d4260681}{\index{pgpmac.\-h@{pgpmac.\-h}!Pmac\-Sock\-Sendline@{Pmac\-Sock\-Sendline}}
\index{Pmac\-Sock\-Sendline@{Pmac\-Sock\-Sendline}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{Pmac\-Sock\-Sendline}]{\setlength{\rightskip}{0pt plus 5cm}void Pmac\-Sock\-Sendline (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{s}
\end{DoxyParamCaption}
)}}\label{pgpmac_8h_a76b11c62b122ee0fd8399435d4260681}


\subsection{Variable Documentation}
\hypertarget{pgpmac_8h_a6cb218bdccfe5a93471c161f15a15cab}{\index{pgpmac.\-h@{pgpmac.\-h}!alignx@{alignx}}
\index{alignx@{alignx}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{alignx}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-motor\-\_\-t}$\ast$ alignx}}\label{pgpmac_8h_a6cb218bdccfe5a93471c161f15a15cab}


Alignment stage X. 



Definition at line 88 of file lspmac.\-c.

\hypertarget{pgpmac_8h_a737c246c3948e644a18d191a931e1acd}{\index{pgpmac.\-h@{pgpmac.\-h}!aligny@{aligny}}
\index{aligny@{aligny}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{aligny}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-motor\-\_\-t}$\ast$ aligny}}\label{pgpmac_8h_a737c246c3948e644a18d191a931e1acd}


Alignment stage Y. 



Definition at line 89 of file lspmac.\-c.

\hypertarget{pgpmac_8h_ae7642b1da0f7c7f8448104c691d40a12}{\index{pgpmac.\-h@{pgpmac.\-h}!alignz@{alignz}}
\index{alignz@{alignz}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{alignz}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-motor\-\_\-t}$\ast$ alignz}}\label{pgpmac_8h_ae7642b1da0f7c7f8448104c691d40a12}


Alignment stage X. 



Definition at line 90 of file lspmac.\-c.

\hypertarget{pgpmac_8h_aa90d2363b744acbd4d45133b7a716d8f}{\index{pgpmac.\-h@{pgpmac.\-h}!anal@{anal}}
\index{anal@{anal}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{anal}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-motor\-\_\-t}$\ast$ anal}}\label{pgpmac_8h_aa90d2363b744acbd4d45133b7a716d8f}


Polaroid analyzer motor. 



Definition at line 91 of file lspmac.\-c.

\hypertarget{pgpmac_8h_a139200ddaa9856a7ffcec0e6cbaa8f1b}{\index{pgpmac.\-h@{pgpmac.\-h}!apery@{apery}}
\index{apery@{apery}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{apery}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-motor\-\_\-t}$\ast$ apery}}\label{pgpmac_8h_a139200ddaa9856a7ffcec0e6cbaa8f1b}


Aperture Y. 



Definition at line 93 of file lspmac.\-c.

\hypertarget{pgpmac_8h_ab93bd6ee850b285ca3a95e64d15e9477}{\index{pgpmac.\-h@{pgpmac.\-h}!aperz@{aperz}}
\index{aperz@{aperz}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{aperz}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-motor\-\_\-t}$\ast$ aperz}}\label{pgpmac_8h_ab93bd6ee850b285ca3a95e64d15e9477}


Aperture Z. 



Definition at line 94 of file lspmac.\-c.

\hypertarget{pgpmac_8h_afaff4fbb5f03b0d2469fc7a14f174d69}{\index{pgpmac.\-h@{pgpmac.\-h}!arm\-\_\-parked@{arm\-\_\-parked}}
\index{arm\-\_\-parked@{arm\-\_\-parked}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{arm\-\_\-parked}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-bi\-\_\-t}$\ast$ arm\-\_\-parked}}\label{pgpmac_8h_afaff4fbb5f03b0d2469fc7a14f174d69}


(whose arm? parked where?) 



Definition at line 131 of file lspmac.\-c.

\hypertarget{pgpmac_8h_a85d6eaa4b4a82bb3112574f458d1dc50}{\index{pgpmac.\-h@{pgpmac.\-h}!blight@{blight}}
\index{blight@{blight}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{blight}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-motor\-\_\-t}$\ast$ blight}}\label{pgpmac_8h_a85d6eaa4b4a82bb3112574f458d1dc50}


Back Light D\-A\-C. 



Definition at line 105 of file lspmac.\-c.

\hypertarget{pgpmac_8h_ac0d0bc95bcbcbd154b30c72a9645c8b2}{\index{pgpmac.\-h@{pgpmac.\-h}!blight\-\_\-down@{blight\-\_\-down}}
\index{blight\-\_\-down@{blight\-\_\-down}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{blight\-\_\-down}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-bi\-\_\-t}$\ast$ blight\-\_\-down}}\label{pgpmac_8h_ac0d0bc95bcbcbd154b30c72a9645c8b2}


Backlight is down. 



Definition at line 121 of file lspmac.\-c.

\hypertarget{pgpmac_8h_af55c51d52c4586b647114f95d7ac1f42}{\index{pgpmac.\-h@{pgpmac.\-h}!blight\-\_\-f@{blight\-\_\-f}}
\index{blight\-\_\-f@{blight\-\_\-f}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{blight\-\_\-f}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-motor\-\_\-t}$\ast$ blight\-\_\-f}}\label{pgpmac_8h_af55c51d52c4586b647114f95d7ac1f42}


Back light scale factor. 



Definition at line 114 of file lspmac.\-c.

\hypertarget{pgpmac_8h_af813a2eff0b7efa4c70633559054e84c}{\index{pgpmac.\-h@{pgpmac.\-h}!blight\-\_\-ud@{blight\-\_\-ud}}
\index{blight\-\_\-ud@{blight\-\_\-ud}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{blight\-\_\-ud}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-motor\-\_\-t}$\ast$ blight\-\_\-ud}}\label{pgpmac_8h_af813a2eff0b7efa4c70633559054e84c}


Back light Up/\-Down actuator. 



Definition at line 109 of file lspmac.\-c.

\hypertarget{pgpmac_8h_a7fba65f6555c5c7908852c6cf1ad0c94}{\index{pgpmac.\-h@{pgpmac.\-h}!blight\-\_\-up@{blight\-\_\-up}}
\index{blight\-\_\-up@{blight\-\_\-up}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{blight\-\_\-up}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-bi\-\_\-t}$\ast$ blight\-\_\-up}}\label{pgpmac_8h_a7fba65f6555c5c7908852c6cf1ad0c94}


Backlight is up. 



Definition at line 122 of file lspmac.\-c.

\hypertarget{pgpmac_8h_a51358daaea8b5236f08414877d8af6c2}{\index{pgpmac.\-h@{pgpmac.\-h}!capy@{capy}}
\index{capy@{capy}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{capy}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-motor\-\_\-t}$\ast$ capy}}\label{pgpmac_8h_a51358daaea8b5236f08414877d8af6c2}


Capillary Y. 



Definition at line 95 of file lspmac.\-c.

\hypertarget{pgpmac_8h_aa45f268d0af9f3d465acfab128919718}{\index{pgpmac.\-h@{pgpmac.\-h}!capz@{capz}}
\index{capz@{capz}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{capz}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-motor\-\_\-t}$\ast$ capz}}\label{pgpmac_8h_aa45f268d0af9f3d465acfab128919718}


Capillary Z. 



Definition at line 96 of file lspmac.\-c.

\hypertarget{pgpmac_8h_ac940d950d9efeaf3f0ae67e9bf331188}{\index{pgpmac.\-h@{pgpmac.\-h}!cenx@{cenx}}
\index{cenx@{cenx}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{cenx}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-motor\-\_\-t}$\ast$ cenx}}\label{pgpmac_8h_ac940d950d9efeaf3f0ae67e9bf331188}


Centering Table X. 



Definition at line 98 of file lspmac.\-c.

\hypertarget{pgpmac_8h_aaed18e738ba7bfb6c771a44f5d7ea827}{\index{pgpmac.\-h@{pgpmac.\-h}!ceny@{ceny}}
\index{ceny@{ceny}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{ceny}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-motor\-\_\-t}$\ast$ ceny}}\label{pgpmac_8h_aaed18e738ba7bfb6c771a44f5d7ea827}


Centering Table Y. 



Definition at line 99 of file lspmac.\-c.

\hypertarget{pgpmac_8h_ae78d9a757d4c85419fff9c94b15e25d7}{\index{pgpmac.\-h@{pgpmac.\-h}!cryo@{cryo}}
\index{cryo@{cryo}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{cryo}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-motor\-\_\-t}$\ast$ cryo}}\label{pgpmac_8h_ae78d9a757d4c85419fff9c94b15e25d7}


Move the cryostream towards or away from the crystal. 



Definition at line 110 of file lspmac.\-c.

\hypertarget{pgpmac_8h_a871d4cdea0a1a8db85b8658a07655212}{\index{pgpmac.\-h@{pgpmac.\-h}!cryo\-\_\-back@{cryo\-\_\-back}}
\index{cryo\-\_\-back@{cryo\-\_\-back}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{cryo\-\_\-back}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-bi\-\_\-t}$\ast$ cryo\-\_\-back}}\label{pgpmac_8h_a871d4cdea0a1a8db85b8658a07655212}


cryo is in the back position 



Definition at line 123 of file lspmac.\-c.

\hypertarget{pgpmac_8h_a28df32fd6be9160603aa1bb74a823574}{\index{pgpmac.\-h@{pgpmac.\-h}!cryo\-\_\-switch@{cryo\-\_\-switch}}
\index{cryo\-\_\-switch@{cryo\-\_\-switch}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{cryo\-\_\-switch}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-bi\-\_\-t}$\ast$ cryo\-\_\-switch}}\label{pgpmac_8h_a28df32fd6be9160603aa1bb74a823574}


that little toggle switch for the cryo 



Definition at line 120 of file lspmac.\-c.

\hypertarget{pgpmac_8h_a9d9c5030d817483ca9518027c91adac4}{\index{pgpmac.\-h@{pgpmac.\-h}!dryer@{dryer}}
\index{dryer@{dryer}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{dryer}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-motor\-\_\-t}$\ast$ dryer}}\label{pgpmac_8h_a9d9c5030d817483ca9518027c91adac4}


blow air on the scintilator to dry it off 



Definition at line 111 of file lspmac.\-c.

\hypertarget{pgpmac_8h_a1e690d4ad981d020ea2c850282dca3be}{\index{pgpmac.\-h@{pgpmac.\-h}!etel\-\_\-init\-\_\-ok@{etel\-\_\-init\-\_\-ok}}
\index{etel\-\_\-init\-\_\-ok@{etel\-\_\-init\-\_\-ok}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{etel\-\_\-init\-\_\-ok}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-bi\-\_\-t}$\ast$ etel\-\_\-init\-\_\-ok}}\label{pgpmac_8h_a1e690d4ad981d020ea2c850282dca3be}


E\-T\-E\-L initialized O\-K. 



Definition at line 128 of file lspmac.\-c.

\hypertarget{pgpmac_8h_ab48d4a2cf0225796db9aad49f034dc59}{\index{pgpmac.\-h@{pgpmac.\-h}!etel\-\_\-on@{etel\-\_\-on}}
\index{etel\-\_\-on@{etel\-\_\-on}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{etel\-\_\-on}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-bi\-\_\-t}$\ast$ etel\-\_\-on}}\label{pgpmac_8h_ab48d4a2cf0225796db9aad49f034dc59}


E\-T\-E\-L is on. 



Definition at line 127 of file lspmac.\-c.

\hypertarget{pgpmac_8h_a5538a6aa526eeed65ff237303da2d348}{\index{pgpmac.\-h@{pgpmac.\-h}!etel\-\_\-ready@{etel\-\_\-ready}}
\index{etel\-\_\-ready@{etel\-\_\-ready}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{etel\-\_\-ready}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-bi\-\_\-t}$\ast$ etel\-\_\-ready}}\label{pgpmac_8h_a5538a6aa526eeed65ff237303da2d348}


E\-T\-E\-L is ready. 



Definition at line 126 of file lspmac.\-c.

\hypertarget{pgpmac_8h_aeb09895663eff333b7a75acb319a9fc1}{\index{pgpmac.\-h@{pgpmac.\-h}!flight@{flight}}
\index{flight@{flight}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{flight}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-motor\-\_\-t}$\ast$ flight}}\label{pgpmac_8h_aeb09895663eff333b7a75acb319a9fc1}


Front Light D\-A\-C. 



Definition at line 104 of file lspmac.\-c.

\hypertarget{pgpmac_8h_aabf4ec595b5183c1777d029ca56134b0}{\index{pgpmac.\-h@{pgpmac.\-h}!flight\-\_\-f@{flight\-\_\-f}}
\index{flight\-\_\-f@{flight\-\_\-f}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{flight\-\_\-f}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-motor\-\_\-t}$\ast$ flight\-\_\-f}}\label{pgpmac_8h_aabf4ec595b5183c1777d029ca56134b0}


Front light scale factor. 



Definition at line 115 of file lspmac.\-c.

\hypertarget{pgpmac_8h_a6630442dc65ce8a30a24ed718b301971}{\index{pgpmac.\-h@{pgpmac.\-h}!flight\-\_\-oo@{flight\-\_\-oo}}
\index{flight\-\_\-oo@{flight\-\_\-oo}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{flight\-\_\-oo}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-motor\-\_\-t}$\ast$ flight\-\_\-oo}}\label{pgpmac_8h_a6630442dc65ce8a30a24ed718b301971}


Turn front light on/off. 



Definition at line 113 of file lspmac.\-c.

\hypertarget{pgpmac_8h_addb26c80065506faa1de3c1b468fe03f}{\index{pgpmac.\-h@{pgpmac.\-h}!fluo@{fluo}}
\index{fluo@{fluo}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{fluo}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-motor\-\_\-t}$\ast$ fluo}}\label{pgpmac_8h_addb26c80065506faa1de3c1b468fe03f}


Move the fluorescence detector in/out. 



Definition at line 112 of file lspmac.\-c.

\hypertarget{pgpmac_8h_a67092de6f3fcc0b245e4970437eaff6b}{\index{pgpmac.\-h@{pgpmac.\-h}!fluor\-\_\-back@{fluor\-\_\-back}}
\index{fluor\-\_\-back@{fluor\-\_\-back}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{fluor\-\_\-back}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-bi\-\_\-t}$\ast$ fluor\-\_\-back}}\label{pgpmac_8h_a67092de6f3fcc0b245e4970437eaff6b}


fluor is in the back position 



Definition at line 124 of file lspmac.\-c.

\hypertarget{pgpmac_8h_a8a3ca6fcf5e24dcc26170736843e53b2}{\index{pgpmac.\-h@{pgpmac.\-h}!fscint@{fscint}}
\index{fscint@{fscint}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{fscint}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-motor\-\_\-t}$\ast$ fscint}}\label{pgpmac_8h_a8a3ca6fcf5e24dcc26170736843e53b2}


Scintillator Piezo D\-A\-C. 



Definition at line 106 of file lspmac.\-c.

\hypertarget{pgpmac_8h_a26dec4623af9beed912b8e7e6f99822c}{\index{pgpmac.\-h@{pgpmac.\-h}!fshut@{fshut}}
\index{fshut@{fshut}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{fshut}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-motor\-\_\-t}$\ast$ fshut}}\label{pgpmac_8h_a26dec4623af9beed912b8e7e6f99822c}


Fast shutter. 



Definition at line 103 of file lspmac.\-c.

\hypertarget{pgpmac_8h_abb29b117ad38156ba16fcf44eeb427af}{\index{pgpmac.\-h@{pgpmac.\-h}!hp\-\_\-air@{hp\-\_\-air}}
\index{hp\-\_\-air@{hp\-\_\-air}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{hp\-\_\-air}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-bi\-\_\-t}$\ast$ hp\-\_\-air}}\label{pgpmac_8h_abb29b117ad38156ba16fcf44eeb427af}


High pressure air O\-K. 



Definition at line 119 of file lspmac.\-c.

\hypertarget{pgpmac_8h_a0be79ccb7ebf3a665248fd856112b9fd}{\index{pgpmac.\-h@{pgpmac.\-h}!kappa@{kappa}}
\index{kappa@{kappa}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{kappa}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-motor\-\_\-t}$\ast$ kappa}}\label{pgpmac_8h_a0be79ccb7ebf3a665248fd856112b9fd}


Kappa. 



Definition at line 100 of file lspmac.\-c.

\hypertarget{pgpmac_8h_aade15098d213bb25522048e4a231941a}{\index{pgpmac.\-h@{pgpmac.\-h}!lp\-\_\-air@{lp\-\_\-air}}
\index{lp\-\_\-air@{lp\-\_\-air}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lp\-\_\-air}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-bi\-\_\-t}$\ast$ lp\-\_\-air}}\label{pgpmac_8h_aade15098d213bb25522048e4a231941a}


Low pressure air O\-K. 



Definition at line 118 of file lspmac.\-c.

\hypertarget{pgpmac_8h_adf89a0299edd6a99992b95dff8992eba}{\index{pgpmac.\-h@{pgpmac.\-h}!lspg\-\_\-demandairrights@{lspg\-\_\-demandairrights}}
\index{lspg\-\_\-demandairrights@{lspg\-\_\-demandairrights}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspg\-\_\-demandairrights}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspg\-\_\-demandairrights\-\_\-t} lspg\-\_\-demandairrights}}\label{pgpmac_8h_adf89a0299edd6a99992b95dff8992eba}


our demandairrights object 



Definition at line 66 of file lspg.\-c.

\hypertarget{pgpmac_8h_a7ef8a09203117578c9b2ce4719519f36}{\index{pgpmac.\-h@{pgpmac.\-h}!lspg\-\_\-getcenter@{lspg\-\_\-getcenter}}
\index{lspg\-\_\-getcenter@{lspg\-\_\-getcenter}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspg\-\_\-getcenter}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspg\-\_\-getcenter\-\_\-t} lspg\-\_\-getcenter}}\label{pgpmac_8h_a7ef8a09203117578c9b2ce4719519f36}


the getcenter object 



Definition at line 65 of file lspg.\-c.

\hypertarget{pgpmac_8h_a5c50804e6019d47d91f3f1cb3ebd1f00}{\index{pgpmac.\-h@{pgpmac.\-h}!lspg\-\_\-getcurrentsampleid@{lspg\-\_\-getcurrentsampleid}}
\index{lspg\-\_\-getcurrentsampleid@{lspg\-\_\-getcurrentsampleid}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspg\-\_\-getcurrentsampleid}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspg\-\_\-getcurrentsampleid\-\_\-t} lspg\-\_\-getcurrentsampleid}}\label{pgpmac_8h_a5c50804e6019d47d91f3f1cb3ebd1f00}


our currentsample id 



Definition at line 67 of file lspg.\-c.

\hypertarget{pgpmac_8h_adbf70f382e469e02dce77833981f9547}{\index{pgpmac.\-h@{pgpmac.\-h}!lspg\-\_\-nextsample@{lspg\-\_\-nextsample}}
\index{lspg\-\_\-nextsample@{lspg\-\_\-nextsample}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspg\-\_\-nextsample}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspg\-\_\-nextsample\-\_\-t} lspg\-\_\-nextsample}}\label{pgpmac_8h_adbf70f382e469e02dce77833981f9547}


the very next sample 



Definition at line 63 of file lspg.\-c.

\hypertarget{pgpmac_8h_ad8d8e2f578ca79189a80c1fd5b60cefd}{\index{pgpmac.\-h@{pgpmac.\-h}!lspg\-\_\-nextshot@{lspg\-\_\-nextshot}}
\index{lspg\-\_\-nextshot@{lspg\-\_\-nextshot}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspg\-\_\-nextshot}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspg\-\_\-nextshot\-\_\-t} lspg\-\_\-nextshot}}\label{pgpmac_8h_ad8d8e2f578ca79189a80c1fd5b60cefd}


the nextshot object 



Definition at line 64 of file lspg.\-c.

\hypertarget{pgpmac_8h_af18499d17171eff473cfc49d4a0a5562}{\index{pgpmac.\-h@{pgpmac.\-h}!lspg\-\_\-starttransfer@{lspg\-\_\-starttransfer}}
\index{lspg\-\_\-starttransfer@{lspg\-\_\-starttransfer}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspg\-\_\-starttransfer}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspg\-\_\-starttransfer\-\_\-t} lspg\-\_\-starttransfer}}\label{pgpmac_8h_af18499d17171eff473cfc49d4a0a5562}


start a sample transfer 



Definition at line 68 of file lspg.\-c.

\hypertarget{pgpmac_8h_a5f699604dcc5d3d64fd6cb5c363d29c9}{\index{pgpmac.\-h@{pgpmac.\-h}!lspg\-\_\-waitcryo@{lspg\-\_\-waitcryo}}
\index{lspg\-\_\-waitcryo@{lspg\-\_\-waitcryo}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspg\-\_\-waitcryo}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspg\-\_\-waitcryo\-\_\-t} lspg\-\_\-waitcryo}}\label{pgpmac_8h_a5f699604dcc5d3d64fd6cb5c363d29c9}


signal the robot 



Definition at line 69 of file lspg.\-c.

\hypertarget{pgpmac_8h_aebfce5f9cbc8ba7bd4e2ee4880f303e8}{\index{pgpmac.\-h@{pgpmac.\-h}!lspmac\-\_\-motors@{lspmac\-\_\-motors}}
\index{lspmac\-\_\-motors@{lspmac\-\_\-motors}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspmac\-\_\-motors}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-motor\-\_\-t} lspmac\-\_\-motors\mbox{[}$\,$\mbox{]}}}\label{pgpmac_8h_aebfce5f9cbc8ba7bd4e2ee4880f303e8}


All our motors. 



Definition at line 85 of file lspmac.\-c.

\hypertarget{pgpmac_8h_a57547d211906c981ef20257eba99f8df}{\index{pgpmac.\-h@{pgpmac.\-h}!lspmac\-\_\-moving\-\_\-cond@{lspmac\-\_\-moving\-\_\-cond}}
\index{lspmac\-\_\-moving\-\_\-cond@{lspmac\-\_\-moving\-\_\-cond}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspmac\-\_\-moving\-\_\-cond}]{\setlength{\rightskip}{0pt plus 5cm}pthread\-\_\-cond\-\_\-t lspmac\-\_\-moving\-\_\-cond}}\label{pgpmac_8h_a57547d211906c981ef20257eba99f8df}


Wait for motor(s) to finish moving condition. 



Definition at line 62 of file lspmac.\-c.

\hypertarget{pgpmac_8h_a7a32c617c183166308241e270959df56}{\index{pgpmac.\-h@{pgpmac.\-h}!lspmac\-\_\-moving\-\_\-flags@{lspmac\-\_\-moving\-\_\-flags}}
\index{lspmac\-\_\-moving\-\_\-flags@{lspmac\-\_\-moving\-\_\-flags}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspmac\-\_\-moving\-\_\-flags}]{\setlength{\rightskip}{0pt plus 5cm}int lspmac\-\_\-moving\-\_\-flags}}\label{pgpmac_8h_a7a32c617c183166308241e270959df56}


Flag used to implement motor moving condition. 



Definition at line 63 of file lspmac.\-c.

\hypertarget{pgpmac_8h_a85679cac947e199c88794f8e5a12bf5f}{\index{pgpmac.\-h@{pgpmac.\-h}!lspmac\-\_\-moving\-\_\-mutex@{lspmac\-\_\-moving\-\_\-mutex}}
\index{lspmac\-\_\-moving\-\_\-mutex@{lspmac\-\_\-moving\-\_\-mutex}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspmac\-\_\-moving\-\_\-mutex}]{\setlength{\rightskip}{0pt plus 5cm}pthread\-\_\-mutex\-\_\-t lspmac\-\_\-moving\-\_\-mutex}}\label{pgpmac_8h_a85679cac947e199c88794f8e5a12bf5f}


Coordinate moving motors between threads. 



Definition at line 61 of file lspmac.\-c.

\hypertarget{pgpmac_8h_a56260f012c50a591ee7f97e500f16994}{\index{pgpmac.\-h@{pgpmac.\-h}!lspmac\-\_\-nmotors@{lspmac\-\_\-nmotors}}
\index{lspmac\-\_\-nmotors@{lspmac\-\_\-nmotors}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspmac\-\_\-nmotors}]{\setlength{\rightskip}{0pt plus 5cm}int lspmac\-\_\-nmotors}}\label{pgpmac_8h_a56260f012c50a591ee7f97e500f16994}


The number of motors we manage. 



Definition at line 86 of file lspmac.\-c.

\hypertarget{pgpmac_8h_afbd51c2cefcee87afe994c9e9f372241}{\index{pgpmac.\-h@{pgpmac.\-h}!lspmac\-\_\-shutter\-\_\-cond@{lspmac\-\_\-shutter\-\_\-cond}}
\index{lspmac\-\_\-shutter\-\_\-cond@{lspmac\-\_\-shutter\-\_\-cond}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspmac\-\_\-shutter\-\_\-cond}]{\setlength{\rightskip}{0pt plus 5cm}pthread\-\_\-cond\-\_\-t lspmac\-\_\-shutter\-\_\-cond}}\label{pgpmac_8h_afbd51c2cefcee87afe994c9e9f372241}


Allows waiting for the shutter status to change. 



Definition at line 60 of file lspmac.\-c.

\hypertarget{pgpmac_8h_a396fbf06208de3ecbe1b0df549f1cd46}{\index{pgpmac.\-h@{pgpmac.\-h}!lspmac\-\_\-shutter\-\_\-has\-\_\-opened@{lspmac\-\_\-shutter\-\_\-has\-\_\-opened}}
\index{lspmac\-\_\-shutter\-\_\-has\-\_\-opened@{lspmac\-\_\-shutter\-\_\-has\-\_\-opened}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspmac\-\_\-shutter\-\_\-has\-\_\-opened}]{\setlength{\rightskip}{0pt plus 5cm}int lspmac\-\_\-shutter\-\_\-has\-\_\-opened}}\label{pgpmac_8h_a396fbf06208de3ecbe1b0df549f1cd46}


Indicates that the shutter had opened, perhaps briefly even if the state did not change. 



Definition at line 58 of file lspmac.\-c.

\hypertarget{pgpmac_8h_a1b78a13c654409333569815e1c109d38}{\index{pgpmac.\-h@{pgpmac.\-h}!lspmac\-\_\-shutter\-\_\-mutex@{lspmac\-\_\-shutter\-\_\-mutex}}
\index{lspmac\-\_\-shutter\-\_\-mutex@{lspmac\-\_\-shutter\-\_\-mutex}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspmac\-\_\-shutter\-\_\-mutex}]{\setlength{\rightskip}{0pt plus 5cm}pthread\-\_\-mutex\-\_\-t lspmac\-\_\-shutter\-\_\-mutex}}\label{pgpmac_8h_a1b78a13c654409333569815e1c109d38}


Coordinates threads reading shutter status. 



Definition at line 59 of file lspmac.\-c.

\hypertarget{pgpmac_8h_a112158e0cd50449a440ac55c7af7bea2}{\index{pgpmac.\-h@{pgpmac.\-h}!lspmac\-\_\-shutter\-\_\-state@{lspmac\-\_\-shutter\-\_\-state}}
\index{lspmac\-\_\-shutter\-\_\-state@{lspmac\-\_\-shutter\-\_\-state}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{lspmac\-\_\-shutter\-\_\-state}]{\setlength{\rightskip}{0pt plus 5cm}int lspmac\-\_\-shutter\-\_\-state}}\label{pgpmac_8h_a112158e0cd50449a440ac55c7af7bea2}


State of the shutter, used to detect changes. 



Definition at line 57 of file lspmac.\-c.

\hypertarget{pgpmac_8h_a7a3e763682bd7f987d07f149e94b3bf8}{\index{pgpmac.\-h@{pgpmac.\-h}!md2\-\_\-status\-\_\-mutex@{md2\-\_\-status\-\_\-mutex}}
\index{md2\-\_\-status\-\_\-mutex@{md2\-\_\-status\-\_\-mutex}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{md2\-\_\-status\-\_\-mutex}]{\setlength{\rightskip}{0pt plus 5cm}pthread\-\_\-mutex\-\_\-t md2\-\_\-status\-\_\-mutex}}\label{pgpmac_8h_a7a3e763682bd7f987d07f149e94b3bf8}


Synchronize reading/writting status buffer. 



Definition at line 339 of file lspmac.\-c.

\hypertarget{pgpmac_8h_a1ccf455563dc8d828558b6a230e164a6}{\index{pgpmac.\-h@{pgpmac.\-h}!md2cmds\-\_\-cmd@{md2cmds\-\_\-cmd}}
\index{md2cmds\-\_\-cmd@{md2cmds\-\_\-cmd}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{md2cmds\-\_\-cmd}]{\setlength{\rightskip}{0pt plus 5cm}char md2cmds\-\_\-cmd\mbox{[}$\,$\mbox{]}}}\label{pgpmac_8h_a1ccf455563dc8d828558b6a230e164a6}


our command; 



Definition at line 20 of file md2cmds.\-c.

\hypertarget{pgpmac_8h_a08d5b18ec9478d753c46a3e28d1f2126}{\index{pgpmac.\-h@{pgpmac.\-h}!md2cmds\-\_\-cond@{md2cmds\-\_\-cond}}
\index{md2cmds\-\_\-cond@{md2cmds\-\_\-cond}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{md2cmds\-\_\-cond}]{\setlength{\rightskip}{0pt plus 5cm}pthread\-\_\-cond\-\_\-t md2cmds\-\_\-cond}}\label{pgpmac_8h_a08d5b18ec9478d753c46a3e28d1f2126}


condition to signal when it's time to run an md2 command 



Definition at line 10 of file md2cmds.\-c.

\hypertarget{pgpmac_8h_a6a34fb6876abbd580629d3708c805e7f}{\index{pgpmac.\-h@{pgpmac.\-h}!md2cmds\-\_\-md\-\_\-status\-\_\-code@{md2cmds\-\_\-md\-\_\-status\-\_\-code}}
\index{md2cmds\-\_\-md\-\_\-status\-\_\-code@{md2cmds\-\_\-md\-\_\-status\-\_\-code}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{md2cmds\-\_\-md\-\_\-status\-\_\-code}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lsredis\-\_\-obj\-\_\-t}$\ast$ md2cmds\-\_\-md\-\_\-status\-\_\-code}}\label{pgpmac_8h_a6a34fb6876abbd580629d3708c805e7f}


Definition at line 22 of file md2cmds.\-c.

\hypertarget{pgpmac_8h_ad67304bb851dc6268b0cda2f40fc5aa8}{\index{pgpmac.\-h@{pgpmac.\-h}!md2cmds\-\_\-mutex@{md2cmds\-\_\-mutex}}
\index{md2cmds\-\_\-mutex@{md2cmds\-\_\-mutex}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{md2cmds\-\_\-mutex}]{\setlength{\rightskip}{0pt plus 5cm}pthread\-\_\-mutex\-\_\-t md2cmds\-\_\-mutex}}\label{pgpmac_8h_ad67304bb851dc6268b0cda2f40fc5aa8}


mutex for the condition 



Definition at line 11 of file md2cmds.\-c.

\hypertarget{pgpmac_8h_ab517a930528e2b7d0993e11087765b03}{\index{pgpmac.\-h@{pgpmac.\-h}!md2cmds\-\_\-pg\-\_\-cond@{md2cmds\-\_\-pg\-\_\-cond}}
\index{md2cmds\-\_\-pg\-\_\-cond@{md2cmds\-\_\-pg\-\_\-cond}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{md2cmds\-\_\-pg\-\_\-cond}]{\setlength{\rightskip}{0pt plus 5cm}pthread\-\_\-cond\-\_\-t md2cmds\-\_\-pg\-\_\-cond}}\label{pgpmac_8h_ab517a930528e2b7d0993e11087765b03}
\hypertarget{pgpmac_8h_a4d2c3ac81d4b13eb21f4ddcdda8c7308}{\index{pgpmac.\-h@{pgpmac.\-h}!md2cmds\-\_\-pg\-\_\-mutex@{md2cmds\-\_\-pg\-\_\-mutex}}
\index{md2cmds\-\_\-pg\-\_\-mutex@{md2cmds\-\_\-pg\-\_\-mutex}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{md2cmds\-\_\-pg\-\_\-mutex}]{\setlength{\rightskip}{0pt plus 5cm}pthread\-\_\-mutex\-\_\-t md2cmds\-\_\-pg\-\_\-mutex}}\label{pgpmac_8h_a4d2c3ac81d4b13eb21f4ddcdda8c7308}
\hypertarget{pgpmac_8h_ab552f2e28dd9cccefafe01f27717101b}{\index{pgpmac.\-h@{pgpmac.\-h}!minikappa\-\_\-ok@{minikappa\-\_\-ok}}
\index{minikappa\-\_\-ok@{minikappa\-\_\-ok}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{minikappa\-\_\-ok}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-bi\-\_\-t}$\ast$ minikappa\-\_\-ok}}\label{pgpmac_8h_ab552f2e28dd9cccefafe01f27717101b}


Minikappa is O\-K (whatever that means) 



Definition at line 129 of file lspmac.\-c.

\hypertarget{pgpmac_8h_ad128c64890c7c0d4f836d9ec6e99216a}{\index{pgpmac.\-h@{pgpmac.\-h}!ncurses\-\_\-mutex@{ncurses\-\_\-mutex}}
\index{ncurses\-\_\-mutex@{ncurses\-\_\-mutex}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{ncurses\-\_\-mutex}]{\setlength{\rightskip}{0pt plus 5cm}pthread\-\_\-mutex\-\_\-t ncurses\-\_\-mutex}}\label{pgpmac_8h_ad128c64890c7c0d4f836d9ec6e99216a}


allow more than one thread access to the screen 



Definition at line 242 of file pgpmac.\-c.

\hypertarget{pgpmac_8h_a8237e646ce032a840637a4ef7bff49b9}{\index{pgpmac.\-h@{pgpmac.\-h}!omega@{omega}}
\index{omega@{omega}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{omega}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-motor\-\_\-t}$\ast$ omega}}\label{pgpmac_8h_a8237e646ce032a840637a4ef7bff49b9}


M\-D2 omega axis (the air bearing) 



Definition at line 87 of file lspmac.\-c.

\hypertarget{pgpmac_8h_ae6631a094accc469661805bdf80fc6d8}{\index{pgpmac.\-h@{pgpmac.\-h}!omega\-\_\-zero\-\_\-time@{omega\-\_\-zero\-\_\-time}}
\index{omega\-\_\-zero\-\_\-time@{omega\-\_\-zero\-\_\-time}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{omega\-\_\-zero\-\_\-time}]{\setlength{\rightskip}{0pt plus 5cm}struct timespec omega\-\_\-zero\-\_\-time}}\label{pgpmac_8h_ae6631a094accc469661805bdf80fc6d8}


Time we believe that omega crossed zero. 



Definition at line 70 of file lspmac.\-c.

\hypertarget{pgpmac_8h_ac8070dc568ad974a3db42b51eca828cc}{\index{pgpmac.\-h@{pgpmac.\-h}!phi@{phi}}
\index{phi@{phi}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{phi}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-motor\-\_\-t}$\ast$ phi}}\label{pgpmac_8h_ac8070dc568ad974a3db42b51eca828cc}


Phi (not data collection axis) 



Definition at line 101 of file lspmac.\-c.

\hypertarget{pgpmac_8h_a8a25bd9c593c6985107f90f999ce0b08}{\index{pgpmac.\-h@{pgpmac.\-h}!pmac\-\_\-queue\-\_\-cond@{pmac\-\_\-queue\-\_\-cond}}
\index{pmac\-\_\-queue\-\_\-cond@{pmac\-\_\-queue\-\_\-cond}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{pmac\-\_\-queue\-\_\-cond}]{\setlength{\rightskip}{0pt plus 5cm}pthread\-\_\-cond\-\_\-t pmac\-\_\-queue\-\_\-cond}}\label{pgpmac_8h_a8a25bd9c593c6985107f90f999ce0b08}


wait for a command to be sent to P\-M\-A\-C before continuing 



Definition at line 76 of file lspmac.\-c.

\hypertarget{pgpmac_8h_acc1bb77b9bcbc4d970f841a41fd274b3}{\index{pgpmac.\-h@{pgpmac.\-h}!pmac\-\_\-queue\-\_\-mutex@{pmac\-\_\-queue\-\_\-mutex}}
\index{pmac\-\_\-queue\-\_\-mutex@{pmac\-\_\-queue\-\_\-mutex}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{pmac\-\_\-queue\-\_\-mutex}]{\setlength{\rightskip}{0pt plus 5cm}pthread\-\_\-mutex\-\_\-t pmac\-\_\-queue\-\_\-mutex}}\label{pgpmac_8h_acc1bb77b9bcbc4d970f841a41fd274b3}


manage access to the pmac command queue 



Definition at line 75 of file lspmac.\-c.

\hypertarget{pgpmac_8h_ac59ab990e48033a811aeb0281fb588fc}{\index{pgpmac.\-h@{pgpmac.\-h}!sample\-\_\-detected@{sample\-\_\-detected}}
\index{sample\-\_\-detected@{sample\-\_\-detected}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{sample\-\_\-detected}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-bi\-\_\-t}$\ast$ sample\-\_\-detected}}\label{pgpmac_8h_ac59ab990e48033a811aeb0281fb588fc}


smart magnet detected sample 



Definition at line 125 of file lspmac.\-c.

\hypertarget{pgpmac_8h_a589431b3a79c21c251fcb97cc9126991}{\index{pgpmac.\-h@{pgpmac.\-h}!scint@{scint}}
\index{scint@{scint}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{scint}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-motor\-\_\-t}$\ast$ scint}}\label{pgpmac_8h_a589431b3a79c21c251fcb97cc9126991}


Scintillator Z. 



Definition at line 97 of file lspmac.\-c.

\hypertarget{pgpmac_8h_ae98a0792d6b4b96a33df0a31bdec6342}{\index{pgpmac.\-h@{pgpmac.\-h}!shutter\-\_\-open@{shutter\-\_\-open}}
\index{shutter\-\_\-open@{shutter\-\_\-open}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{shutter\-\_\-open}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-bi\-\_\-t}$\ast$ shutter\-\_\-open}}\label{pgpmac_8h_ae98a0792d6b4b96a33df0a31bdec6342}


shutter is open (note in pmc says this is a slow input) 



Definition at line 132 of file lspmac.\-c.

\hypertarget{pgpmac_8h_a37903ed8430ac4d9ead609a78eb62f32}{\index{pgpmac.\-h@{pgpmac.\-h}!smart\-\_\-mag\-\_\-err@{smart\-\_\-mag\-\_\-err}}
\index{smart\-\_\-mag\-\_\-err@{smart\-\_\-mag\-\_\-err}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{smart\-\_\-mag\-\_\-err}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-bi\-\_\-t}$\ast$ smart\-\_\-mag\-\_\-err}}\label{pgpmac_8h_a37903ed8430ac4d9ead609a78eb62f32}


smart magnet error (coil broken perhaps) 



Definition at line 133 of file lspmac.\-c.

\hypertarget{pgpmac_8h_a4892e918830dd12093d28c53a1c2df98}{\index{pgpmac.\-h@{pgpmac.\-h}!smart\-\_\-mag\-\_\-off@{smart\-\_\-mag\-\_\-off}}
\index{smart\-\_\-mag\-\_\-off@{smart\-\_\-mag\-\_\-off}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{smart\-\_\-mag\-\_\-off}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-bi\-\_\-t}$\ast$ smart\-\_\-mag\-\_\-off}}\label{pgpmac_8h_a4892e918830dd12093d28c53a1c2df98}


smart magnet is off 



Definition at line 134 of file lspmac.\-c.

\hypertarget{pgpmac_8h_a2dc6fa78bb6313fe8b696d646eaa2443}{\index{pgpmac.\-h@{pgpmac.\-h}!smart\-\_\-mag\-\_\-on@{smart\-\_\-mag\-\_\-on}}
\index{smart\-\_\-mag\-\_\-on@{smart\-\_\-mag\-\_\-on}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{smart\-\_\-mag\-\_\-on}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-bi\-\_\-t}$\ast$ smart\-\_\-mag\-\_\-on}}\label{pgpmac_8h_a2dc6fa78bb6313fe8b696d646eaa2443}


smart magnet is on 



Definition at line 130 of file lspmac.\-c.

\hypertarget{pgpmac_8h_abee73a0d9e5f3af9eb88d5cfd6b953c3}{\index{pgpmac.\-h@{pgpmac.\-h}!smart\-\_\-mag\-\_\-oo@{smart\-\_\-mag\-\_\-oo}}
\index{smart\-\_\-mag\-\_\-oo@{smart\-\_\-mag\-\_\-oo}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{smart\-\_\-mag\-\_\-oo}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-motor\-\_\-t}$\ast$ smart\-\_\-mag\-\_\-oo}}\label{pgpmac_8h_abee73a0d9e5f3af9eb88d5cfd6b953c3}


Smart Magnet on/off. 



Definition at line 108 of file lspmac.\-c.

\hypertarget{pgpmac_8h_ab0487111dbe3c05d0bd835eb2fb9a3f7}{\index{pgpmac.\-h@{pgpmac.\-h}!term\-\_\-input@{term\-\_\-input}}
\index{term\-\_\-input@{term\-\_\-input}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{term\-\_\-input}]{\setlength{\rightskip}{0pt plus 5cm}W\-I\-N\-D\-O\-W$\ast$ term\-\_\-input}}\label{pgpmac_8h_ab0487111dbe3c05d0bd835eb2fb9a3f7}


place to put the cursor 



Definition at line 238 of file pgpmac.\-c.

\hypertarget{pgpmac_8h_a65daf0f4a5bc6def23a9df98ff5ca57e}{\index{pgpmac.\-h@{pgpmac.\-h}!term\-\_\-output@{term\-\_\-output}}
\index{term\-\_\-output@{term\-\_\-output}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{term\-\_\-output}]{\setlength{\rightskip}{0pt plus 5cm}W\-I\-N\-D\-O\-W$\ast$ term\-\_\-output}}\label{pgpmac_8h_a65daf0f4a5bc6def23a9df98ff5ca57e}


place to print stuff out 



Definition at line 237 of file pgpmac.\-c.

\hypertarget{pgpmac_8h_ae746a6903fb8a4ea216def88eccedc3c}{\index{pgpmac.\-h@{pgpmac.\-h}!term\-\_\-status@{term\-\_\-status}}
\index{term\-\_\-status@{term\-\_\-status}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{term\-\_\-status}]{\setlength{\rightskip}{0pt plus 5cm}W\-I\-N\-D\-O\-W$\ast$ term\-\_\-status}}\label{pgpmac_8h_ae746a6903fb8a4ea216def88eccedc3c}


shutter, lamp, air, etc status 



Definition at line 239 of file pgpmac.\-c.

\hypertarget{pgpmac_8h_ae2d7da3afeb756716e6e4ee9cab78f8a}{\index{pgpmac.\-h@{pgpmac.\-h}!term\-\_\-status2@{term\-\_\-status2}}
\index{term\-\_\-status2@{term\-\_\-status2}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{term\-\_\-status2}]{\setlength{\rightskip}{0pt plus 5cm}W\-I\-N\-D\-O\-W$\ast$ term\-\_\-status2}}\label{pgpmac_8h_ae2d7da3afeb756716e6e4ee9cab78f8a}


shutter, lamp, air, etc status 



Definition at line 240 of file pgpmac.\-c.

\hypertarget{pgpmac_8h_ad53a42cfaa04eff0336a44c8c9986333}{\index{pgpmac.\-h@{pgpmac.\-h}!zoom@{zoom}}
\index{zoom@{zoom}!pgpmac.h@{pgpmac.\-h}}
\subsubsection[{zoom}]{\setlength{\rightskip}{0pt plus 5cm}{\bf lspmac\-\_\-motor\-\_\-t}$\ast$ zoom}}\label{pgpmac_8h_ad53a42cfaa04eff0336a44c8c9986333}


Optical zoom. 



Definition at line 92 of file lspmac.\-c.

